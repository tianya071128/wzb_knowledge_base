# 问题

记录一些 `HTTPS` 相关问题

## HTTPS 客户端代理

**客户端代理一般需要设置系统代理,, 之后浏览器就会将请求转发到代理下。**

HTTPS 流量基于 TLS/SSL 加密，代理无法直接读取加密内容。但通过以下两种方式仍可代理 HTTPS：

1. 隧道模式

   * 原理 ​​

     代理不解析 HTTPS 流量，仅作为加密数据的传输通道

   * 步骤 ​​：
     1. 客户端向代理发送 `HTTP CONNECT` 请求，指定目标服务器和端口。

           ```http
           CONNECT example.com:443 HTTP/1.1
           Host: example.com:443
           ```
           
     2. 代理与目标服务器建立 TCP 连接，返回 `200 Connection Established`。
     
           ```http
           HTTP/1.1 200 Connection Established
           ```
           
     3. 客户端与目标服务器直接进行 TLS 握手，后续流量加密传输，代理仅转发数据。
   
   * **特点**：
   
     * 代理无法解密或修改流量（安全性高）。
     * 适用于隐私保护场景（如 VPN）。
   
2. #### **中间人模式（MITM，Man-in-the-Middle）**

   * **原理**
     - 代理作为中间人，分别与客户端和目标服务器建立 TLS 连接，解密并转发流量。
   * **步骤**
      1. 客户端向代理发起 HTTPS 请求。
       2. 代理拦截请求，以自身证书与客户端完成 TLS 握手（需客户端信任代理的根证书）。
       3. 代理以目标服务器身份与客户端通信，同时以客户端身份与目标服务器建立另一个 TLS 连接。
       4. 代理解密客户端流量，转发给目标服务器，再加密响应返回给客户端。
   * 特点:
      - 代理能解密和修改流量（常用于调试、监控）。
      - **需要客户端安装代理的根证书（存在安全风险）。**





 