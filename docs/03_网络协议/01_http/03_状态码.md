---
title: HTTP 状态码
date: 2021-10-21 15:00:00
permalink: /http/status
categories: 
  - 其他
  - HTTP
tags: 
  - null
---

# 状态码

状态码可以用来表达 HTTP 处理的状态, 客户端可以根据状态码进行特定处理, 如重定向、缓存、切换协议等。

状态码取值范围为 000 ~ 999, 但目前 RFC 标准把状态码分为五类, 数字的第一位表示分类:

* 1××：提示信息，表示目前是协议处理的中间状态，还需要后续的操作；
* 2××：成功，报文已经收到并被正确处理；
* 3××：重定向，资源位置发生变动，需要客户端重新发送请求；
* 4××：客户端错误，请求报文有误，服务器无法处理；
* 5××：服务器错误，服务器在处理请求时内部发生了错误。

## 1xx: 提示信息

1xx 状态码实际用到的比较

### 101 Switching Protocols 交换协议

有些协议(如 h2, ws)会通过 http 的 Upgrade 头部字段来通知服务器切换协议, 如果服务器支持的话, 就会返回 101 状态码, 同意切换协议, 之后改用其他协议通信

## 2xx: 成功

2xx 表示服务器成功处理了客户端的请求

### 200 OK 

最常见的状态码, 表示一切正常

### 204 No Content 没有内容

与 200 的区别就是没有响应体

::: tip 测试

<http-test type="status" status="204"/>

在 `Node` 端, 是会通过 `res.end('状态码')` 发送一些数据过来, 但如果是 204 状态码, 那么浏览器不会接收到数据, 这可能是因为 Node 端也对 204 状态码进行了处理

:::

### 206 Partial Content 部分内容

是 HTTP 分块下载或断点续传的基础, 在客户端发送“范围请求”、要求获取资源的部分数据时出现, 表示 body 响应体的数据不是资源的全部

通常需要客户端发送头部字段: “Content-Range”, 表示需要获取资源的范围

## 3xx: 资源发生变动

表示客户端请求的资源发生了变动，客户端必须用新的 URI 重新发送请求获取资源，也就是通常所说的“重定向”，包括著名的 301、302 跳转。

### 301 Moved Permanently 永久重定向

表示此次的资源已经不存在了, 需要改用新的 URI 进行重定向, 在响应字段 **Location** 中指定跳转 URI

**浏览器会缓存此次 URI 的重定向, 当下次在访问时, 不会请求服务器而是直接重定向**

::: tip 测试

<http-test type="status" status="301"/>

`Location` 返回 `https://www.baidu.com/`, 浏览器会自动重定向(在 ajax 表现上, 就会在请求一次`https://www.baidu.com/`) , 并且下次请求时, 会直接重定向

可以通过 **选择请求的连接 右键 Clear browser cache** 清除 301 缓存

:::

### 302 Found 临时重定向

与 301 的区别在于不会缓存此次的重定向

::: tip 测试

<http-test type="status" status="302"/>

每次都会重新请求

:::

### 304 Not Modified 资源未修改

表示资源是新鲜, 表示客户端可以使用缓存的资源

### 其他状态码

在 3xx 还有一下几种(有的客户端不一定支持):

* 303 See Other：类似 302，但要求重定向后的请求改为 GET 方法，访问一个结果页面，避免 POST/PUT 重复操作；
* 307 Temporary Redirect：类似 302，但重定向后请求里的方法和实体不允许变动，含义比 302 更明确；
* 308 Permanent Redirect：类似 307，不允许重定向后的请求变动，但它是 301“永久重定向”的含义。

## 4xx: 客户端错误

表示客户端发送的请求报文有误，服务器无法处理，它就是真正的“错误码”含义了。

### 400 Bad Request 报文错误

表示报文错误, 但是没有明确错误的地方

### 401 Unauthorized 未经授权

表示未经授权, 需要进行授权操作

::: tip 测试

<http-test type="status" status="401"/>

需要配合 `www-authenticate: Basic realm="Usagidesign Auth"` 响应字段, 当状态码为 401 时, 浏览器会根据 `www-authenticate` 字段弹出验证框

输入完账号密码后再次发送请求(原请求会一直挂起, 等待结果), 然后根据服务器返回的报文做出对应的反应

这样的密码验证意义不大

:::

### 403 Forbidden 禁止访问

表示客户端没有权限访问该资源, 禁止访问的可能性很多, 可以通过 body 请求体表示禁止访问的原因

::: tip 测试

<http-test type="status" status="403"/>

:::

### 404 Not Found 没有资源

含义为服务器上没有对应的资源

### 其他状态码

4××里剩下的一些代码较明确地说明了错误的原因，都很好理解，开发中常用的有：

* 405 Method Not Allowed：不允许使用某些方法操作资源，例如不允许 POST 只能 GET；
* 406 Not Acceptable：资源无法满足客户端请求的条件，例如请求中文但只有英文；
* 408 Request Timeout：请求超时，服务器等待了过长的时间；
* 409 Conflict：多个请求发生了冲突，可以理解为多线程并发时的竞态；
* 413 Request Entity Too Large：请求报文里的 body 太大；
* 414 Request-URI Too Long：请求行里的 URI 太大；
* 429 Too Many Requests：客户端发送了太多的请求，通常是由于服务器的限连策略；
* 431 Request Header Fields Too Large：请求头某个字段或总体太大；

## 5xx: 服务器错误

表示请求报文正确, 但是服务器内部错误, 如果返回了状态码, 就说明已经连接到服务器了

如果请求了不正确的域名或ip, 直接是 `failed` 状态

### 500 Internal Server Error  内部服务器错误

服务器未知错误

### 503 Service Unavailable 服务不可用

服务器当前很忙，暂时无法响应服务

::: warning 注意

很可能过几秒钟后服务器就不那么忙了，可以继续提供服务，所以 503 响应报文里通常还会有一个“Retry-After”字段，指示客户端可以在多久以后再次尝试发送请求。

:::

