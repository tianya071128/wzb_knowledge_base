# git fetch

## 作用

用于**从远程仓库获取最新代码和分支信息到本地，但不自动合并到当前工作分支**。

- **同步远程数据**：拉取远程仓库的最新分支、标签（tags）、提交记录（commits），更新本地的 “远程跟踪分支”（如 `origin/main`、`upstream/dev`）。
- **不影响本地工作区**：仅更新本地缓存的远程信息，不会修改你当前正在工作的分支代码
- **支持指定远程和分支**：可灵活获取特定远程仓库或特定分支的更新，避免拉取无关数据。

## 概述

```bash
git fetch [<选项>] [<仓库> [<引用规范>…]]
git fetch [<选项>] <组>
git fetch --multiple [<选项>] [(<仓库> | <组>)…]
git fetch --all [<选项>]
```

## 基础原理

`git fetch` 的本质是 “镜像远程仓库的最新状态到本地”，但不触碰你的工作分支：

1. 从远程仓库下载所有新的提交、分支、标签（未在本地缓存的内容）。
2. 更新本地的 “远程跟踪分支”（格式为 `<远程标识>/<分支名>`，如 `origin/main`），使其与远程分支完全同步。
3. 本地工作分支（如 `main`、`dev`）的代码**保持不变**，需通过 `git merge` 或 `git rebase` 手动合并远程跟踪分支的更新。

## 选项

### `<远程标识>`：指定拉取的远程仓库

* 仅从指定的远程仓库（如 `upstream`）拉取更新，而非默认的 `origin` 。

### `--[no-]all`：拉取所有远程仓库的更新

* `--all`: 同时拉取本地配置的**所有远程仓库**
* `--no-all`: **取消 “拉取所有远程仓库更新” 的行为**，恢复到默认的拉取逻辑（即只拉取指定的远程仓库，或默认远程仓库 `origin`）

### `-p, --prune`：清理本地无效的远程跟踪分支

* 拉取远程更新后，自动删除本地缓存中 “远程已删除但本地仍存在” 的远程跟踪分支（如远程已删除 `feature/old`，则本地 `origin/feature/old` 会被删除）。
* **只清理分支, 不清理标签**。可组合使用处理分支和标签：`git fetch --prune --prune-tags`
* **注意**：仅删除 `refs/remotes/<远程>/` 下的跟踪分支，不影响本地工作分支（如 `feature/old`）。

### `-P, --prune-tags`：清理本地无效的标签（tags）

* `-P` : 简写是大写的字母，与 `-p, --prune` 有区别
* **拉取远程仓库标签（tags）的同时，自动清理本地存在但远程已删除的标签**
* **只清理标签, 不清理分支**。可组合使用处理分支和标签：`git fetch --prune --prune-tags`

### `-f, --force`：强制更新远程跟踪分支

* 用于**强制更新本地远程跟踪分支**，主要用于处理 “远程分支历史被改写” 的场景（如远程执行过 `git push --force`），强制本地的远程跟踪分支（如 `origin/main`）与远程分支的最新状态保持一致，即使这意味着覆盖本地缓存的历史记录。

### `-t, --tag`: 拉取远程所有标签（无论是否关联分支）

* 默认情况下，`git fetch` 仅拉取与跟踪分支相关的标签；`--tags` 会拉取远程所有标签（包括未关联任何分支的标签）。

 ### `-n, --no-tags`：不拉取任何标签

* 强制忽略远程标签，仅拉取分支和提交信息。

### `-v, --verbose`：显示详细拉取日志

* 输出拉取的文件、提交哈希、分支映射等更多信息

### `--dry-run`：模拟拉取，不实际执行

* 显示 “如果执行拉取会发生什么”（如下载的对象、更新的分支），但不实际拉取数据或更新跟踪分支（用于预览）

