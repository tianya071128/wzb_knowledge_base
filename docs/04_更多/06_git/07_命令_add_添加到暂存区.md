# git add

## 作用

用于**将文件的修改添加到暂存区**（Index）的关键命令，它是从工作区的修改过渡到实际提交的重要步骤

## 概述

```text
git add' [--verbose | -v] [--dry-run | -n] [--force | -f] [--interactive | -i] [--patch | -p]
	[--edit | -e] [--[no-]all | -A | --[no-]ignore-removal | [--update | -u]] [--sparse]
	[--intent-to-add | -N] [--refresh] [--ignore-errors] [--ignore-missing] [--renormalize]
	[--chmod=(+|-)x] [--pathspec-from-file=<文件> [--pathspec-file-nul]]
	[--] [<路径规范>…​]
```

## 描述

* 该命令使用工作区的内容来更新暂存区，为下一次提交准备暂存的内容。通常情况下会添加当前目录的所有内容到暂存区，但是通过某些选项，它也可以用于仅添加对工作树文件所做的部分更改，或删除工作树中不存在的路径。
* **暂存区中储存着一份工作区的快照，在下次提交时这份快照会被保存到 Git 仓库中**。因此在工作区做过修改后以及在运行下一次提交命令前，你必须通过 `add` 命令来添加新创建的文件或者保存新的改动到暂存区中。
* **跟踪新文件**：对于新创建且尚未被 Git 跟踪的文件，使用 `git add` 可以开始跟踪它们，将其纳入版本控制范围。
* **合并文件状态变更**：在复杂的工作流中，比如文件经过多次修改、重命名等操作后，`git add` 能将这些不同状态的变更整合到暂存区，统一进行提交管理

## 不同命令影响范围

**从 Git 2.0 开始（2014年发布），`git add .`的行为被修改为包含删除操作**

| **命令**       | **新文件**     | **修改**       | **删除**       | **重命名**     | **作用范围**     |
| :------------- | :------------- | :------------- | :------------- | :------------- | :--------------- |
| `git add .`    | ✅ **当前目录** | ✅ **当前目录** | ✅ **当前目录** | ✅ **当前目录** | 当前目录及子目录 |
| `git add -A`   | ✅ 整个仓库     | ✅ 整个仓库     | ✅ 整个仓库     | ✅ 整个仓库     | 整个仓库         |
| `git add -u`   | ❌ 不添加       | ✅ 整个仓库     | ✅ 整个仓库     | ✅ 整个仓库     | 整个仓库         |
| `git add file` | ✅ 指定文件     | ✅ 指定文件     | ✅ 指定文件     | ✅ 指定文件     | 指定文件         |

## 文件路径

### 绝对路径

从系统根目录开始的完整路径，用于精确指定文件位置（不依赖当前工作目录）。

**格式**：

- **Linux/macOS**：`/home/user/project/file.txt`
- **Windows**：`C:\user\project\file.txt`

### 相对路径

相对于**当前终端所在目录**的路径（最常用），路径以 `.`（当前目录）或 `..`（父目录）开头。

**常用格式**：

- `./file.txt`：当前目录下的 `file.txt`（`./` 可省略）。
- `../file.txt`：父目录下的 `file.txt`。
- `dir/file.txt`：当前目录的子目录 `dir` 中的 `file.txt`。
- `dir/subdir/`：递归添加 `dir/subdir` 目录下的所有文件。

### 通配符路径（匹配多个文件）

使用通配符 `*` 或 `**` 匹配符合条件的多个文件，批量添加修改。

**常用通配符**：

- `*`：匹配当前目录下的任意字符（不递归子目录）。
  - `*.js`：当前目录下所有 `.js` 后缀的文件。
  - `app*`：当前目录下所有以 `app` 开头的文件。
- `**`：递归匹配所有子目录中的文件（Git 支持，部分系统 shell 需特殊处理）。
  - `**/*.js`：项目中所有 `.js` 后缀的文件（包括子目录）。
  - `src/**/*.css`：`src` 目录及其子目录中所有 `.css` 文件。

### 特殊路径符号

* `.`：代表当前目录，添加当前目录的所有文件。

## 选项

### `<路径规范>`: 路径

- **作用**：[要从中添加内容的文件](#文件路径)。

- **示例**:

  ```bash
  # 添加单个文件
  git add README.md
  
  # 添加目录（递归包含所有子文件）
  git add src/
  
  # 添加多个文件（空格分隔）
  git add a.js b.css docs/
  ```

### `-A, --all`: 暂存所有变更

* **作用**: [添加工作区中所有的变更](#不同命令影响范围)

### `-u, --update`: 仅暂存已跟踪文件的变更

* **作用**: [只处理**已被 Git 跟踪**的文件（不包括未跟踪的新文件）](#不同命令影响范围)

### `-f, --force`: 强制暂存忽略的文件

* **作用**: 强制添加被 `.gitignore` 规则忽略的文件（突破忽略限制）

* **示例**: 

  ```bash
  # 强制添加被忽略的 config.ini
  git add -f config.ini
  ```

  