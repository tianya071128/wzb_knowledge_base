# 样式问题

在这里记录一下遇到的样式问题以及解决方案

## 弹性子项宽度问题

- 问题：当弹性项设置为剩余空间时，内容会溢出

  ![问题描述](/img/163.png)

- 问题原因
  根据 [CSS 规范](https://www.w3.org/TR/css-flexbox-1/#min-size-auto), 计算弹性子项时最小宽度时的原理不同, 简单理解：在非滚动容器中，主轴方向 item 的最小尺寸是基于内容的最小尺寸，此时 min-width 的值是 auto。在滚动容器中，min-width 的值是 0

- 解决方案

  1. 添加一个初始宽度
     ![解决方案](/img/164.png)
  2. 设置为滚动容器: overflow:auto

- 参考
  [issues](https://github.com/element-plus/element-plus/issues/7572)

## 溢出隐藏问题

- 问题：当存在子元素时，如何溢出隐藏的问题

- 解决方案

  将子元素的设置为行内盒子(或行内块盒子, 但是行内块盒子会被当成一个整体隐藏)

  [打开看一下](/html/16.html){target="blank"}

## box-shadow 锯齿问题

- 问题：使用 box-shadow 时，谷歌浏览器有时会出现边缘有锯齿。如下图所示：

  ![解决方案](/img/279.jpg)

- 问题原因：在这个问题上，本来是 150px 的宽度，因为是弹性项，被压缩了宽度，又是使用了 box-shadow，就出现了这个问题

  ![解决方案](/img/280.jpg)

- 解决方案：使用 `flex-shrink: 0` 保持宽度，或 `transform: translate3d(0,0,0);` 启用 GPU 渲染

- 参考

  - [stack overflow](https://stackoverflow.com/questions/69658462/inset-box-shadow-visual-artifacts-in-google-chrome)
  - [issues](https://github.com/element-plus/element-plus/issues/7034)

## 中间元素最大宽度为容器剩余最大宽度

* 问题: 弹性布局父容器下的某个子元素，**宽度优先取自身默认大小，若超过父容器剩余可用宽度，则最大宽度限制为剩余宽度**。

  * 当自身默认宽度（内容 / 固有宽度）≤ 父盒子剩余可用宽度时，保持自身默认宽度；
  * 当自身默认宽度 > 父盒子剩余可用宽度时，最大宽度被限制为剩余可用宽度（不会超出父容器）。

* 示例

  ```html
  <div style="display: flex">
      <div>测试测试测试测试测试测试测试测试</div>
      <div
        style="
          flex: 0 1 auto;
          margin: 0 20px;
          max-width: 100%;
          width: 100%;
          min-width: 0;
        ">
        <span
          style="
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: block;
          ">
          中间元素中间元素中间元素中间元素中间元素中间元素中间元素中间元素中间元素中间元素中间元素中间元素中间元素
          中间元素中间元素中间元素中间元素中间元素中间元素中间元素中间元素中间元素中间元素
          中间元素中间元素中间元素中间元素中间元素中间元素中间元素中间元素中间元素中间元素中间元素中间元素中间元素
        </span>
      </div>
      <div>测试测试测试测试测试测试测试测试2测试测试测试测</div>
    </div>
  ```

* 关键属性解释

  * `flex: 0 1 auto`（核心中的核心）

    `flex` 是 `flex-grow` + `flex-shrink` + `flex-basis` 的简写，三个值分别对应：

    * `flex-grow: 0`：第二个子元素**不会主动抢占**父容器的剩余空间（保证宽度优先取自身默认值）；
    * `flex-shrink: 1`：当子元素宽度超过父容器剩余空间时，会自动收缩（避免超出父容器）；
    * `flex-basis: auto`：子元素的基础宽度为「自身固有宽度」（内容 / 自定义宽度）。
    
  * `max-width: 100%`

    在 flex 布局中，子元素的 `max-width: 100%` 不是指父容器的总宽度，而是**父容器扣除其他子元素（1、3）和间距后的剩余可用宽度**，刚好满足 “超过剩余宽度则限制为剩余宽度” 的需求。

  * **`width: 100% + min-width: 0`**：

    - `width: 100%` 强化中间元素对剩余宽度的占用约束；
    - `min-width: 0` 打破 flex 子元素的「最小内容宽度限制」（flex 子元素默认会撑到能容纳内容的最小宽度，加这个属性后才能被 `max-width` 限制）。
  - **span 补充 `display: block`**：

    - `span` 是行内元素，默认不继承父元素宽度约束，改为块级元素后，`overflow: hidden` 才能生效，文本溢出省略才会触发。


## 多个子元素下的文本溢出省略号

1. 将所有子元素都设置为 `display: inline`, 此时在子元素任意部分上都会截断显示省略号

   ::: tip

   在火狐浏览器上, 不要在子元素上增加 `word-break: break-all` 属性, 否则会换行

   :::

2. 将所有子元素都设置为 `display: inline-block`, 此时子元素会被当成一个整体, 浏览器会在显示不了子元素的时候直接截断整个子元素