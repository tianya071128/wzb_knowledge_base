import{_ as s,c as a,o as i,aR as e,cR as n,cS as l,cT as t}from"./chunks/framework.DLAwTCsc.js";const F=JSON.parse('{"title":"Browserslist","description":"","frontmatter":{},"headers":[],"relativePath":"browserslist/home.md","filePath":"02_工程化/09_Browserslist/01_home.md","lastUpdated":1739447932000}'),r={name:"browserslist/home.md"},p=e('<h1 id="browserslist" tabindex="-1">Browserslist <a class="header-anchor" href="#browserslist" aria-label="Permalink to &quot;Browserslist&quot;">​</a></h1><p>用于在不同前端工具之间共享目标浏览器和 <code>Node.js</code> 版本的配置。通俗的理解就是<strong>根据规则来配置项目的目标浏览器</strong></p><p>可用于如下工具：</p><ul><li><a href="https://github.com/postcss/autoprefixer" target="_blank" rel="noreferrer">Autoprefixer</a></li><li><a href="https://github.com/babel/babel/tree/master/packages/babel-preset-env" target="_blank" rel="noreferrer">Babel</a></li><li><a href="https://github.com/jonathantneal/postcss-preset-env" target="_blank" rel="noreferrer">postcss-preset-env</a></li><li><a href="https://github.com/amilajack/eslint-plugin-compat" target="_blank" rel="noreferrer">eslint-plugin-compat</a></li><li><a href="https://github.com/ismay/stylelint-no-unsupported-browser-features" target="_blank" rel="noreferrer">stylelint-no-unsupported-browser-features</a></li><li><a href="https://github.com/jonathantneal/postcss-normalize" target="_blank" rel="noreferrer">postcss-normalize</a></li><li><a href="https://github.com/ElemeFE/obsolete-webpack-plugin" target="_blank" rel="noreferrer">obsolete-webpack-plugin</a></li><li>。。。</li></ul><h2 id="查询" tabindex="-1">查询 <a class="header-anchor" href="#查询" aria-label="Permalink to &quot;查询&quot;">​</a></h2><p><code>Browserslist</code> 将使用来自以下来源之一的浏览器和 Node.js 版本查询：</p><ol><li>当前或父目录中 <code>package.json</code> 文件中的 <code>browserslist</code> 键。</li><li>当前或父目录中的 <code>.browserslistrc</code> 配置文件。</li><li>当前或父目录中的 <code>browserslist</code> 配置文件。</li><li><code>BROWSERSLIST</code> 环境变量。</li><li>如果上述都没有，那么将采用默认值：<code>&gt; 0.5%, last 2 versions, Firefox ESR, not dead</code></li></ol><h3 id="查询语句列表" tabindex="-1">查询语句列表 <a class="header-anchor" href="#查询语句列表" aria-label="Permalink to &quot;查询语句列表&quot;">​</a></h3><p>可以通过查询指定浏览器和 Node.js 版本（不区分大小写）：</p><ul><li><code>defaults</code>：默认值，也可以使用 <code>defaults</code> 这个关键字采用默认查询，即 <code>&gt; 0.5%, last 2 versions, Firefox ESR, not dead</code></li><li>按使用统计： <ul><li><code>&gt; 5%</code>：全球使用统计选择的浏览器版本。 &gt;=、&lt; 和 &lt;= 也可以。</li><li><code>&gt; 5% in US</code>：使用美国使用统计数据。它接受两个字母的国家代码。</li></ul></li><li>最新版本： <ul><li><code>last 2 versions</code>：每个浏览器的最后 2 个版本。</li><li><code>last 2 Chrome versions</code>：最近 2 个版本的 Chrome 浏览器。</li></ul></li><li>指定浏览器版本： <ul><li><code>ie 9</code>：指定浏览器版本</li><li><code>ie 6-8</code>：选择一个包含范围的版本。</li><li><code>Firefox &gt; 20</code>：20 之后的 Firefox 版本。&gt;=、&lt; 和 &lt;= 也可以。它也适用于 Node.js。</li></ul></li><li><code>dead</code>：24 个月没有官方支持或更新的浏览器。现在是 IE 10、IE_Mob 11、黑莓 10、黑莓 7、三星 4、OperaMobile 12.1 和百度所有版本。</li><li><code>supports es6-module</code>：支持特定功能的浏览器。这里的 es6-module 是 <a href="https://caniuse.com/" target="_blank" rel="noreferrer">Can I Use</a> 页面 URL 处的 feat 参数。可以在 <a href="https://github.com/ben-eb/caniuse-lite/tree/main/data/features" target="_blank" rel="noreferrer">caniuse-lite/data/features</a> 找到所有可用功能的列表。</li><li><code>not ie &lt;= 8</code>：从之前的查询中排除 IE 8 及更低版本。</li></ul><h3 id="组合查询" tabindex="-1">组合查询 <a class="header-anchor" href="#组合查询" aria-label="Permalink to &quot;组合查询&quot;">​</a></h3><p>有如下三种组合器：</p><table><thead><tr><th>组合器类型</th><th>说明</th><th>插图</th><th>例子</th></tr></thead><tbody><tr><td><code>or</code>/<code>,</code></td><td>查询并集。<br><strong>注意：在配置文件中每行都用 <code>or</code> 组合器组合</strong></td><td><img src="'+n+'" alt="img" loading="lazy"></td><td><code>&gt; .5% or last 2 versions</code><br>使用率大于 0.5% 或者最后两个版本</td></tr><tr><td><code>and</code></td><td>查询合集</td><td><img src="'+l+'" alt="img" loading="lazy"></td><td><code>&gt; .5% and last 2 versions</code><br>使用率大于 0.5% 并且是最后两个版本</td></tr><tr><td><code>not</code></td><td>排除指定的查询。<br><strong>注意：这个需要结合其他查询，用来从之前的查询中排除特定浏览器</strong></td><td><img src="'+t+`" alt="img" loading="lazy"></td><td>这三个是等价的：使用率大于 0.5% 的版本中排除不是最后两个版本<br><code>&gt; .5% and not last 2 versions</code><br><code>&gt; .5% or not last 2 versions</code><br><code>&gt; .5%, not last 2 versions</code></td></tr></tbody></table><h2 id="配置" tabindex="-1">配置 <a class="header-anchor" href="#配置" aria-label="Permalink to &quot;配置&quot;">​</a></h2><h3 id="配置文件" tabindex="-1">配置文件 <a class="header-anchor" href="#配置文件" aria-label="Permalink to &quot;配置文件&quot;">​</a></h3><p>主流有如下两种方式配置：</p><ul><li><p>使用单独的 <code>.browserslistrc</code> 配置文件，语法与主流配置文件类似：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 注释以 # 开头</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">last</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 每一行表示一个浏览器查询语句</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 1%</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li><li><p>在 <code>package.json</code> 中使用 <code>browserslist</code> 键，这样可以减少项目配置文件，语法如下：</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;browserslist&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;last 1 version&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&gt; 1%&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;IE 10&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul><h3 id="针对不同环境进行配置" tabindex="-1">针对不同环境进行配置 <a class="header-anchor" href="#针对不同环境进行配置" aria-label="Permalink to &quot;针对不同环境进行配置&quot;">​</a></h3><p>可以根据各种环境指定不同的浏览器查询。<code>Browserslist</code> 将根据 <code>BROWSERSLIST_ENV</code> 或 <code>NODE_ENV</code> 变量选择查询，默认查找 <code>production</code> 环境</p><ul><li><p>在 <code>.browserslistrc</code> 配置中：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[production]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 1%</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ie</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[modern]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">last</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chrome</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">last</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> firefox</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[ssr]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 12</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li><li><p>在 <code>package.json</code> 中：</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;browserslist&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;production&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;&gt; 1%&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;ie 10&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;modern&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;last 1 chrome version&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;last 1 firefox version&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;ssr&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;node 12&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li></ul><h3 id="可共享配置" tabindex="-1">可共享配置 <a class="header-anchor" href="#可共享配置" aria-label="Permalink to &quot;可共享配置&quot;">​</a></h3><p>可通过 <code>extends</code> 关键字来引用其他配置：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  &quot;browserslist&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    &quot;extends browserslist-config-mycompany&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="内部基础原理" tabindex="-1">内部基础原理 <a class="header-anchor" href="#内部基础原理" aria-label="Permalink to &quot;内部基础原理&quot;">​</a></h2><p><code>Browserslist</code> 内部会使用 <a href="https://github.com/ben-eb/caniuse-lite" target="_blank" rel="noreferrer">caniuse-lite</a> 库来查询目标浏览器。</p><p><code>caniuse-lite</code> 库是 <a href="https://caniuse.com/" target="_blank" rel="noreferrer">Can I Use</a>(这个网站用来查询浏览器兼容性)的数据库的小版本，只有一些必需数据，这些数据存放在 <a href="https://github.com/browserslist/caniuse-lite/tree/main/data" target="_blank" rel="noreferrer">caniuse-lite/data</a> 中</p><h3 id="浏览器数据更新" tabindex="-1">浏览器数据更新 <a class="header-anchor" href="#浏览器数据更新" aria-label="Permalink to &quot;浏览器数据更新&quot;">​</a></h3><p>因为 <code>Browserslist</code> 查询依赖 <a href="https://github.com/ben-eb/caniuse-lite" target="_blank" rel="noreferrer">caniuse-lite</a>，而这个的查询数据都是存在库的本地，即 <a href="https://github.com/browserslist/caniuse-lite/tree/main/data" target="_blank" rel="noreferrer">caniuse-lite/data</a> 中，所以我们需要定期更新 <code>Browserslist</code> 中的 <code>caniuse-lite</code> 版本。</p><p>使用：<code>npx browserslist@latest --update-db</code> 定期更新。此更新将为 <code>Autoprefixer</code> 或 <code>Babel</code> 等 <code>polyfill</code> 工具带来有关新浏览器的数据，并减少已经不必要的 <code>polyfill</code>。</p><p>需要定期更新主要有如下三个原因：</p><ul><li>在查询中使用最新的浏览器版本和统计信息：例如 <code>last 2 versions</code> or <code>&gt;1%</code> ，如果在 2 年前创建了项目但是没有更新依赖项，那么返回结果是 2 年前的浏览器</li><li>实际的浏览器数据将导致使用更少的 <code>polyfill</code>。它将减少 JS 和 CSS 文件的大小并提高网站性能。</li><li><code>caniuse-lite</code>重复数据删除：在不同工具中同步版本。</li></ul><h2 id="查看项目的目标浏览器" tabindex="-1">查看项目的目标浏览器 <a class="header-anchor" href="#查看项目的目标浏览器" aria-label="Permalink to &quot;查看项目的目标浏览器&quot;">​</a></h2><p>在项目目录中运行 <code>npx browserslist</code> 以查看您的查询选择了哪些浏览器。</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> npx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> browserslist</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">and_chr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 61</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">and_ff</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 56</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">and_qq</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">and_uc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 11.4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">android</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 56</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">baidu</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 7.12</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chrome</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 62</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">edge</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 16</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">firefox</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 56</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ios_saf</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 11</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">opera</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 48</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">safari</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 11</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">samsung</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-label="Permalink to &quot;参考&quot;">​</a></h2><ul><li><a href="https://github.com/browserslist/browserslist#tools" target="_blank" rel="noreferrer">git - browserslist</a></li></ul>`,36),h=[p];function o(d,c,k,b,u,g){return i(),a("div",null,h)}const E=s(r,[["render",o]]);export{F as __pageData,E as default};
