import{E as z}from"./EditorDraggable-a06dbc71.js";import{_ as T}from"./ButtonSelectField.vue_vue_type_script_setup_true_lang-aae15f71.js";import{d as M,v as $,r as S,Y as w,er as j,c as N,b_ as q,o as n,f as D,i as o,B as b,at as H,w as t,k as L,m as A,dA as U,b as V,H as O,l as _,F as Q,av as W,ac as Y,Q as G,q as J,bm as K,U as P,bn as X,R as Z,aq as v,j as B,ag as ee,_ as le}from"./index-b80d5ef5.js";import{A as de}from"./AzInputNumber-d6212644.js";const E=M({inheritAttrs:!1,__name:"CloumnItemSet",props:{modelValue:{},entryId:{},sourceId:{},fields:{},isMerge:{type:Boolean}},emits:["update:modelValue"],setup(h,{emit:g}){const p=h,m=$(p,"modelValue",g),a=S(w(m.value)),u=S(!1),c=()=>{u.value=!0,a.value=w(m.value)},k=()=>{m.value=w(a.value),u.value=!1},{getFieldInfo:I}=j(),l=N(()=>{var e;const d=I(a.value.fieldId,p);return parseFloat(((e=q(d==null?void 0:d.field.type,"subformFieldWidthMap"))==null?void 0:e[1])??"0")||150});return(d,e)=>{const s=W,i=Y,f=G,y=J,C=K,x=P,R=X;return n(),D(Q,null,[o(s,{underline:!1,title:"设置",icon:b(H),class:"editor-draggable-icon",onClick:c},null,8,["icon"]),o(R,{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=r=>u.value=r),title:"设置",width:"500","append-to-body":""},{footer:t(()=>[L("span",{class:"dialog-footer"},[o(x,{onClick:e[3]||(e[3]=r=>u.value=!1)},{default:t(()=>[A("取消")]),_:1}),o(x,{type:"primary",onClick:k},{default:t(()=>[A("确定")]),_:1})])]),default:t(()=>[o(C,{model:a.value,ref:"ruleFormRef","label-width":"100px"},{default:t(()=>[o(i,{label:"字段名称",prop:"type"},{default:t(()=>[o(U,{"field-id":a.value.fieldId,"entry-id":d.entryId,sourceId:d.sourceId,fields:d.fields},null,8,["field-id","entry-id","sourceId","fields"])]),_:1}),o(i,{label:"字段别名",prop:"type"},{default:t(()=>[o(f,{modelValue:a.value.alias,"onUpdate:modelValue":e[0]||(e[0]=r=>a.value.alias=r),placeholder:"可设置字段显示别名"},null,8,["modelValue"])]),_:1}),o(i,{label:"列宽",prop:"fieldId"},{default:t(()=>[o(de,{modelValue:a.value.width,"onUpdate:modelValue":e[1]||(e[1]=r=>a.value.width=r),min:50,max:1e3,"value-on-clear":l.value,"controls-position":"right",width:"100px",suffix:"px",placeholder:"自定义列宽"},null,8,["modelValue","value-on-clear"])]),_:1}),d.isMerge?(n(),V(O,{key:0,label:"单元格合并",tip:"相邻行的值相同时，合并单元格显示"},{default:t(()=>[o(y,{modelValue:a.value.merge,"onUpdate:modelValue":e[2]||(e[2]=r=>a.value.merge=r)},null,8,["modelValue"])]),_:1})):_("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}}),oe=M({__name:"CloumnSetField",props:{modelValue:{},entryId:{},sourceId:{},fields:{},isSubform:{type:Boolean,default:!0},isMerge:{type:Boolean}},emits:["update:modelValue"],setup(h,{expose:g,emit:p}){const F=h,a=Z(F,"modelValue",p),u=l=>ee(l,{isSubform:F.isSubform}),c=N({get(){return a.value.reduce((l,d)=>[...l,d,...d.child??[]],[])},set(l){const d=[];l.map(e=>(delete e.child,{...e})).forEach(e=>{if(!e.subformId&&!d.some(s=>s.fieldId===e.fieldId))return d.push(e);if(e.subformId){let s=d.find(i=>i.fieldId===e.subformId);s||(s=l.find(i=>i.fieldId===e.subformId),s&&d.push(s)),s&&(s.child||(s.child=[]),s.child.push(e))}}),a.value=[...d]}}),k=(l,d)=>{var e;Number((e=l.child)==null?void 0:e.length)<2&&a.value.splice(d,1)},I=S();return g({switchAll(l){var d;(d=I.value)==null||d.switchAll(l)}}),(l,d)=>(n(),D("div",{class:"cloumn_setfield"},[o(T,{modelValue:c.value,"onUpdate:modelValue":d[0]||(d[0]=e=>c.value=e),ref_key:"buttonSelectFieldRef",ref:I,placeholder:"选择显示字段","entry-id":l.entryId,fields:l.fields,disabled:!l.entryId&&!l.fields&&!l.sourceId,sourceId:l.sourceId,filter:u,prop:{fieldId:"fieldId",subformId:"subformId"},multiple:"",isSelectSubform:""},null,8,["modelValue","entry-id","fields","disabled","sourceId"]),o(z,{"model-value":b(a),class:"mt-5"},{default:t(({element:e,index:s})=>[o(v,{class:"az-input-prefix az-flex-width",readonly:""},{prefix:t(()=>[o(U,{"field-id":e.fieldId,"entry-id":l.entryId,sourceId:l.sourceId,fields:l.fields,class:"color-text"},null,8,["field-id","entry-id","sourceId","fields"])]),_:2},1024),e.alias?(n(),V(v,{key:0,class:"az-input-prefix",readonly:"",style:{"max-width":"100px"}},{prefix:t(()=>[o(B,{style:{color:"var(--el-text-color-primary)"},content:e.alias},null,8,["content"])]),_:2},1024)):_("",!0),o(E,{modelValue:b(a)[s],"onUpdate:modelValue":i=>b(a)[s]=i,"entry-id":l.entryId,sourceId:l.sourceId,fields:l.fields,isMerge:l.isMerge},null,8,["modelValue","onUpdate:modelValue","entry-id","sourceId","fields","isMerge"])]),son:t(({element:e,index:s})=>{var i;return[(i=e==null?void 0:e.child)!=null&&i.length?(n(),V(z,{key:0,"model-value":e==null?void 0:e.child,"delete-callback":()=>k(e,s)},{default:t(({element:f,index:y})=>[o(v,{class:"az-input-prefix",readonly:""},{prefix:t(()=>[o(U,{class:"color-text","field-id":f.fieldId,"entry-id":l.entryId,sourceId:l.sourceId,fields:l.fields},null,8,["field-id","entry-id","sourceId","fields"])]),_:2},1024),f.alias?(n(),V(v,{key:0,class:"az-input-prefix",readonly:"",style:{"max-width":"100px"}},{prefix:t(()=>[o(B,{style:{color:"var(--el-text-color-primary)"},content:f.alias},null,8,["content"])]),_:2},1024)):_("",!0),o(E,{modelValue:e.child[y],"onUpdate:modelValue":C=>e.child[y]=C,"entry-id":l.entryId,sourceId:l.sourceId,fields:l.fields,isMerge:!1},null,8,["modelValue","onUpdate:modelValue","entry-id","sourceId","fields"])]),_:2},1032,["model-value","delete-callback"])):_("",!0)]}),_:1},8,["model-value"])]))}});const re=le(oe,[["__scopeId","data-v-7715b753"]]);export{re as C};
