import{_ as A}from"./TableOperation.vue_vue_type_script_setup_true_lang-4afbb2cb.js";import{d as x,v as T,r as v,c as R,o as y,b as w,w as o,i as t,m as i,t as s,k as N,l as q,B as h,C as k,bv as C,lv as V,bT as D,bU as M,_ as P,aV as z,bi as B,f as O,lw as U}from"./index-b80d5ef5.js";const E=x({__name:"details",props:{drawerModel:{type:Boolean},id:{}},emits:["update:drawerModel"],setup(I,{emit:g}){const b=g,n=I,d=T(n,"drawerModel",b),a=v(),c=async()=>{a.value=await V.getInfo(n.id)},m=R(()=>function(p){return p?JSON.stringify(JSON.parse(p),null,2):"-"});return(p,l)=>{const r=D,u=M;return y(),w(C,{modelValue:h(d),"onUpdate:modelValue":l[0]||(l[0]=e=>k(d)?d.value=e:null),title:"日志详情","show-load":c,size:"800px"},{default:o(()=>[t(u,{title:"信息查询",column:2,border:""},{default:o(()=>[t(r,{label:"API名称"},{default:o(()=>{var e;return[i(s(((e=a.value)==null?void 0:e.apiName)||"-"),1)]}),_:1}),t(r,{label:"插件版本"},{default:o(()=>{var e;return[i(s(((e=a.value)==null?void 0:e.pluginVersion)||"-"),1)]}),_:1}),t(r,{label:"使用企业"},{default:o(()=>{var e;return[i(s(((e=a.value)==null?void 0:e.enterpriseName)||"-"),1)]}),_:1}),t(r,{label:"应用-表单"},{default:o(()=>{var e,_;return[i(s((e=a.value)==null?void 0:e.callApplicationName)+" - "+s((_=a.value)==null?void 0:_.fromName),1)]}),_:1}),t(r,{label:"请求者"},{default:o(()=>{var e;return[i(s(((e=a.value)==null?void 0:e.createUserName)||"-"),1)]}),_:1}),t(r,{label:"请求时间"},{default:o(()=>{var e;return[i(s(((e=a.value)==null?void 0:e.createTime)||"-"),1)]}),_:1}),t(r,{label:"请求结果"},{default:o(()=>{var e;return[i(s(((e=a.value)==null?void 0:e.reqResultName)||"-"),1)]}),_:1}),t(r,{label:"失败原因"},{default:o(()=>{var e;return[i(s(((e=a.value)==null?void 0:e.failReason)||"-"),1)]}),_:1})]),_:1}),N("br"),t(u,{direction:"vertical",column:1},{default:o(()=>{var e,_;return[(e=a.value)!=null&&e.reqData?(y(),w(r,{key:0,label:"请求数据"},{default:o(()=>{var f;return[N("pre",{class:"item-wrap",innerHTML:m.value(((f=a.value)==null?void 0:f.reqData)||"")},null,8,["innerHTML"])]}),_:1})):q("",!0),(_=a.value)!=null&&_.retResult?(y(),w(r,{key:1,label:"返回结果"},{default:o(()=>{var f;return[N("pre",{class:"item-wrap"},s(m.value(((f=a.value)==null?void 0:f.retResult)||"")),1)]}),_:1})):q("",!0)]}),_:1})]),_:1},8,["modelValue"])}}});const L=P(E,[["__scopeId","data-v-369f9831"]]),H=x({__name:"routePage",setup(I){const g=v(),b=v(),n=z(),d=async()=>(await U.list({name:""})).map(l=>({label:l.name,value:l.id})),a=R(()=>({query:{list:[{type:"input",label:"插件名称",prop:"applicationName"},{type:"input",label:"使用企业",prop:"enterpriseName"},{type:"select",label:"插件分类",prop:"pluginTypeId",options:async()=>d(),extraOptions:[{label:"全部",value:""}]},{type:"select",label:"请求结果",prop:"reqResult",options:"log_result_type",extraOptions:[{label:"全部",value:""}]}]},request:{api:l=>V.listPage({...l||{},apiId:n.query.releaseId?"":n.query.apiId,applicationId:n.query.applicationId,viewType:n.query.viewType??1,tenantAppId:n.query.tenantAppId,releaseId:n.query.releaseId})},table:{tableCols:[{prop:"applicationName",label:"插件名称"},{prop:"apiName",label:"API名称"},{prop:"enterpriseName",label:"使用企业"},{prop:"callApplicationName",label:"应用/表单",slots:{default({row:l}){return t("span",null,[l.callApplicationName,i(" - "),l.fromName])}}},{prop:"createUserName",label:"请求者"},{prop:"createTime",label:"请求时间"},{prop:"reqResultName",label:"请求结果",width:"80"},{prop:"failReason",label:"失败原因",minWidth:"250",showOverflowTooltip:!0},{fixed:"right",width:100,label:"操作",slots:{default({row:l}){const u=[{type:"primary",onClick:()=>{m.value=l.id,c.value=!0},text:"查看详情"}];return t(A,{num:3,rowId:l.id,list:u},null)}}}]},operation:{fullEl:b}})),c=v(!1),m=v("");return(p,l)=>{const r=B("az-page");return y(),O("div",{class:"layout_box",ref_key:"pendingRef",ref:b},[t(r,{ref_key:"azPageRef",ref:g,config:a.value},null,8,["config"]),t(L,{"drawer-model":c.value,"onUpdate:drawerModel":l[0]||(l[0]=u=>c.value=u),id:m.value},null,8,["drawer-model","id"])],512)}}});export{H as _};
