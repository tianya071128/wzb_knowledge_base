import{cA as re,d as E,i as s,bz as $,o as m,b as f,w as i,k as _,j as P,m as w,t as F,B as R,l as ie,bc as pe,aN as B,aU as ue,bC as de,_ as V,c3 as H,aW as ce,av as me,c as N,d8 as W,gU as _e,r as d,y as ve,du as fe,f as T,F as ye,g as ge,bA as he,bB as Ae,nZ as we,a2 as Ee,Q as Ce,dw as Ie,bK as be,ad as ke,k_ as q}from"./index-b80d5ef5.js";import{u as Ve}from"./useAddModuleContext-27547570.js";import{u as xe}from"./createDesigner-82222fc7.js";import{M as Se}from"./ModuleWrapper-dbe018a4.js";import{b as K,a as $e,r as Fe,c as Re,l as Me}from"./homePage-3523f56f.js";import{a as Ue}from"./processModel-1437813e.js";import"./defaultValue-7c7c87ea.js";import{A as Be}from"./AppFavorites-b5587807.js";import{A as Ne}from"./AppIcon-5727720b.js";import{u as Te,A as ze,_ as De,b as Le,c as Pe,a as We}from"./AppExport-ba4fbe43.js";import{s as qe}from"./skeleton-9235483f.js";import"./enum-baae9292.js";import"./dashboardDesigner-ce3c2e23.js";import"./useTransformColor-38b5da33.js";/* empty css                          */import"./SelectIcon-71b7daf2.js";import"./AppIconNew-704f70f4.js";import"./el-space-0d01b33a.js";const G=Symbol("on:openCategory"),z=Symbol("on:searchName"),k=re(),Ge=E({__name:"Card",props:{item:{}},emits:["refreshFavorites","view","edit","delete","auth","export"],setup(g,{emit:r}){const{goApp:c}=Te(),p=r;s($,{iconClass:"Setting"},null),s($,{iconClass:"Edit"},null),s($,{iconClass:"View"},null);const u=e=>{c({appId:e.id})},v=async(e,t)=>{if(e)await Fe(t.favoriteId),B.success("已取消常用"),t.favoriteId=null,p("refreshFavorites");else{const n=await $e({buId:t.id,type:1});B.success("已设为常用"),t.favoriteId=n==null?void 0:n.id,p("refreshFavorites")}};return(e,t)=>{const n=ue,y=de;return m(),f(y,{class:"myApp_card az-card__hover",shadow:"never",onClick:t[1]||(t[1]=pe(h=>u(e.item),["stop"]))},{default:i(()=>[_("div",{class:"myApp_main"},[s(Ne,{type:"circle","bg-color":e.item.color,isGradient:"",icon:e.item.icon},null,8,["bg-color","icon"]),_("div",{class:"myApp_info",style:{width:"100px"}},[s(P,{class:"myApp_info_name"},{tooltip:i(()=>[w(F(e.item.name),1)]),default:i(()=>[w(F(e.item.name)+" ",1)]),_:1}),s(P,{class:"myApp_info_description"},{tooltip:i(()=>[w(F(e.item.description),1)]),default:i(()=>[w(F(e.item.description)+" ",1)]),_:1})]),e.item.applicationType===R(K).cooperation?(m(),f(n,{key:0,class:"box-item",effect:"dark",content:"协作应用",placement:"top"},{default:i(()=>[_("div",{type:"primary",class:"myApp_card-tag"},[s($,{iconClass:"cooperation_other"})])]),_:1})):ie("",!0),_("div",{class:"myApp_collect"},[s(Be,{onClickFavorites:t[0]||(t[0]=h=>v(h,e.item)),valid:!!e.item.favoriteId},null,8,["valid"])])])]),_:1})}}});const He=V(Ge,[["__scopeId","data-v-2e7e82b4"]]),Ke=""+new URL("../png/appEmpty-00f6c294.png",import.meta.url).href,Oe=E({__name:"Empty",props:{desc:{default:"暂无可用应用，请新增应用或联系管理员"}},setup(g){return(r,c)=>{const p=H;return m(),f(p,{description:r.desc},{image:i(()=>[_("img",{src:Ke,alt:r.desc},null,8,["alt"])]),_:1},8,["description"])}}}),Qe=""+new URL("../png/entEmpty-102ea8ef.png",import.meta.url).href,Ze="/user/myEnterprise",je=E({__name:"EmptyEnt",setup(g){const r=ce(),c=p=>{r.push({path:Ze,query:{action:p}})};return(p,u)=>{const v=me,e=H;return m(),f(e,{style:{padding:"unset"}},{image:i(()=>[_("img",{src:Qe,alt:"",srcset:""})]),description:i(()=>[_("p",{class:"title"},"还未加入任何企业/单位，暂时无法创建或使用应用"),_("p",null,[s(v,{type:"primary",underline:!1,onClick:u[0]||(u[0]=t=>c("join"))},{default:i(()=>[w(" 加入已有企业/单位 ")]),_:1})]),_("p",null,[s(v,{type:"primary",onClick:u[1]||(u[1]=t=>c("create")),underline:!1},{default:i(()=>[w(" 创建新的企业/单位 ")]),_:1})])]),_:1})}}});const Je=V(je,[["__scopeId","data-v-0150988c"]]),Xe=E({__name:"Main",emits:["refreshFavorites"],setup(g,{expose:r,emit:c}){const p=c,u=N(()=>!!W.value.userInfo.corpInfo),{width:v}=_e(),e=d({name:"",current:1,limit:v.value>=1920?10:8,orgIds:W.value.userInfo.orgIds}),t=d(),n=()=>Me(e.value),y={immediate:!1},{result:h,total:O,initApi:Q}=Ue(n,y),Z=N(()=>h.value.length>=1),M=d(!1),U=d(!1);ve(()=>e.value,()=>C(),{deep:!0});const j=l=>{e.value.name=l},C=()=>{var l;(l=t.value)==null||l.reload()};k.on(z,j);const I=d(!1),x=d(!1),S=d("add"),A=d(""),D=d(!1),J=l=>{M.value=!0,A.value=l.id},X=()=>{x.value=!0},Y=l=>{switch(l){case"1":I.value=!0,S.value="add",A.value="";break;case"3":U.value=!0;break}x.value=!1},ee=async l=>{I.value=!0,S.value="view",A.value=l.id,D.value=l.applicationType===K.cooperation},te=async l=>{I.value=!0,S.value="edit",A.value=l.id},oe=async l=>{await Re(l.id),B.success("删除成功"),h.value.length<=1&&(e.value.current=1),C()};k.on(G,X);const L=d(),ae=async l=>{var o;(o=L.value)==null||o.handleSetAppAuth(l.id)};return fe(()=>{k.off(G),k.off(z)}),r({refresh:()=>{e.value.current=1,C()}}),(l,o)=>{const se=he,ne=Ae,le=we;return m(),f(qe,{ref_key:"skeletonRef",ref:t,load:R(Q),style:{height:"100%",width:"100%",display:"unset !important"}},{default:i(()=>[Z.value?(m(),T("div",{key:0},[_("div",{class:"myApp"},[s(ne,{gutter:20},{default:i(()=>[(m(!0),T(ye,null,ge(R(h),a=>(m(),f(se,{xs:12,sm:8,md:8,lg:6,xl:19,style:{"margin-bottom":"20px"},key:a.id},{default:i(()=>[s(He,{onRefreshFavorites:o[0]||(o[0]=b=>p("refreshFavorites")),item:a,onEdit:b=>te(a),onDelete:b=>oe(a),onAuth:b=>ae(a),onView:b=>ee(a),onExport:b=>J(a)},null,8,["item","onEdit","onDelete","onAuth","onView","onExport"])]),_:2},1024))),128))]),_:1})]),s(le,{class:"myApp","hide-on-single-page":!0,style:{"justify-content":"flex-end"},"current-page":e.value.current,"onUpdate:currentPage":o[1]||(o[1]=a=>e.value.current=a),"page-size":e.value.limit,"onUpdate:pageSize":o[2]||(o[2]=a=>e.value.limit=a),layout:"prev, pager, next, jumper",total:R(O)},null,8,["current-page","page-size","total"])])):u.value?(m(),f(Oe,{key:2})):(m(),f(Je,{key:1})),s(ze,{"drawer-model":x.value,"onUpdate:drawerModel":o[3]||(o[3]=a=>x.value=a),onHandleClick:Y},null,8,["drawer-model"]),s(De,{onRefresh:o[4]||(o[4]=a=>C()),"drawer-model":I.value,"onUpdate:drawerModel":o[5]||(o[5]=a=>I.value=a),comState:S.value,"app-id":A.value,isCooperateApp:D.value},null,8,["drawer-model","comState","app-id","isCooperateApp"]),s(Le,{ref_key:"setAppAuthRef",ref:L},null,512),s(Pe,{visible:M.value,"onUpdate:visible":o[6]||(o[6]=a=>M.value=a),"app-id":A.value},null,8,["visible","app-id"]),s(We,{visible:U.value,"onUpdate:visible":o[7]||(o[7]=a=>U.value=a),onSuccess:o[8]||(o[8]=a=>C())},null,8,["visible"])]),_:1},8,["load"])}}});const Ye=V(Xe,[["__scopeId","data-v-8afc465e"]]),et=E({__name:"Search",setup(g){const r=d(""),c=()=>{r.value,k.emit(z,r.value)},p=d(!0),u=()=>{p.value=!1},v=()=>{p.value=!0};return(e,t)=>{const n=Ce;return m(),T("div",{class:"search"},[s(n,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=y=>r.value=y),onChange:c,onFocus:u,onBlur:v,style:Ee({width:p.value?"auto":"100%"}),placeholder:"输入关键字搜索"},null,8,["modelValue","style"])])}}});const tt=V(et,[["__scopeId","data-v-8066b3ac"]]),ot=E({__name:"render",props:{moduleItem:{}},setup(g){const r=xe(),c=g,p=N(()=>Ie.design===r.mode),u=d(),v=be({refresh(){var t;(t=u.value)==null||t.refresh()}});Ve(c.moduleItem.moduleId,v);const e=()=>{r.getModuleContextByType([q.usually,q.myApp],r.moduleIds.filter(n=>n!==c.moduleItem.moduleId)).forEach(n=>{var y;n&&((y=n==null?void 0:n.refresh)==null||y.call(n))})};return(t,n)=>(m(),f(Se,{"module-item":t.moduleItem,"is-edit":!1},ke({default:i(()=>[_("div",{style:{overflow:"auto",height:"100%"}},[s(Ye,{ref_key:"MainVueRef",ref:u,onRefreshFavorites:e},null,512)])]),_:2},[p.value?void 0:{name:"top-right",fn:i(()=>[s(tt)]),key:"0"}]),1032,["module-item"]))}});const wt=V(ot,[["__scopeId","data-v-385f886a"]]);export{wt as default};
