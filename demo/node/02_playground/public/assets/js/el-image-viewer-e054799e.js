import{iO as fe,kg as j,pb as me,iQ as H,d as J,fm as W,dJ as ve,pi as pe,iV as ge,iW as be,oq as ke,r as I,pj as we,cm as _e,c as k,y as K,aT as Ie,bx as xe,o as N,b as Z,i as l,w as v,k as m,p as d,B as a,a2 as q,bc as he,l as z,P as g,ez as ye,f as V,F as G,hN as Ne,nO as ze,pk as Ce,pl as Oe,cj as Ee,pm as Te,mE as Le,g as Se,e as Ve,S as Ae,h as Re,gl as $e,dy as Xe,j1 as Ye,fl as A,km as x,kA as E,pn as Be,j5 as Me}from"./index-b80d5ef5.js";const De=fe({urlList:{type:j(Array),default:()=>me([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:j(String)}}),Fe={close:()=>!0,switch:h=>H(h),rotate:h=>H(h)},Pe=["src","crossorigin"],je=J({name:"ElImageViewer"}),He=J({...je,props:De,emits:Fe,setup(h,{expose:Q,emit:C}){var R;const r=h,y={CONTAIN:{name:"contain",icon:W(ve)},ORIGINAL:{name:"original",icon:W(pe)}},{t:U}=ge(),n=be("image-viewer"),{nextZIndex:ee}=ke(),T=I(),$=I([]),X=we(),w=I(!0),p=I(r.initialIndex),O=_e(y.CONTAIN),o=I({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),ae=I((R=r.zIndex)!=null?R:ee()),te=k(()=>{const{urlList:e}=r;return e.length<=1}),Y=k(()=>p.value===0),B=k(()=>p.value===r.urlList.length-1),se=k(()=>r.urlList[p.value]),ne=k(()=>[n.e("btn"),n.e("prev"),n.is("disabled",!r.infinite&&Y.value)]),oe=k(()=>[n.e("btn"),n.e("next"),n.is("disabled",!r.infinite&&B.value)]),le=k(()=>{const{scale:e,deg:t,offsetX:s,offsetY:c,enableTransition:f}=o.value;let i=s/e,u=c/e;switch(t%360){case 90:case-270:[i,u]=[u,-i];break;case 180:case-180:[i,u]=[-i,-u];break;case 270:case-90:[i,u]=[-u,i];break}const _={transform:`scale(${e}) rotate(${t}deg) translate(${i}px, ${u}px)`,transition:f?"transform .3s":""};return O.value.name===y.CONTAIN.name&&(_.maxWidth=_.maxHeight="100%"),_});function L(){ie(),C("close")}function re(){const e=A(s=>{switch(s.code){case x.esc:r.closeOnPressEscape&&L();break;case x.space:D();break;case x.left:F();break;case x.up:b("zoomIn");break;case x.right:P();break;case x.down:b("zoomOut");break}}),t=A(s=>{const c=s.deltaY||s.deltaX;b(c<0?"zoomIn":"zoomOut",{zoomRate:r.zoomRate,enableTransition:!1})});X.run(()=>{E(document,"keydown",e),E(document,"wheel",t)})}function ie(){X.stop()}function ce(){w.value=!1}function ue(e){w.value=!1,e.target.alt=U("el.image.error")}function de(e){if(w.value||e.button!==0||!T.value)return;o.value.enableTransition=!1;const{offsetX:t,offsetY:s}=o.value,c=e.pageX,f=e.pageY,i=A(_=>{o.value={...o.value,offsetX:t+_.pageX-c,offsetY:s+_.pageY-f}}),u=E(document,"mousemove",i);E(document,"mouseup",()=>{u()}),e.preventDefault()}function M(){o.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function D(){if(w.value)return;const e=Be(y),t=Object.values(y),s=O.value.name,f=(t.findIndex(i=>i.name===s)+1)%e.length;O.value=y[e[f]],M()}function S(e){const t=r.urlList.length;p.value=(e+t)%t}function F(){Y.value&&!r.infinite||S(p.value-1)}function P(){B.value&&!r.infinite||S(p.value+1)}function b(e,t={}){if(w.value)return;const{minScale:s,maxScale:c}=r,{zoomRate:f,rotateDeg:i,enableTransition:u}={zoomRate:r.zoomRate,rotateDeg:90,enableTransition:!0,...t};switch(e){case"zoomOut":o.value.scale>s&&(o.value.scale=Number.parseFloat((o.value.scale/f).toFixed(3)));break;case"zoomIn":o.value.scale<c&&(o.value.scale=Number.parseFloat((o.value.scale*f).toFixed(3)));break;case"clockwise":o.value.deg+=i,C("rotate",o.value.deg);break;case"anticlockwise":o.value.deg-=i,C("rotate",o.value.deg);break}o.value.enableTransition=u}return K(se,()=>{Ie(()=>{const e=$.value[0];e!=null&&e.complete||(w.value=!0)})}),K(p,e=>{M(),C("switch",e)}),xe(()=>{var e,t;re(),(t=(e=T.value)==null?void 0:e.focus)==null||t.call(e)}),Q({setActiveItem:S}),(e,t)=>(N(),Z(Xe,{to:"body",disabled:!e.teleported},[l($e,{name:"viewer-fade",appear:""},{default:v(()=>[m("div",{ref_key:"wrapper",ref:T,tabindex:-1,class:d(a(n).e("wrapper")),style:q({zIndex:ae.value})},[m("div",{class:d(a(n).e("mask")),onClick:t[0]||(t[0]=he(s=>e.hideOnClickModal&&L(),["self"]))},null,2),z(" CLOSE "),m("span",{class:d([a(n).e("btn"),a(n).e("close")]),onClick:L},[l(a(g),null,{default:v(()=>[l(a(ye))]),_:1})],2),z(" ARROW "),a(te)?z("v-if",!0):(N(),V(G,{key:0},[m("span",{class:d(a(ne)),onClick:F},[l(a(g),null,{default:v(()=>[l(a(Ne))]),_:1})],2),m("span",{class:d(a(oe)),onClick:P},[l(a(g),null,{default:v(()=>[l(a(ze))]),_:1})],2)],64)),z(" ACTIONS "),m("div",{class:d([a(n).e("btn"),a(n).e("actions")])},[m("div",{class:d(a(n).e("actions__inner"))},[l(a(g),{onClick:t[1]||(t[1]=s=>b("zoomOut"))},{default:v(()=>[l(a(Ce))]),_:1}),l(a(g),{onClick:t[2]||(t[2]=s=>b("zoomIn"))},{default:v(()=>[l(a(Oe))]),_:1}),m("i",{class:d(a(n).e("actions__divider"))},null,2),l(a(g),{onClick:D},{default:v(()=>[(N(),Z(Ee(a(O).icon)))]),_:1}),m("i",{class:d(a(n).e("actions__divider"))},null,2),l(a(g),{onClick:t[3]||(t[3]=s=>b("anticlockwise"))},{default:v(()=>[l(a(Te))]),_:1}),l(a(g),{onClick:t[4]||(t[4]=s=>b("clockwise"))},{default:v(()=>[l(a(Le))]),_:1})],2)],2),z(" CANVAS "),m("div",{class:d(a(n).e("canvas"))},[(N(!0),V(G,null,Se(e.urlList,(s,c)=>Ve((N(),V("img",{ref_for:!0,ref:f=>$.value[c]=f,key:s,src:s,style:q(a(le)),class:d(a(n).e("img")),crossorigin:e.crossorigin,onLoad:ce,onError:ue,onMousedown:de},null,46,Pe)),[[Ae,c===p.value]])),128))],2),Re(e.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var We=Ye(He,[["__file","image-viewer.vue"]]);const Ze=Me(We);export{Ze as E};
