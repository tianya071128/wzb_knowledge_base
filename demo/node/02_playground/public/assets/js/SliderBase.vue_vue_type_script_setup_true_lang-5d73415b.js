import{iO as ve,kg as te,iP as Ve,mW as Ne,iU as re,iS as fe,iR as Ee,iQ as me,kl as ze,r as O,bx as $e,kA as Fe,aT as se,c as v,iX as Ie,cm as Xe,bI as Ae,y as ne,d5 as Se,km as Ke,j2 as We,j4 as he,d as H,iW as ge,bK as Be,eK as ce,o as B,f as A,i as pe,w as we,k as D,t as Re,B as t,p as K,aU as Ye,a2 as j,j1 as Ce,j3 as ke,dN as Ue,iV as _e,mX as je,iZ as Oe,bJ as He,b as oe,l as ae,F as ue,g as ie,j5 as Ge,z as Je,ka as be}from"./index-b80d5ef5.js";import{E as Qe}from"./el-input-number-c15b1cc7.js";import{u as Ze}from"./useFieldMaxWidth-d82f063e.js";const Le=Symbol("sliderContextKey"),qe=ve({modelValue:{type:te([Number,Array]),default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:Ve,inputSize:Ve,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:te(Function),default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,debounce:{type:Number,default:300},label:{type:String,default:void 0},rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:te(Function),default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:Ne,default:"top"},marks:{type:te(Object)},validateEvent:{type:Boolean,default:!0}}),de=e=>me(e)||ze(e)&&e.every(me),De={[re]:de,[fe]:de,[Ee]:de},el=(e,l,o)=>{const a=O();return $e(async()=>{e.range?(Array.isArray(e.modelValue)?(l.firstValue=Math.max(e.min,e.modelValue[0]),l.secondValue=Math.min(e.max,e.modelValue[1])):(l.firstValue=e.min,l.secondValue=e.max),l.oldValue=[l.firstValue,l.secondValue]):(typeof e.modelValue!="number"||Number.isNaN(e.modelValue)?l.firstValue=e.min:l.firstValue=Math.min(e.max,Math.max(e.min,e.modelValue)),l.oldValue=l.firstValue),Fe(window,"resize",o),await se(),o()}),{sliderWrapper:a}},ll=e=>v(()=>e.marks?Object.keys(e.marks).map(Number.parseFloat).sort((o,a)=>o-a).filter(o=>o<=e.max&&o>=e.min).map(o=>({point:o,position:(o-e.min)*100/(e.max-e.min),mark:e.marks[o]})):[]),tl=(e,l,o)=>{const{form:a,formItem:s}=Ie(),i=Xe(),d=O(),b=O(),g={firstButton:d,secondButton:b},n=v(()=>e.disabled||(a==null?void 0:a.disabled)||!1),f=v(()=>Math.min(l.firstValue,l.secondValue)),r=v(()=>Math.max(l.firstValue,l.secondValue)),w=v(()=>e.range?`${100*(r.value-f.value)/(e.max-e.min)}%`:`${100*(l.firstValue-e.min)/(e.max-e.min)}%`),p=v(()=>e.range?`${100*(f.value-e.min)/(e.max-e.min)}%`:"0%"),L=v(()=>e.vertical?{height:e.height}:{}),P=v(()=>e.vertical?{height:w.value,bottom:p.value}:{width:w.value,left:p.value}),T=()=>{i.value&&(l.sliderSize=i.value[`client${e.vertical?"Height":"Width"}`])},z=c=>{const h=e.min+c*(e.max-e.min)/100;if(!e.range)return d;let N;return Math.abs(f.value-h)<Math.abs(r.value-h)?N=l.firstValue<l.secondValue?"firstButton":"secondButton":N=l.firstValue>l.secondValue?"firstButton":"secondButton",g[N]},k=c=>{const h=z(c);return h.value.setPosition(c),h},$=c=>{l.firstValue=c,y(e.range?[f.value,r.value]:c)},x=c=>{l.secondValue=c,e.range&&y([f.value,r.value])},y=c=>{o(re,c),o(fe,c)},S=async()=>{await se(),o(Ee,e.range?[f.value,r.value]:e.modelValue)},G=c=>{var h,N,Q,Z,q,_;if(n.value||l.dragging)return;T();let X=0;if(e.vertical){const C=(Q=(N=(h=c.touches)==null?void 0:h.item(0))==null?void 0:N.clientY)!=null?Q:c.clientY;X=(i.value.getBoundingClientRect().bottom-C)/l.sliderSize*100}else{const C=(_=(q=(Z=c.touches)==null?void 0:Z.item(0))==null?void 0:q.clientX)!=null?_:c.clientX,M=i.value.getBoundingClientRect().left;X=(C-M)/l.sliderSize*100}if(!(X<0||X>100))return k(X)};return{elFormItem:s,slider:i,firstButton:d,secondButton:b,sliderDisabled:n,minValue:f,maxValue:r,runwayStyle:L,barStyle:P,resetSize:T,setPosition:k,emitChange:S,onSliderWrapperPrevent:c=>{var h,N;((h=g.firstButton.value)!=null&&h.dragging||(N=g.secondButton.value)!=null&&N.dragging)&&c.preventDefault()},onSliderClick:c=>{G(c)&&S()},onSliderDown:async c=>{const h=G(c);h&&(await se(),h.value.onButtonDown(c))},setFirstValue:$,setSecondValue:x}},{left:al,down:nl,right:ol,up:sl,home:rl,end:ul,pageUp:il,pageDown:dl}=Ke,ml=(e,l,o)=>{const a=O(),s=O(!1),i=v(()=>l.value instanceof Function),d=v(()=>i.value&&l.value(e.modelValue)||e.modelValue),b=Se(()=>{o.value&&(s.value=!0)},50),g=Se(()=>{o.value&&(s.value=!1)},50);return{tooltip:a,tooltipVisible:s,formatValue:d,displayTooltip:b,hideTooltip:g}},cl=(e,l,o)=>{const{disabled:a,min:s,max:i,step:d,showTooltip:b,precision:g,sliderSize:n,formatTooltip:f,emitChange:r,resetSize:w,updateDragging:p}=Ae(Le),{tooltip:L,tooltipVisible:P,formatValue:T,displayTooltip:z,hideTooltip:k}=ml(e,f,b),$=O(),x=v(()=>`${(e.modelValue-s.value)/(i.value-s.value)*100}%`),y=v(()=>e.vertical?{bottom:x.value}:{left:x.value}),S=()=>{l.hovering=!0,z()},G=()=>{l.hovering=!1,l.dragging||k()},J=u=>{a.value||(u.preventDefault(),X(u),window.addEventListener("mousemove",C),window.addEventListener("touchmove",C),window.addEventListener("mouseup",M),window.addEventListener("touchend",M),window.addEventListener("contextmenu",M),$.value.focus())},W=u=>{a.value||(l.newPosition=Number.parseFloat(x.value)+u/(i.value-s.value)*100,R(l.newPosition),r())},U=()=>{W(-d.value)},c=()=>{W(d.value)},h=()=>{W(-d.value*4)},N=()=>{W(d.value*4)},Q=()=>{a.value||(R(0),r())},Z=()=>{a.value||(R(100),r())},q=u=>{let V=!0;[al,nl].includes(u.key)?U():[ol,sl].includes(u.key)?c():u.key===rl?Q():u.key===ul?Z():u.key===dl?h():u.key===il?N():V=!1,V&&u.preventDefault()},_=u=>{let V,F;return u.type.startsWith("touch")?(F=u.touches[0].clientY,V=u.touches[0].clientX):(F=u.clientY,V=u.clientX),{clientX:V,clientY:F}},X=u=>{l.dragging=!0,l.isClick=!0;const{clientX:V,clientY:F}=_(u);e.vertical?l.startY=F:l.startX=V,l.startPosition=Number.parseFloat(x.value),l.newPosition=l.startPosition},C=u=>{if(l.dragging){l.isClick=!1,z(),w();let V;const{clientX:F,clientY:Y}=_(u);e.vertical?(l.currentY=Y,V=(l.startY-l.currentY)/n.value*100):(l.currentX=F,V=(l.currentX-l.startX)/n.value*100),l.newPosition=l.startPosition+V,R(l.newPosition)}},M=()=>{l.dragging&&(setTimeout(()=>{l.dragging=!1,l.hovering||k(),l.isClick||R(l.newPosition),r()},0),window.removeEventListener("mousemove",C),window.removeEventListener("touchmove",C),window.removeEventListener("mouseup",M),window.removeEventListener("touchend",M),window.removeEventListener("contextmenu",M))},R=async u=>{if(u===null||Number.isNaN(+u))return;u<0?u=0:u>100&&(u=100);const V=100/((i.value-s.value)/d.value);let Y=Math.round(u/V)*V*(i.value-s.value)*.01+s.value;Y=Number.parseFloat(Y.toFixed(g.value)),Y!==e.modelValue&&o(re,Y),!l.dragging&&e.modelValue!==l.oldValue&&(l.oldValue=e.modelValue),await se(),l.dragging&&z(),L.value.updatePopper()};return ne(()=>l.dragging,u=>{p(u)}),{disabled:a,button:$,tooltip:L,tooltipVisible:P,showTooltip:b,wrapperStyle:y,formatValue:T,handleMouseEnter:S,handleMouseLeave:G,onButtonDown:J,onKeyDown:q,setPosition:R}},vl=(e,l,o,a)=>({stops:v(()=>{if(!e.showStops||e.min>e.max)return[];if(e.step===0)return[];const d=(e.max-e.min)/e.step,b=100*e.step/(e.max-e.min),g=Array.from({length:d-1}).map((n,f)=>(f+1)*b);return e.range?g.filter(n=>n<100*(o.value-e.min)/(e.max-e.min)||n>100*(a.value-e.min)/(e.max-e.min)):g.filter(n=>n>100*(l.firstValue-e.min)/(e.max-e.min))}),getStopStyle:d=>e.vertical?{bottom:`${d}%`}:{left:`${d}%`}}),fl=(e,l,o,a,s,i)=>{const d=n=>{s(re,n),s(fe,n)},b=()=>e.range?![o.value,a.value].every((n,f)=>n===l.oldValue[f]):e.modelValue!==l.oldValue,g=()=>{var n,f;e.min>e.max&&We("Slider","min should not be greater than max.");const r=e.modelValue;e.range&&Array.isArray(r)?r[1]<e.min?d([e.min,e.min]):r[0]>e.max?d([e.max,e.max]):r[0]<e.min?d([e.min,r[1]]):r[1]>e.max?d([r[0],e.max]):(l.firstValue=r[0],l.secondValue=r[1],b()&&(e.validateEvent&&((n=i==null?void 0:i.validate)==null||n.call(i,"change").catch(w=>he())),l.oldValue=r.slice())):!e.range&&typeof r=="number"&&!Number.isNaN(r)&&(r<e.min?d(e.min):r>e.max?d(e.max):(l.firstValue=r,b()&&(e.validateEvent&&((f=i==null?void 0:i.validate)==null||f.call(i,"change").catch(w=>he())),l.oldValue=r)))};g(),ne(()=>l.dragging,n=>{n||g()}),ne(()=>e.modelValue,(n,f)=>{l.dragging||Array.isArray(n)&&Array.isArray(f)&&n.every((r,w)=>r===f[w])&&l.firstValue===n[0]&&l.secondValue===n[1]||g()},{deep:!0}),ne(()=>[e.min,e.max],()=>{g()})},gl=ve({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:Ne,default:"top"}}),bl={[re]:e=>me(e)},yl=["tabindex"],Vl=H({name:"ElSliderButton"}),Sl=H({...Vl,props:gl,emits:bl,setup(e,{expose:l,emit:o}){const a=e,s=ge("slider"),i=Be({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:a.modelValue}),{disabled:d,button:b,tooltip:g,showTooltip:n,tooltipVisible:f,wrapperStyle:r,formatValue:w,handleMouseEnter:p,handleMouseLeave:L,onButtonDown:P,onKeyDown:T,setPosition:z}=cl(a,i,o),{hovering:k,dragging:$}=ce(i);return l({onButtonDown:P,onKeyDown:T,setPosition:z,hovering:k,dragging:$}),(x,y)=>(B(),A("div",{ref_key:"button",ref:b,class:K([t(s).e("button-wrapper"),{hover:t(k),dragging:t($)}]),style:j(t(r)),tabindex:t(d)?-1:0,onMouseenter:y[0]||(y[0]=(...S)=>t(p)&&t(p)(...S)),onMouseleave:y[1]||(y[1]=(...S)=>t(L)&&t(L)(...S)),onMousedown:y[2]||(y[2]=(...S)=>t(P)&&t(P)(...S)),onTouchstart:y[3]||(y[3]=(...S)=>t(P)&&t(P)(...S)),onFocus:y[4]||(y[4]=(...S)=>t(p)&&t(p)(...S)),onBlur:y[5]||(y[5]=(...S)=>t(L)&&t(L)(...S)),onKeydown:y[6]||(y[6]=(...S)=>t(T)&&t(T)(...S))},[pe(t(Ye),{ref_key:"tooltip",ref:g,visible:t(f),placement:x.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":x.tooltipClass,disabled:!t(n),persistent:""},{content:we(()=>[D("span",null,Re(t(w)),1)]),default:we(()=>[D("div",{class:K([t(s).e("button"),{hover:t(k),dragging:t($)}])},null,2)]),_:1},8,["visible","placement","popper-class","disabled"])],46,yl))}});var xe=Ce(Sl,[["__file","button.vue"]]);const hl=ve({mark:{type:te([String,Object]),default:void 0}});var wl=H({name:"ElSliderMarker",props:hl,setup(e){const l=ge("slider"),o=v(()=>ke(e.mark)?e.mark:e.mark.label),a=v(()=>ke(e.mark)?void 0:e.mark.style);return()=>Ue("div",{class:l.e("marks-text"),style:a.value},o.value)}});const kl=["id","role","aria-label","aria-labelledby"],xl={key:1},Nl=H({name:"ElSlider"}),El=H({...Nl,props:qe,emits:De,setup(e,{expose:l,emit:o}){const a=e,s=ge("slider"),{t:i}=_e(),d=Be({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:b,slider:g,firstButton:n,secondButton:f,sliderDisabled:r,minValue:w,maxValue:p,runwayStyle:L,barStyle:P,resetSize:T,emitChange:z,onSliderWrapperPrevent:k,onSliderClick:$,onSliderDown:x,setFirstValue:y,setSecondValue:S}=tl(a,d,o),{stops:G,getStopStyle:J}=vl(a,d,w,p),{inputId:W,isLabeledByFormItem:U}=je(a,{formItemContext:b}),c=Oe(),h=v(()=>a.inputSize||c.value),N=v(()=>a.label||i("el.slider.defaultLabel",{min:a.min,max:a.max})),Q=v(()=>a.range?a.rangeStartLabel||i("el.slider.defaultRangeStartLabel"):N.value),Z=v(()=>a.formatValueText?a.formatValueText(u.value):`${u.value}`),q=v(()=>a.rangeEndLabel||i("el.slider.defaultRangeEndLabel")),_=v(()=>a.formatValueText?a.formatValueText(V.value):`${V.value}`),X=v(()=>[s.b(),s.m(c.value),s.is("vertical",a.vertical),{[s.m("with-input")]:a.showInput}]),C=ll(a);fl(a,d,w,p,o,b);const M=v(()=>{const m=[a.min,a.max,a.step].map(I=>{const ee=`${I}`.split(".")[1];return ee?ee.length:0});return Math.max.apply(null,m)}),{sliderWrapper:R}=el(a,d,T),{firstValue:u,secondValue:V,sliderSize:F}=ce(d),Y=m=>{d.dragging=m};return He(Le,{...ce(a),sliderSize:F,disabled:r,precision:M,emitChange:z,resetSize:T,updateDragging:Y}),l({onSliderClick:$}),(m,I)=>{var ee,ye;return B(),A("div",{id:m.range?t(W):void 0,ref_key:"sliderWrapper",ref:R,class:K(t(X)),role:m.range?"group":void 0,"aria-label":m.range&&!t(U)?t(N):void 0,"aria-labelledby":m.range&&t(U)?(ee=t(b))==null?void 0:ee.labelId:void 0,onTouchstart:I[2]||(I[2]=(...E)=>t(k)&&t(k)(...E)),onTouchmove:I[3]||(I[3]=(...E)=>t(k)&&t(k)(...E))},[D("div",{ref_key:"slider",ref:g,class:K([t(s).e("runway"),{"show-input":m.showInput&&!m.range},t(s).is("disabled",t(r))]),style:j(t(L)),onMousedown:I[0]||(I[0]=(...E)=>t(x)&&t(x)(...E)),onTouchstart:I[1]||(I[1]=(...E)=>t(x)&&t(x)(...E))},[D("div",{class:K(t(s).e("bar")),style:j(t(P))},null,6),pe(xe,{id:m.range?void 0:t(W),ref_key:"firstButton",ref:n,"model-value":t(u),vertical:m.vertical,"tooltip-class":m.tooltipClass,placement:m.placement,role:"slider","aria-label":m.range||!t(U)?t(Q):void 0,"aria-labelledby":!m.range&&t(U)?(ye=t(b))==null?void 0:ye.labelId:void 0,"aria-valuemin":m.min,"aria-valuemax":m.range?t(V):m.max,"aria-valuenow":t(u),"aria-valuetext":t(Z),"aria-orientation":m.vertical?"vertical":"horizontal","aria-disabled":t(r),"onUpdate:modelValue":t(y)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),m.range?(B(),oe(xe,{key:0,ref_key:"secondButton",ref:f,"model-value":t(V),vertical:m.vertical,"tooltip-class":m.tooltipClass,placement:m.placement,role:"slider","aria-label":t(q),"aria-valuemin":t(u),"aria-valuemax":m.max,"aria-valuenow":t(V),"aria-valuetext":t(_),"aria-orientation":m.vertical?"vertical":"horizontal","aria-disabled":t(r),"onUpdate:modelValue":t(S)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):ae("v-if",!0),m.showStops?(B(),A("div",xl,[(B(!0),A(ue,null,ie(t(G),(E,le)=>(B(),A("div",{key:le,class:K(t(s).e("stop")),style:j(t(J)(E))},null,6))),128))])):ae("v-if",!0),t(C).length>0?(B(),A(ue,{key:2},[D("div",null,[(B(!0),A(ue,null,ie(t(C),(E,le)=>(B(),A("div",{key:le,style:j(t(J)(E.position)),class:K([t(s).e("stop"),t(s).e("marks-stop")])},null,6))),128))]),D("div",{class:K(t(s).e("marks"))},[(B(!0),A(ue,null,ie(t(C),(E,le)=>(B(),oe(t(wl),{key:le,mark:E.mark,style:j(t(J)(E.position))},null,8,["mark","style"]))),128))],2)],64)):ae("v-if",!0)],38),m.showInput&&!m.range?(B(),oe(t(Qe),{key:0,ref:"input","model-value":t(u),class:K(t(s).e("input")),step:m.step,disabled:t(r),controls:m.showInputControls,min:m.min,max:m.max,debounce:m.debounce,size:t(h),"onUpdate:modelValue":t(y),onChange:t(z)},null,8,["model-value","class","step","disabled","controls","min","max","debounce","size","onUpdate:modelValue","onChange"])):ae("v-if",!0)],42,kl)}}});var Bl=Ce(El,[["__file","slider.vue"]]);const pl=Ge(Bl);const Cl=H({__name:"AzSlider",props:{modelValue:{},max:{},min:{},step:{}},emits:["update:modelValue"],setup(e,{emit:l}){const o=e,a=l,s=v(()=>Number(o.min??void 0)||0),i=v(()=>{let n=Number(o.max??void 0);return isNaN(n)&&(n=100),n<s.value&&(n=s.value),n}),d=v(()=>{let n=Number(o.step??void 0);return isNaN(n)&&(n=1),n>i.value-s.value&&(n=i.value-s.value),n});Je(()=>{Number(o.max??100)<Number(o.min??0)&&console.error(`自定义错误: [AzSlider] 最小值(${o.min})不应大于最大值${o.max}，已自动修复为最小值${s.value}、最大值${i.value}`)});const b=v({set(n){a("update:modelValue",n??null)},get(){if(o.modelValue==null)return;let n=Number(o.modelValue??void 0);return isNaN(n)&&(n=0),n<s.value&&(n=s.value),n>i.value&&(n=i.value),n!==o.modelValue&&a("update:modelValue",n),n}}),g=O(!0);return ne([i,s],()=>{g.value=!1,se(()=>g.value=!0)}),(n,f)=>{const r=pl;return g.value?(B(),oe(r,{key:0,modelValue:b.value,"onUpdate:modelValue":f[0]||(f[0]=w=>b.value=w),max:i.value,min:s.value,step:d.value},null,8,["modelValue","max","min","step"])):ae("",!0)}}}),Pe=e=>be(e.max)?Number(e.max):100,Te=e=>be(e.min)?Number(e.min):0,Me=e=>be(e.step)?Number(e.step):1,Ll=e=>{const l=Pe(e),o=Te(e);return(l-o)/Me(e)<=100},Pl=e=>Ll(e)?e.showStops:!1,$l=H({__name:"SliderBase",props:{field:{}},setup(e){const l=e,{maxWidthStyle:o}=Ze(l.field);return(a,s)=>(B(),oe(Cl,{style:j(t(o)),min:t(Te)(a.field.options),max:t(Pe)(a.field.options),step:t(Me)(a.field.options),"show-stops":t(Pl)(a.field.options)},null,8,["style","min","max","step","show-stops"]))}});export{pl as E,$l as _,Cl as a,Pe as b,Ll as c,Me as d,Te as g};
