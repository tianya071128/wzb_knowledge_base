import{d8 as h,d as z,r as _,v as q,c as L,bK as $,o as R,b as x,w as t,i as a,bu as D,m as o,t as r,B as S,bs as V,rI as I,l as U,C as F,bv as O,bT as Y,bU as j,E as G,ab as H,ac as K,Q,bm as J,bi as W,f as X,cc as Z,U as ee}from"./index-b80d5ef5.js";import{_ as te}from"./TableOperation.vue_vue_type_script_setup_true_lang-4afbb2cb.js";const ae=c=>h.value.request.post(`${h.value.SYSTEMURL}/corp_appeal/listPage`,c),le=c=>h.value.request.get(`${h.value.SYSTEMURL}/corp_appeal/queryById/${c}`),se=c=>h.value.request.post(`${h.value.SYSTEMURL}/corp_appeal/doAppeal`,c),oe=z({__name:"open-audit",props:{drawerModel:{type:Boolean},comState:{},ids:{}},emits:["update:drawerModel","refresh"],setup(c,{emit:f}){const b=f,n=c,g=_(),m=i=>n.comState===i,v=q(n,"drawerModel",b),T=L(()=>({add:"审核",view:"查看",batch:"批量审核"})[n.comState]),A={auditRemarks:"",status:"1",ids:[]},l=_(),p=_({...A}),s=$({status:[{required:!0,message:"请选择审核结果",trigger:"blur"}]}),y=async()=>{n.ids&&n.ids.length===1&&(l.value=await le(n.ids[0])),n.ids&&(p.value={auditRemarks:"",status:"1",ids:n.ids})},k=async()=>{var i;await((i=g.value)==null?void 0:i.validate()),await se(p.value),b("refresh")};return(i,d)=>{const u=Y,E=j,C=G,B=H,P=K,M=Q,N=J;return R(),x(O,{modelValue:S(v),"onUpdate:modelValue":d[3]||(d[3]=w=>F(v)?v.value=w:null),size:"600px",title:T.value,"show-load":y},{footer:t(()=>[a(D,{editMode:!0,onClose:d[2]||(d[2]=w=>v.value=!1),"is-submit":m("add")||m("batch"),"on-submit":k},null,8,["is-submit"])]),default:t(()=>{var w;return[m("batch")?U("",!0):(R(),x(E,{key:0,title:"基本信息",column:2,size:"default",border:""},{default:t(()=>[a(u,{label:"企业名称"},{default:t(()=>{var e;return[o(r(((e=l.value)==null?void 0:e.corpName)||"-"),1)]}),_:1}),a(u,{label:"机构类型"},{default:t(()=>{var e;return[o(r(S(V)((e=l.value)==null?void 0:e.type,"org_type")||"-"),1)]}),_:1}),a(u,{label:"企业证件号"},{default:t(()=>{var e;return[o(r(((e=l.value)==null?void 0:e.certificateNumber)||"-"),1)]}),_:1}),a(u,{label:"证件类型"},{default:t(()=>{var e;return[o(r(S(V)((e=l.value)==null?void 0:e.certificateType,"certificate_type")||"-"),1)]}),_:1}),a(u,{label:"申请人"},{default:t(()=>{var e;return[o(r(((e=l.value)==null?void 0:e.appealUser)||"-"),1)]}),_:1}),a(u,{label:"手机号"},{default:t(()=>{var e;return[o(r(((e=l.value)==null?void 0:e.tel)||"-"),1)]}),_:1}),a(u,{label:"联系方式"},{default:t(()=>{var e;return[o(r(((e=l.value)==null?void 0:e.tel)||"-"),1)]}),_:1}),a(u,{label:"联系邮箱"},{default:t(()=>{var e;return[o(r(((e=l.value)==null?void 0:e.email)||"-"),1)]}),_:1}),a(u,{label:"申诉原因"},{default:t(()=>{var e;return[o(r(S(V)((e=l.value)==null?void 0:e.appealReason,S(I))||"-"),1)]}),_:1}),a(u,{label:"申诉资料"},{default:t(()=>{var e;return[o(r(((e=l.value)==null?void 0:e.certificatesUrl)||"-"),1)]}),_:1})]),_:1})),m("view")&&String((w=l.value)==null?void 0:w.status)!=="0"?(R(),x(E,{key:1,style:{"margin-top":"20px"},title:"审核信息",column:2,size:"default",border:""},{default:t(()=>[a(u,{label:"审核人"},{default:t(()=>{var e;return[o(r(((e=l.value)==null?void 0:e.auditUser)||"-"),1)]}),_:1}),a(u,{label:"审核时间"},{default:t(()=>{var e;return[o(r(((e=l.value)==null?void 0:e.auditTime)||"-"),1)]}),_:1}),a(u,{label:"审核结果",span:2},{default:t(()=>{var e;return[o(r(S(V)((e=l.value)==null?void 0:e.status,"APPROVAL_STATUS")||"-"),1)]}),_:1}),a(u,{label:"说明",span:2},{default:t(()=>{var e;return[o(r(((e=l.value)==null?void 0:e.auditRemarks)||"-"),1)]}),_:1})]),_:1})):U("",!0),m("add")||m("batch")?(R(),x(N,{key:2,ref_key:"ruleFormRef",ref:g,rules:s,model:p.value,style:{"margin-top":"20px"},"label-position":"left"},{default:t(()=>[a(P,{label:"审核结果",prop:"status"},{default:t(()=>[a(B,{modelValue:p.value.status,"onUpdate:modelValue":d[0]||(d[0]=e=>p.value.status=e)},{default:t(()=>[a(C,{label:"1"},{default:t(()=>[o("申诉成功")]),_:1}),a(C,{label:"2"},{default:t(()=>[o("申诉失败")]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(P,{label:"说明"},{default:t(()=>[a(M,{type:"textarea",modelValue:p.value.auditRemarks,"onUpdate:modelValue":d[1]||(d[1]=e=>p.value.auditRemarks=e),placeholder:"请输入说明"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])):U("",!0)]}),_:1},8,["modelValue","title"])}}}),ue={name:"Audit"},ie=z({...ue,setup(c){const f=_(!1),b=_(),n=_(""),g=_([]),m=s=>{g.value=s},v=_(),A={query:{list:[{type:"input",label:"企业名称",prop:"corpName"},{type:"input",label:"申诉人",prop:"nickname"},{type:"select",label:"状态",prop:"status",options:"APPROVAL_STATUS",isAll:!0,initValue:Z}]},request:{api:ae},table:{tableProps:{"onSelection-change":m},tableCols:[{type:"selection",selectable:(s,y)=>String(s.status)==="0"},{prop:"corpName",label:"企业名称"},{prop:"certificateNumber",label:"企业证件号"},{prop:"appealUser",label:"申诉人"},{prop:"tel",label:"联系方式"},{prop:"createTime",label:"申请时间"},{prop:"status",label:"状态",slots:{default({row:s}){return a("span",null,[V(s.status,"APPROVAL_STATUS")])}}},{fixed:"right",width:180,label:"操作",slots:{default({row:s}){const y=()=>{b.value=[s.id],n.value="add",f.value=!0},i=[{type:"primary",onClick:()=>{b.value=[s.id],n.value="view",f.value=!0},text:"查看"}];return String(s.status)==="0"&&i.unshift({type:"primary",onClick:y,text:"审核"}),a(te,{num:2,rowId:s.id,list:i},null)}}}]}},l=async()=>{var s;await((s=v.value)==null?void 0:s.refresh())},p=async()=>{g.value.length>=1&&(b.value=g.value.map(s=>s.id),n.value="batch",f.value=!0)};return(s,y)=>{const k=ee,i=W("az-page");return R(),X("div",null,[a(i,{class:"layout_box",ref_key:"azPageRef",ref:v,config:A,maxHeight:"var(--az-layout-main-height) - 40px"},{operation:t(()=>[a(k,{type:"primary",onClick:p},{default:t(()=>[o("批量审核")]),_:1})]),_:1},512),a(oe,{"drawer-model":f.value,"onUpdate:drawerModel":y[0]||(y[0]=d=>f.value=d),"com-state":n.value,onRefresh:l,ids:b.value},null,8,["drawer-model","com-state","ids"])])}}});export{ie as default};
