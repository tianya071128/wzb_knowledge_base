import{r as n,sX as T,c,bs as C,sY as f,d as I,t0 as D,sZ as w,s$ as V,bp as A,i,as as B,bi as L,o as _,f as h,w as v,B as t,m as E,b as F,C as z,l as $,fx as O,aN as R,U as S}from"./index-b80d5ef5.js";import{_ as U}from"./DetailDrawer.vue_vue_type_script_setup_true_lang-c85f86c1.js";import{g as q,l as j,e as G}from"./log-64267fd3.js";const M=()=>{const u=n(!1),r=n(""),p=T(),m=c(()=>p.isPlatformAdmin),b=c(()=>{let e=[{label:"操作人",prop:"createName"},{label:"操作账号",prop:"account"},{label:"所属机构",prop:"orgName"},{label:"手机号码",prop:"phone"},{label:"操作时间",prop:"createTime"},{label:"操作模块",prop:"module"},{label:"操作类型",prop:"operationType"},{label:"操作详情",prop:"logDetail"},{label:"IP",prop:"remoteAddr"},{label:"操作结果",prop:"isFail",formatter:s=>C(s.isFail,f)},{label:"失败原因",prop:"failInfo"}];return m.value||(e=e.filter(s=>s.prop!=="orgName")),e});return{detailVisible:u,items:b,logId:r,loadDetails:async()=>await q(r.value)}},X=M,J=I({__name:"routePage",props:{logType:{default:D.securityLog}},setup(u){const r=u,p=n(),m=T(),b=c(()=>m.isPlatformAdmin),g=c(()=>{var l;const a={query:{list:[{label:"操作人",prop:"createName",type:"input"},{label:"手机号码",prop:"phone",type:"input"},{label:"操作时间",prop:["startTime","endTime"],type:"timerange"},{label:"操作模块",prop:"module",type:"select",options:w},{label:"操作类型",prop:"operationType",type:"select",options:V},{label:"操作结果",prop:"isFail",type:"select",options:A(f)}]},request:{api:j,extraParams:{logType:r.logType}},table:{tableCols:[{label:"操作人",prop:"createName"},{label:"操作账号",prop:"account"},{label:"所属机构",prop:"orgName"},{label:"手机号码",prop:"phone"},{label:"操作时间",prop:"createTime"},{label:"操作模块",prop:"module"},{label:"操作类型",prop:"operationType"},{label:"操作详情",prop:"logDetail"},{label:"IP",prop:"remoteAddr"},{label:"操作结果",prop:"isFail",slots:{default({row:o}){return i("span",null,[C(o.isFail,f)])}}},{label:"失败原因",prop:"failInfo",showOverflowTooltip:!0},{label:"操作",slots:{default({row:o}){return i(B,{list:[{id:"view",type:"primary",text:"查看详情",onClick:()=>{P.value=o.id,e.value=!0}}]},null)}}}]}};return!b.value&&((l=a.table)!=null&&l.tableCols)&&(a.table.tableCols=a.table.tableCols.filter(o=>o.prop!=="orgName")),a}),{detailVisible:e,items:s,logId:P,loadDetails:x}=X(),d=n(!1),N=async()=>{var a;try{d.value=!0;const l=(a=p.value)==null?void 0:a.handleGetParams();await G(O(l,["limit","current"])),R.success("导出成功")}finally{d.value=!1}};return(a,l)=>{const o=S,y=L("az-page");return _(),h("div",{class:"layout_box"},[i(y,{ref_key:"azPageRef",ref:p,config:t(g)},{operation:v(()=>[i(o,{type:"warning",onClick:N,loading:t(d)},{default:v(()=>[E(" 导出 ")]),_:1},8,["loading"])]),_:1},8,["config"]),t(e)?(_(),F(U,{key:0,list:t(s),modelValue:t(e),"onUpdate:modelValue":l[0]||(l[0]=k=>z(e)?e.value=k:null),load:t(x)},null,8,["list","modelValue","load"])):$("",!0)])}}});export{J as _};
