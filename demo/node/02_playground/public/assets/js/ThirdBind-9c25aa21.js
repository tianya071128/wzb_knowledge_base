import{d as w,r as E,o as n,b as _,w as u,B as r,l as d,C as N,rE as F,bn as U,_ as I,v as W,c as g,bp as $,rF as M,f as v,i as C,F as k,g as R,k as S,t as G,m as x,aa as H,rG as O,aN as V,rH as j,U as q,av as z,bT as J,bU as K}from"./index-b80d5ef5.js";import{_ as P}from"./WeComCode.vue_vue_type_script_setup_true_lang-dc462ebc.js";const Q=w({__name:"WeCom",props:{bind:{type:Function}},setup(b,{expose:h}){const T=b,o=E(!1),s=async i=>{await T.bind({thirdType:F,code:i}),o.value=!1};return h({open:()=>{o.value=!0}}),(i,p)=>{const c=U;return n(),_(c,{title:"绑定企业微信",width:"352px","append-to-body":"",modelValue:r(o),"onUpdate:modelValue":p[0]||(p[0]=f=>N(o)?o.value=f:null)},{default:u(()=>[r(o)?(n(),_(P,{key:0,onOnLoginSuccess:s,small:""})):d("",!0)]),_:1},8,["modelValue"])}}});const X=I(Q,[["__scopeId","data-v-0be36c0d"]]),Y=w({__name:"ThirdBind",props:{modelValue:{},readonly:{type:Boolean}},emits:["update:modelValue"],setup(b,{emit:h}){const s=W(b,"modelValue",h),i=g(()=>{var e;return((e=s.value)==null?void 0:e.userThirdAccounts)??[]}),p=g(()=>$(M)),c=g(()=>e=>{const t=i.value.find(a=>a.thirdType===e);return t?t.thirdUserId:""}),f=E(),L=()=>{var e;(e=f.value)==null||e.open()},A=e=>{const t=i.value.find(a=>a.thirdType===e);t&&H.confirm("确认将该企业微信账号解绑吗？解绑后，不能再使用该企业微信号进行扫码登录。","提示",{confirmButtonText:"解绑",cancelButtonText:"取消",async beforeClose(a,m,y){if(a==="confirm"){m.confirmButtonLoading=!0;try{await O(t.id),V.success("解绑成功！"),s.value&&(s.value.userThirdAccounts=i.value.filter(B=>B.thirdType!==e)),y()}finally{m.confirmButtonLoading=!1}}else y()}})},D=async e=>{const t=await j(e);V.success("绑定成功！"),s.value&&s.value.userThirdAccounts.push(t)};return(e,t)=>{const a=q,m=z,y=J,B=K;return n(),v(k,null,[C(B,{class:"mt-20",title:"第三方登录信息",border:"",column:1},{default:u(()=>[(n(!0),v(k,null,R(r(p),l=>(n(),_(y,{label:`${l.label}账号`,key:l.value},{default:u(()=>[r(c)(l.value)?(n(),v(k,{key:0},[S("span",null,G(r(c)(l.value)),1),e.readonly?d("",!0):(n(),_(a,{key:0,type:"primary",onClick:Z=>A(l.value),text:""},{default:u(()=>[x(" 解除绑定 ")]),_:2},1032,["onClick"]))],64)):d("",!0),!e.readonly&&!r(c)(l.value)?(n(),_(m,{key:1,type:"primary",underline:!1,onClick:L},{default:u(()=>[x(" 立即绑定 ")]),_:1})):d("",!0),!r(c)(l.value)&&e.readonly?(n(),v("span",{key:2},"-")):d("",!0)]),_:2},1032,["label"]))),128))]),_:1}),C(X,{ref_key:"weComRef",ref:f,bind:D},null,512)],64)}}});const te=I(Y,[["__scopeId","data-v-6d777d23"]]);export{te as T};
