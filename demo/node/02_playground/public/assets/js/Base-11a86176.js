import{d as R,bJ as H,c as y,o as c,b as g,ad as V,g as D,p as z,B as s,d3 as Q,w as I,h,_ as j,bI as L,r as F,eK as U,k as B,i as $,gn as W,cj as N,m as K,t as T,f as C,l as A,P as X,d2 as Y,a as Z,jG as x,y as G,of as E,mo as ee,g2 as se,F as J,a2 as te,og as M,oh as ie,h7 as O,bz as ne,e as oe,S as le}from"./index-b80d5ef5.js";import{a as ae,u as de}from"./useValidateError-9f6399dc.js";var f=(a=>(a.default="0",a.one="1",a.two="2",a))(f||{});const P=Symbol("自定义步骤条样式"),ye=[f.default,f.one,f.two],re=R({__name:"AzSteps",props:{direction:{},type:{default:f.default}},setup(a){const n=a;H(P,n);const o=y(()=>n.type===f.default?n.direction:"horizontal");return(i,d)=>{const k=Q;return c(),g(k,{class:z({steps_one:i.type===s(f).one,steps_two:i.type===s(f).two}),direction:o.value},V({_:2},[D(i.$slots||{},(v,t,u)=>({name:t,fn:I(()=>[h(i.$slots,t,{},void 0,!0)])}))]),1032,["class","direction"])}}});const ce=j(re,[["__scopeId","data-v-5131715b"]]),ue=R({__name:"AzStep",props:{title:{},icon:{},description:{}},setup(a){const n=L("ElSteps"),o=F(),i=y(()=>n==null?void 0:n.steps.value.findIndex(t=>{var u;return t.uid===((u=o.value)==null?void 0:u.$.uid)})),d=y(()=>{var t,u,_;return i.value>-1&&((t=n==null?void 0:n.steps.value[i.value])==null?void 0:t.currentStatus)==="finish"&&(((u=n==null?void 0:n.steps.value[i.value+1])==null?void 0:u.currentStatus)==="process"||((_=n==null?void 0:n.steps.value[i.value+1])==null?void 0:_.currentStatus)==="finish")}),k=L(P,void 0),{type:v}=U(k);return(t,u)=>{var w;const _=X,S=Y;return s(v)===s(f).one?(c(),g(S,{key:0,class:z(["az_step steps_one",{"is-line-active":d.value}]),ref_key:"elStepRef",ref:o},{title:I(()=>[B("div",{class:"az_step-one"},[B("span",{class:"one-icon"},[h(t.$slots,"icon",{},()=>[$(_,null,{default:I(()=>[t.icon?(c(),g(N(t.icon),{key:1})):(c(),g(s(W),{key:0}))]),_:1})],!0)]),h(t.$slots,"title",{},()=>[K(T(t.title),1)],!0)])]),_:3},8,["class"])):s(v)===s(f).two?(c(),g(S,{key:1,class:z(["az_step steps_two",{"is-line-active":d.value,"is-two":((w=s(n))==null?void 0:w.steps.value.length)===2}]),ref_key:"elStepRef",ref:o},{title:I(()=>[B("div",{class:"az_step-two"},[t.$slots.icon||t.icon?(c(),C("span",{key:0,class:"two-icon"},[h(t.$slots,"icon",{},()=>[$(_,null,{default:I(()=>[(c(),g(N(t.icon)))]),_:1})],!0)])):A("",!0),B("span",{class:"van-multi-ellipsis--l2"},[h(t.$slots,"title",{},()=>[K(T(t.title),1)],!0)])])]),_:3},8,["class"])):(c(),g(S,{key:2,class:z(["az_step",{"is-line-active":d.value}]),ref_key:"elStepRef",ref:o,title:t.title,icon:t.icon,description:t.description},V({_:2},[D(t.$slots||{},(r,p,e)=>({name:p,fn:I(()=>[h(t.$slots,p,{},void 0,!0)])}))]),1032,["title","icon","description","class"]))}}});const pe=j(ue,[["__scopeId","data-v-25686ff1"]]);function fe(a){var p;const n=y(()=>a.type===Z.steps),o=x(),i=y(()=>o?a.fields.filter(e=>!o||!!o.getFieldShow(e.fieldId)):a.fields),d=F(((p=i.value[0])==null?void 0:p.fieldId)??""),k=y(()=>i.value.find(e=>e.fieldId===d.value)),v=y(()=>{if(n.value)return i.value.findIndex(e=>e.fieldId===d.value)});G(()=>i.value.map(e=>e.fieldId),e=>{var l;e.includes(d.value)||(d.value=((l=i.value[0])==null?void 0:l.fieldId)??"")});const t=(e,l)=>{var b;(e.target&&((b=window.getComputedStyle(e.target))==null?void 0:b.cursor))==="pointer"&&u(l)},u=e=>{e&&(d.value=e.fieldId)},_=y(()=>v.value===0),S=y(()=>v.value===i.value.length-1),w=F(new Map),r=async e=>{if(n.value||!e)return;let l=E.wait;if(o){for(const m of e.options.rules)if(await ee(m.condition,{formData:o.packageNormlData(),getFieldInfo(q){return se(q,o.formDesigner.fields)}})){l=m.state;break}}return l};return G([()=>i.value.map(e=>e.options.rules),()=>o==null?void 0:o.packageNormlData()],()=>{if(o)for(const e of i.value)r(e).then(l=>w.value.set(e.fieldId,l??E.wait))},{immediate:!0}),ae(a,({fieldIds:e})=>{var m;const l=(m=a.fields.find(b=>e.includes(b.fieldId)))==null?void 0:m.fieldId;l&&(d.value=l)}),de(a,({fieldIds:e})=>{var m;const l=(m=a.fields.find(b=>e.includes(b.fieldId)))==null?void 0:m.fieldId;l&&(d.value=l)}),{isLayoutSteps:n,sonFields:i,active:v,activeField:k,handleClick:t,prevDisabled:_,nextDisabled:S,jumpStep:u,render:o,sonFieldStatus:w}}const ve=R({__name:"Base",props:{field:{}},setup(a){const n=a,{isLayoutSteps:o,sonFields:i,active:d,activeField:k,sonFieldStatus:v,handleClick:t,prevDisabled:u,nextDisabled:_,jumpStep:S,render:w}=fe(n.field);return(r,p)=>(c(),C("div",{class:z(["step_field",{"is-layout-steps":s(o),"is-render":!!s(w)}])},[B("div",{class:z(["step_field-body",{"step_field-vertical":r.field.options.direction===s(M).vertical}])},[$(ce,{class:"step_field-step",style:te({height:r.field.options.direction===s(M).vertical?`${s(i).length*100}px`:void 0}),active:s(d),"align-center":r.field.options.alignCenter,direction:r.field.options.direction,space:r.field.options.spaceType===s(ie).custom?r.field.options.space:void 0,type:r.field.options.style},{default:I(()=>[(c(!0),C(J,null,D(s(i),e=>(c(),g(pe,{class:z({"is-click":!0}),key:e.fieldId,title:e.options.label,description:e.options.description,status:s(o)?void 0:s(v).get(e.fieldId)??s(E).wait,onClick:l=>s(t)(l,e)},V({_:2},[e.options.icon?{name:"icon",fn:I(()=>[$(ne,{"class-name":"el-icon el-step__icon-inner","icon-class":e.options.icon},null,8,["icon-class"])]),key:"0"}:void 0]),1032,["title","description","status","onClick"]))),128))]),_:1},8,["style","active","align-center","direction","space","type"]),s(o)?(c(!0),C(J,{key:0},D(s(i),e=>{var l;return oe((c(),C("div",{class:"step_field-container",key:e.fieldId},[h(r.$slots,"default",{subField:e},void 0,!0)])),[[le,e.fieldId===((l=s(k))==null?void 0:l.fieldId)]])}),128)):A("",!0)],2),r.field.options.isBtn&&s(o)&&s(d)!==void 0?(c(),C("div",{key:0,class:"step_field-btns"},[$(O,{preview:"","model-value":r.field.options.prevBtn,disabled:s(u),onClick:p[0]||(p[0]=e=>s(S)(s(i)[s(d)-1]))},null,8,["model-value","disabled"]),$(O,{preview:"","model-value":r.field.options.nextBtn,disabled:s(_),onClick:p[1]||(p[1]=e=>s(S)(s(i)[s(d)+1]))},null,8,["model-value","disabled"])])):A("",!0)],2))}});const Se=j(ve,[["__scopeId","data-v-7d60f44c"]]);export{ce as A,Se as B,f as S,pe as a,ye as s};
