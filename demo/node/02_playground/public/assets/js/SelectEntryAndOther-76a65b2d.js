import{d as v,x as h,o as d,b as g,w as I,f as S,F as V,g as b,h as x,i as A,bt as F,iJ as E,a1 as L,ao as w,_ as k,r as O,y as P,a9 as $,c as B,n as f,V as C}from"./index-b80d5ef5.js";const T=v({__name:"SelectEntry",props:{appId:{},entryList:{},filter:{type:Function}},setup(s){const i=s,r=h(),_=a=>{var l;return(l=a==null?void 0:a.every)==null?void 0:l.call(a,o=>typeof o=="string")},c=async()=>{let a=i.entryList;return a||(i.appId&&(a=await r.getForm(i.appId)),a||(a=[])),_(a)&&(a=(await Promise.all(a.map(o=>r.getFormInfo(o)))).filter(o=>o!==E)),a.filter(l=>l.type===L.form)},m=a=>{let l=a;return i.filter&&(l=i.filter(l)),l};return(a,l)=>{const o=w;return d(),g(F,{load:c,filterable:"",isCheckRemove:"",removeText:"表单已删除/表单不可选择",class:"select_entry"},{default:I(({options:n})=>[(d(!0),S(V,null,b(m(n),(e,t)=>x(a.$slots,"option",{key:t,item:e},()=>[A(o,{label:e.name,value:e.id},null,8,["label","value"])],!0)),128))]),_:3})}}});const U=k(T,[["__scopeId","data-v-8d7a2100"]]);var u=(s=>(s.entry="entry",s.aggregation="aggregation",s))(u||{}),R=(s=>(s.entry="entry",s.aggregation="aggregation",s))(R||{}),z=(s=>(s.entry="0",s.aggregation="1",s))(z||{});const j=v({__name:"SelectEntryAndOther",props:{modelValue:{},multiple:{type:Boolean},appId:{},sources:{},filter:{type:Function},type:{}},emits:["update:modelValue"],setup(s,{emit:i}){const r=s,_=i,c=h(),m=async()=>{let n=[];return!r.sources&&r.appId?n=(await c.getForm(r.appId)).map(e=>({id:e.id,type:u.entry,entryType:e.type,name:e.name})):r.sources&&(n=(await Promise.all(r.sources.map(async e=>{if(e.type===u.aggregation){const t=await c.getAggregateBaseInfo(e.id);return t&&{id:t.id,type:u.aggregation,name:t.name}}else{const t=await c.getFormInfo(e.id);return C(t)?{id:t.id,type:u.entry,name:t.name,entryType:t.type}:null}}))).filter(e=>!!e)),n},a=n=>{let e=n;const t=f(r.type);return t.length&&(e=e.filter(p=>!p.entryType||t.includes(p.entryType))),r.filter&&(e=r.filter(e)),e},l=O();P([()=>r.sources,()=>r.appId],(n,e)=>{var t;$(n,e)||(t=l.value)==null||t.reload()});const o=B({get(){const n=f(r.modelValue).map(e=>e.id&&e.type?`${e.type}.${e.id}`:"").filter(e=>!!e);return r.multiple?n:n[0]},set(n){const e=f(n).map(t=>{const p=t.split(".");return{id:p.pop(),type:p.pop()}});_("update:modelValue",r.multiple?e:e[0])}});return(n,e)=>{const t=w;return d(),g(F,{modelValue:o.value,"onUpdate:modelValue":e[0]||(e[0]=p=>o.value=p),multiple:n.multiple,load:m,filterable:"",isCheckRemove:"",removeText:"选项已删除/不可选择",class:"select_entry",ref_key:"azSelectRef",ref:l},{default:I(({options:p})=>[(d(!0),S(V,null,b(a(p),y=>(d(),g(t,{key:y.id,label:y.name,value:`${y.type}.${y.id}`},null,8,["label","value"]))),128))]),_:1},8,["modelValue","multiple"])}}});const D=k(j,[["__scopeId","data-v-8031282c"]]);export{z as D,u as S,R as a,U as b,D as c};
