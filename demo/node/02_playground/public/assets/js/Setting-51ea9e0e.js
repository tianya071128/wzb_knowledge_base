import{d as ce,r as k,bX as ge,gY as ve,c as G,hO as d,a as v,a8 as be,o as n,f,i as a,w as t,B as i,b as s,aq as H,k as b,t as _,zp as D,j as ye,zq as _e,dA as M,eu as Ve,l as w,a2 as ke,m as y,F as V,g as z,a5 as Ce,L as Fe,bG as Ee,zr as we,H as $,zs as P,zt as ze,zu as Re,zv as Se,zw as N,zx as Y,Y as j,zy as Q,zz as he,ka as De,zA as Ue,av as xe,U as Te,c5 as $e,ab as Ne,q as qe,ac as Ae,ds as Be,ao as Oe,ap as Le,E as Ge,Q as He,bm as Me,bn as Pe,_ as Ye}from"./index-b80d5ef5.js";/* empty css                        */import{E as je,a as Qe,b as We}from"./el-dropdown-item-455a6589.js";import{_ as Xe}from"./FormFieldHeaderEditor.vue_vue_type_script_setup_true_lang-6c993e5c.js";import{_ as Je,a as Ke}from"./FieldOtherEditor.vue_vue_type_script_setup_true_lang-a2d4ed75.js";import{_ as Ze}from"./FieldWidthEditor.vue_vue_type_script_setup_true_lang-3f895778.js";import{E as U}from"./routePage-70460a50.js";import{E as Ie}from"./EditorDraggable-a06dbc71.js";import{A as W}from"./AzInputNumber-d6212644.js";import{_ as eo}from"./FieldLengthEditor.vue_vue_type_script_setup_true_lang-b711d652.js";import"./Base.vue_vue_type_script_setup_true_lang-832ddae3.js";import"./TableOperation.vue_vue_type_script_setup_true_lang-4afbb2cb.js";import"./keyBy-8fcfdd74.js";import"./_createAggregator-d66ed64c.js";import"./useQueryTab-05fa7456.js";import"./useExtractQuery-f96f705c.js";import"./CardTabs-ca59b5e9.js";import"./EditItemTargetForm.vue_vue_type_script_setup_true_lang-199df786.js";import"./SelectEntryAndOther-76a65b2d.js";import"./FieldCondition-1c72aa9d.js";import"./Base.vue_vue_type_script_setup_true_lang-03820366.js";import"./useFieldMaxWidth-d82f063e.js";import"./AddressBase.vue_vue_type_script_setup_true_lang-d809ffc6.js";import"./AzCascader.vue_vue_type_style_index_0_lang-adc6a4ab.js";import"./AzDatePicker.vue_vue_type_style_index_0_lang-c5632a92.js";import"./index-318b68f4.js";import"./AzTimePicker.vue_vue_type_style_index_0_lang-3726374e.js";import"./useMultipleVal-904406c1.js";import"./CascaderBase.vue_vue_type_style_index_0_lang-83862970.js";import"./CardShowFieldItem-fd24f218.js";import"./LoadingData-195d0581.js";import"./AutoJump.vue_vue_type_script_setup_true_lang-a3aa2601.js";import"./ComponentParamsSetWrapper-71afc840.js";import"./default-component-4c80201b.js";import"./ButtonState-cb54910b.js";import"./SelectFieldByMultEntry-84abd0c3.js";import"./fieldDefaultComponent-58752d9c.js";import"./Base.vue_vue_type_script_setup_true_lang-4fbdbc85.js";import"./DaterangeBase.vue_vue_type_script_setup_true_lang-bec97540.js";import"./InputBase.vue_vue_type_script_setup_true_lang-ffcf63f1.js";import"./Base-9b7f3306.js";/* empty css                          */import"./index-f0ed738f.js";import"./NumberBase.vue_vue_type_script_setup_true_lang-745b39c5.js";import"./Base-c9aa1df0.js";import"./SliderBase.vue_vue_type_script_setup_true_lang-5d73415b.js";import"./el-input-number-c15b1cc7.js";import"./TextareaBase.vue_vue_type_script_setup_true_lang-7091b2cb.js";import"./TimeBase.vue_vue_type_script_setup_true_lang-ea537bf3.js";import"./TimerangeBase.vue_vue_type_script_setup_true_lang-0827c241.js";import"./UploadFileBase.vue_vue_type_script_setup_true_lang-0c253daa.js";import"./UploadImgBase.vue_vue_type_script_setup_true_lang-d23c1306.js";import"./CooperateEnterpriseBase.vue_vue_type_script_setup_true_lang-23720971.js";import"./CooperatePersonnelBase.vue_vue_type_script_setup_true_lang-adcd0db7.js";import"./Base.vue_vue_type_script_setup_true_lang-0e9a0e2c.js";import"./Base.vue_vue_type_script_setup_true_lang-aa25657d.js";import"./SelectCascaderEntry.vue_vue_type_script_setup_true_lang-673c5dca.js";import"./SelectForm.vue_vue_type_script_setup_true_lang-0170236d.js";import"./ParamsSet.vue_vue_type_script_setup_true_lang-37c252c5.js";import"./MessageRemindConfig-98484405.js";import"./utils-a7200637.js";import"./messageTemplate-8658e6b4.js";import"./SetFieldDefault-5fc1ae2a.js";import"./ButtonSelectField.vue_vue_type_script_setup_true_lang-aae15f71.js";import"./FormulaWrapper-92a83208.js";import"./Formula.vue_vue_type_style_index_0_lang-ef444f24.js";import"./index-8e050109.js";import"./routePage.vue_vue_type_script_setup_true_lang-efb79c93.js";import"./CollageTable-791f0954.js";import"./index-617ab4b4.js";import"./ConditionWrapper-43da1676.js";import"./FieldConditionView-ad1b057c.js";import"./SetAuth-50c8e12e.js";import"./usePublicRelease-2335b254.js";import"./Qrcode-850531ac.js";import"./html2canvas.esm-0543ed55.js";import"./DesignerDialog-22d70853.js";import"./Designer.vue_vue_type_script_setup_true_lang-3c7dafd1.js";import"./form-success-1777d0da.js";import"./TableRender-bab4d661.js";import"./Resize-eb80395d.js";import"./FormShare-9773b44c.js";import"./dataShare-2d7ae3f7.js";import"./SelectDataSourece-70a968c3.js";import"./useTransformColor-38b5da33.js";import"./SetFieldAuth-3d0b80a0.js";import"./DesignerTabs-a9795edf.js";import"./Base-3571a39e.js";import"./AddFormDataBtnPlus-a775412e.js";import"./formDesigner-462b10d7.js";import"./useValidateError-9f6399dc.js";import"./AutoNumberBase.vue_vue_type_script_setup_true_lang-56f78b68.js";import"./PluginBase-56c4bf37.js";import"./RichTextBase-228f0924.js";import"./Base-11a86176.js";import"./UploadWrapper.vue_vue_type_script_setup_true_lang-4553cd48.js";import"./index-c89dfa90.js";import"./TemplateCustomEntry.vue_vue_type_script_setup_true_lang-346d01b1.js";import"./TextBase.vue_vue_type_script_setup_true_lang-09411e7a.js";import"./BtnDisplay.vue_vue_type_script_setup_true_lang-cbe1b7c6.js";import"./Base.vue_vue_type_script_setup_true_lang-392ceecd.js";import"./GridBase.vue_vue_type_script_setup_true_lang-f18077d3.js";import"./Base-16c93ea0.js";import"./TableBase-393fac1a.js";import"./TabsBase.vue_vue_type_style_index_0_lang-861f3fae.js";import"./DepartmentBase.vue_vue_type_script_setup_true_lang-6f309530.js";import"./MemberBase.vue_vue_type_script_setup_true_lang-77a28117.js";import"./AddOrEditValidate.vue_vue_type_style_index_0_lang-5bd5a73c.js";import"./DataSoureceWrapper-047a1c9d.js";import"./ComponentPostAction-12970ad1.js";import"./InternalComponentSelectPlus-00c8c38f.js";import"./app.vue_vue_type_script_setup_true_lang-59fd2507.js";import"./enum-7a2ae6a9.js";import"./index-20639231.js";import"./el-space-0d01b33a.js";import"./cloneDeep-dc1c677b.js";import"./isTypedArray-10beecc7.js";import"./el-collapse-transition-4ed993c7.js";import"./defaultValue-7c7c87ea.js";import"./typeof-7fd5df1e.js";import"./utils-052731c0.js";import"./designerRender.vue_vue_type_script_setup_true_lang-68b31d85.js";const oo=ce({__name:"Setting",props:{field:{}},setup(X){const c=X,q=k(null),{width:J}=ge(q),C=ve(),F=k(!1),r=k(),x=k(0),T=k(),K=G(()=>{var o,m;const l={[d.autoCounter]:"计数设置",[d.dateFormatSet]:"创建时间格式设置"};return(o=r.value)!=null&&o.type?l[(m=r.value)==null?void 0:m.type]:""}),A=(l,o)=>{var u;if(o!=null&&o.type&&[d.field,d.fixedChar].includes(o.type))return;const m=(u=c.field.options.numberRule)==null?void 0:u[l];m&&(r.value=j(m),F.value=!0,x.value=l,setTimeout(()=>{var g;(g=T.value)==null||g.clearValidate()},100))},Z=async()=>{var l,o;await((l=T.value)==null?void 0:l.validate()),(o=c.field.options.numberRule)!=null&&o[x.value]&&r.value&&(c.field.options.numberRule[x.value]=j(r.value)),F.value=!1},I=()=>{var l;if(((l=r.value)==null?void 0:l.type)===d.dateFormatSet){const o=r.value;o.config.formatType===N.preset&&!Y.some(m=>m.value===o.config.format)&&(r.value.config.format=Q)}},ee=l=>{const[o,m,u]=l.split(".");switch(o){case d.fixedChar:c.field.options.numberRule.push({type:d.fixedChar,config:""});break;case d.dateFormatSet:c.field.options.numberRule.push({type:d.dateFormatSet,config:{format:Q,formatType:N.preset}});break;case d.field:c.field.options.numberRule.push({type:d.field,config:{fieldId:m,fieldType:u}});break}},oe=[v.input,v.textarea,v.number,v.radio,v.multiple,v.date,v.time,v.address],le=G(()=>be(C.getFieldsByFieldId({fieldId:c.field.fieldId,excludeCrrentField:!0}),{excludeFilter(o,m,u){var g;return!oe.includes(o.type)||((g=u==null?void 0:u.parentField)==null?void 0:g.type)===v.subform}})),R=k(null),te=async()=>{const l=await he({entryId:C.entryId,fieldId:c.field.fieldId});R.value=De(l)?Number(l):null},ae=async()=>{await Ue({entryId:C.entryId,fieldId:c.field.fieldId}),R.value=null};return(l,o)=>{const m=xe,u=Te,g=je,ie=Qe,re=We,ne=$e,B=Ne,de=qe,S=Ae,pe=Be,O=Oe,L=Le,se=Ge,me=He,ue=Me,fe=Pe;return n(),f(V,null,[a(Xe,{modelValue:l.field.options,"onUpdate:modelValue":o[0]||(o[0]=e=>l.field.options=e),id:l.field.fieldId},null,8,["modelValue","id"]),a(U,{label:"编号规则"},{default:t(()=>[a(Ie,{modelValue:l.field.options.numberRule,"onUpdate:modelValue":o[1]||(o[1]=e=>l.field.options.numberRule=e),deleteDisabledCallback:(e,p)=>(p==null?void 0:p.type)===i(d).autoCounter},{default:t(({element:e,index:p})=>{var h;return[(e==null?void 0:e.type)!==i(d).fixedChar?(n(),s(U,{key:0,id:`${l.field.fieldId}.numberRule.${(h=e==null?void 0:e.config)==null?void 0:h.fieldId}`},{default:t(()=>[a(H,{class:"az-input-prefix",readonly:""},{prefix:t(()=>{var E;return[b("div",{class:"number-rule-item",onClick:lo=>A(p,e)},[b("span",{class:"color1"},_(i(D)(e==null?void 0:e.type)),1),b("div",{class:"rule-describe"},[(e==null?void 0:e.type)!==i(d).field?(n(),s(ye,{key:0,content:i(_e)(e),style:{width:"100%","vertical-align":"middle"}},null,8,["content"])):(n(),s(M,{key:1,class:"color-text",includeSubFormLabel:"",fieldId:(E=e==null?void 0:e.config)==null?void 0:E.fieldId,fields:i(C).form.fields},null,8,["fieldId","fields"]))]),(e==null?void 0:e.type)!==i(d).field?(n(),s(m,{key:0,type:"primary",class:"number-rule-setting",icon:i(Ve),underline:!1},null,8,["icon"])):w("",!0)],8,["onClick"])]}),_:2},1024)]),_:2},1032,["id"])):(n(),s(H,{key:1,modelValue:e.config,"onUpdate:modelValue":E=>e.config=E,placeholder:"请输入内容"},{prefix:t(()=>[b("div",{class:"number-rule-item",onClick:E=>A(p,e)},[b("span",{class:"color1"},_(i(D)(e==null?void 0:e.type)),1)],8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue"]))]}),_:1},8,["modelValue","deleteDisabledCallback"]),b("div",{class:"w100 mt-5",style:{"line-height":"initial"},ref_key:"buttonEl",ref:q},[a(re,{class:"w100",trigger:"click",onCommand:ee,"max-height":"30vh",placement:"bottom-start"},{dropdown:t(()=>[a(ie,{style:ke({width:`${i(J)}px`})},{default:t(()=>{var e;return[(e=l.field.options.numberRule)!=null&&e.some(p=>p.type===i(d).dateFormatSet)?w("",!0):(n(),s(g,{key:0,command:i(d).dateFormatSet},{default:t(()=>[y(_(i(D)(i(d).dateFormatSet)),1)]),_:1},8,["command"])),a(g,{command:i(d).fixedChar},{default:t(()=>[y(_(i(D)(i(d).fixedChar)),1)]),_:1},8,["command"]),(n(!0),f(V,null,z(le.value,(p,h)=>(n(),s(g,{key:p.fieldId,command:`${i(d).field}.${p.fieldId}.${p.type}`,divided:h===0},{default:t(()=>[a(M,{includeSubFormLabel:"",fieldId:p.fieldId,fields:i(C).form.fields},null,8,["fieldId","fields"])]),_:2},1032,["command","divided"]))),128))]}),_:1},8,["style"])]),default:t(()=>[a(u,{class:"w100",plain:"",icon:i(Ce)},{default:t(()=>[y("添加规则")]),_:1},8,["icon"])]),_:1})],512)]),_:1}),a(U,{label:"编号重置"},{default:t(()=>[a(Fe,{class:"w100",load:te},{default:t(()=>[R.value==null?(n(),f("span",{key:0},"暂未开始计数")):(n(),f("span",{key:1,class:"reset-number"},[b("span",null,"已计数到"+_(R.value),1),a(Ee,{title:"重置编号后将重新开始计算，此操作无法还原，是否确定重置?",confirm:ae},{reference:t(()=>[a(m,{underline:!1,type:"primary",class:"ml-5"},{default:t(()=>[y(" 重置 ")]),_:1})]),_:1})]))]),_:1})]),_:1}),a(U,{label:"生成编号的时机"},{default:t(()=>[a(B,{modelValue:l.field.options.trigger,"onUpdate:modelValue":o[2]||(o[2]=e=>l.field.options.trigger=e)},{default:t(()=>[(n(!0),f(V,null,z(i(we),e=>(n(),s(ne,{key:e.value,label:e.value},{default:t(()=>[y(_(e.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"]),a(de,{modelValue:l.field.options.isComplete,"onUpdate:modelValue":o[3]||(o[3]=e=>l.field.options.isComplete=e)},{default:t(()=>[y(" 编辑时补全为空的编号 ")]),_:1},8,["modelValue"])]),_:1}),a(Je,{modelValue:l.field.options,"onUpdate:modelValue":o[4]||(o[4]=e=>l.field.options=e),id:l.field.fieldId,"hide-edit":""},null,8,["modelValue","id"]),a(Ze,{field:l.field,modelValue:l.field.options,"onUpdate:modelValue":o[5]||(o[5]=e=>l.field.options=e)},null,8,["field","modelValue"]),a(eo,{field:l.field},null,8,["field"]),a(Ke,{field:l.field},null,8,["field"]),a(fe,{modelValue:F.value,"onUpdate:modelValue":o[14]||(o[14]=e=>F.value=e),title:K.value,width:"600","destroy-on-close":"","close-on-click-modal":!1,"append-to-body":""},{footer:t(()=>[b("span",{class:"dialog-footer"},[a(u,{onClick:o[13]||(o[13]=e=>F.value=!1)},{default:t(()=>[y("取消")]),_:1}),a(u,{type:"primary",onClick:Z},{default:t(()=>[y("确定")]),_:1})])]),default:t(()=>[r.value?(n(),s(ue,{key:0,model:r.value,ref_key:"ruleFormRef",ref:T,"label-position":"top"},{default:t(()=>[r.value.type===i(d).autoCounter?(n(),f(V,{key:0},[a(S,{label:"计数位数",prop:"config.countDigit",rules:[{required:!0,trigger:"change",message:"必填项"}]},{default:t(()=>[a(W,{modelValue:r.value.config.countDigit,"onUpdate:modelValue":o[6]||(o[6]=e=>r.value.config.countDigit=e),style:{width:"150px"},min:2,max:12,align:"center",valueOnClear:5},null,8,["modelValue"])]),_:1}),a($,{label:"位数固定",prop:"config.isDigitFix",tip:"根据计数位数显示计数值",rules:[{required:!0,trigger:"change",message:"必填项"}]},{default:t(()=>[a(pe,{modelValue:r.value.config.isDigitFix,"onUpdate:modelValue":o[7]||(o[7]=e=>r.value.config.isDigitFix=e),"inactive-text":"关","active-text":"开","inline-prompt":"","inactive-value":i(P).no,"active-value":i(P).yes},null,8,["modelValue","inactive-value","active-value"])]),_:1}),a($,{label:"重置周期",prop:"config.resetInterval",rules:[{required:!0,trigger:"change",message:"必填项"}]},{default:t(()=>[a(L,{modelValue:r.value.config.resetInterval,"onUpdate:modelValue":o[8]||(o[8]=e=>r.value.config.resetInterval=e),placeholder:"请选择"},{default:t(()=>[(n(!0),f(V,null,z(i(ze),(e,p)=>(n(),s(O,{key:p,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),b("span",{class:"reset-tip"},_(i(Re)(r.value.config.resetInterval)),1)]),_:1}),a(S,{label:"初始值",rules:[{required:!0,trigger:"change",message:"必填项"}]},{default:t(()=>[a(W,{modelValue:r.value.config.initValue,"onUpdate:modelValue":o[9]||(o[9]=e=>r.value.config.initValue=e),style:{width:"150px"},min:0,max:99999999999,align:"center",valueOnClear:"min"},null,8,["modelValue"])]),_:1})],64)):w("",!0),r.value.type===i(d).dateFormatSet?(n(),f(V,{key:1},[a(S,{label:"时间格式",prop:"config.formatType",rules:[{required:!0,trigger:"change",message:"必填项"}]},{default:t(()=>[a(B,{modelValue:r.value.config.formatType,"onUpdate:modelValue":o[10]||(o[10]=e=>r.value.config.formatType=e),onChange:I},{default:t(()=>[(n(!0),f(V,null,z(i(Se),e=>(n(),s(se,{key:e.value,label:e.value},{default:t(()=>[y(_(e.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),r.value.config.formatType===i(N).preset?(n(),s(S,{key:0,label:"预定义格式",prop:"config.format",rules:[{required:!0,trigger:"change",message:"必填项"}]},{default:t(()=>[a(L,{modelValue:r.value.config.format,"onUpdate:modelValue":o[11]||(o[11]=e=>r.value.config.format=e),placeholder:"请选择"},{default:t(()=>[(n(!0),f(V,null,z(i(Y),(e,p)=>(n(),s(O,{key:p,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):(n(),s($,{key:1,label:"自定义格式",prop:"config.format",rules:[{required:!0,trigger:"change",message:"必填项"}],tip:"y 表示 年<br />M 表示 月<br />d 表示 日<br />H 表示 时<br />m 表示 分<br />s 表示 秒"},{default:t(()=>[a(me,{modelValue:r.value.config.format,"onUpdate:modelValue":o[12]||(o[12]=e=>r.value.config.format=e),placeholder:"请输入"},null,8,["modelValue"])]),_:1}))],64)):w("",!0)]),_:1},8,["model"])):w("",!0)]),_:1},8,["modelValue","title"])],64)}}});const yt=Ye(oo,[["__scopeId","data-v-9d0dd3ad"]]);export{yt as default};
