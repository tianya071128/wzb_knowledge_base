import{b4 as Q,cb as A,d as N,r as b,c as B,o as d,b as I,w as a,k as c,i as o,j as G,t as T,bh as H,B as e,C as F,cc as K,as as W,bs as X,cd as j,aN as Y,bC as q,_ as U,ce as C,bp as Z,v as ee,bu as te,f as w,F as P,g as R,bc as ae,m as D,Q as le,ac as se,E as ne,bm as oe,bn as re,cf as ie,bi as ue,l as z,N as pe,O as de,U as ce}from"./index-b80d5ef5.js";import{u as me}from"./useExtractQuery-f96f705c.js";import{e as _e,s as ve,d as fe,c as ge,a as ye}from"./eventFlow-dbdb0b7c.js";import{E as be}from"./el-space-0d01b33a.js";const L=()=>({jumpToDesign:async r=>{Q(A,{query:{chainId:r.chainId,appId:r.appId}})}}),Ee=N({__name:"EventCard",props:{item:{},appId:{}},emits:["refresh"],setup(g,{emit:r}){const i=g,y=r,_=b(i.item.status),{jumpToDesign:v}=L(),u=B(()=>[{id:"edit",text:"编辑",type:"primary",onClick:async()=>{await v({chainId:i.item.chainId,appId:i.appId})}},{id:"delete",text:"删除",type:"danger",popconfirmProps:{title:"确定要删除该智绘流吗？",confirm:async()=>{await fe(i.item.chainId),Y.success("删除成功"),y("refresh")}}}]);return(t,f)=>{const E=q;return d(),I(E,{class:"mb-10",shadow:"hover"},{header:a(()=>[c("div",{class:"card-header"},[o(G,null,{default:a(()=>{var l;return[c("b",null,T(((l=t.item)==null?void 0:l.name)??"-"),1)]}),_:1}),c("div",{class:"operation_wrapper"},[o(H,{style:{"margin-left":"24px"},modelValue:e(_),"onUpdate:modelValue":f[0]||(f[0]=l=>F(_)?_.value=l:null),updateFetch:async()=>{e(_)==e(K)?await e(_e)(t.item.chainId):await e(ve)(t.item.chainId)}},null,8,["modelValue","updateFetch"]),o(W,{list:e(u),num:4},null,8,["list"])])])]),default:a(()=>{var l;return[c("div",{class:"event-content"},[c("span",null," 触发事件："+T(e(X)(t.item.triggerType,e(j))),1),c("span",null,"更新时间："+T(((l=t.item)==null?void 0:l.updateTime)??"-"),1)])]}),_:1})}}});const Ie=U(Ee,[["__scopeId","data-v-1b48daf6"]]),M=()=>{const g=[C.form,C.time];return{tabPanes:B(()=>Z(j).filter(i=>g.includes(i.value)))}},we=N({__name:"CreateEventFlow",props:{visible:{type:Boolean},appId:{}},emits:["update:visible","refresh"],setup(g,{emit:r}){const i=g,y=r,{jumpToDesign:_}=L(),{tabPanes:v}=M(),u=b({name:"",triggerType:C.form}),t=ee(i,"visible",y),f=b(),E=async()=>{var n;await((n=f.value)==null?void 0:n.validate());const m=await ge({appId:i.appId,triggerType:u.value.triggerType,name:u.value.name});await _({chainId:m,appId:i.appId}),y("refresh")},l=()=>{var m;(m=f.value)==null||m.resetFields()};return(m,n)=>{const k=le,h=se,x=ne,s=q,V=be,S=oe,J=re;return d(),I(J,{onClosed:l,modelValue:e(t),"onUpdate:modelValue":n[3]||(n[3]=p=>F(t)?t.value=p:null),title:"新建智绘流",width:"500"},{footer:a(()=>[o(te,{"edit-mode":"",onClose:n[2]||(n[2]=p=>t.value=!1),"on-submit":E})]),default:a(()=>[o(S,{ref_key:"ruleFormRef",ref:f,model:u.value,"label-position":"top","label-suffix":"："},{default:a(()=>[o(h,{label:"智绘流名称",prop:"name",rules:[{required:!0,message:"请输入名称",trigger:"blur"},{min:2,max:15,message:"名称长度为2至15字符",trigger:"blur"}]},{default:a(()=>[o(k,{modelValue:u.value.name,"onUpdate:modelValue":n[0]||(n[0]=p=>u.value.name=p),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),o(h,{required:"",label:"请选择触发类型",prop:"triggerType"},{default:a(()=>[o(V,{fill:"",direction:"vertical",style:{width:"100%"}},{default:a(()=>[(d(!0),w(P,null,R(e(v),(p,O)=>(d(),I(s,{key:p.value+O,shadow:"hover","body-style":{padding:"10px",cursor:"pointer"},style:{width:"100%"},onClick:ae($=>u.value.triggerType=p.value,["stop"])},{default:a(()=>[c("div",{class:"triggerType_card"},[c("div",{class:"triggerType_card_info"},[c("div",{class:"title"},T(p.label),1),c("div",{class:"tip Gray_75"},T(p.tip),1)]),o(x,{modelValue:u.value.triggerType,"onUpdate:modelValue":n[1]||(n[1]=$=>u.value.triggerType=$),label:Number(p.value),value:Number(p.value)},{default:a(()=>[D("   ")]),_:2},1032,["modelValue","label","value"])])]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}});const Te=U(we,[["__scopeId","data-v-91e38595"]]),he=N({__name:"routePage",setup(g){const r=me("appId"),{tabPanes:i}=M(),y=b(),_=b(),v=b(!1),u=async()=>{v.value=!0},t=b(C.form),f=B(()=>({query:{list:[{label:"名称",prop:"name",type:"input"},{type:"select",label:"状态",prop:"status",options:ie,extraOptions:[{label:"全部",value:""}]}]},request:{api:ye,extraParams:{appId:r.value,triggerType:t.value}},operation:{hideField:!0,fullEl:_}}));function E(){var l;(l=y.value)==null||l.refresh()}return(l,m)=>{const n=pe,k=de,h=ce,x=ue("az-page");return d(),w("div",{ref_key:"pendingRef",ref:_,class:"layout_box"},[c("div",{style:{position:"relative"}},[o(k,{modelValue:e(t),"onUpdate:modelValue":m[0]||(m[0]=s=>F(t)?t.value=s:null),style:{flex:"1"}},{default:a(()=>[(d(!0),w(P,null,R(e(i),s=>(d(),I(n,{key:s.value,label:s.label,name:s.value},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),o(h,{style:{position:"absolute",right:"0",top:"0"},onClick:u,type:"primary"},{default:a(()=>[D(" 新建智绘流 ")]),_:1})]),o(x,{config:e(f),ref_key:"azPageRef",ref:y,class:"az-page_custom"},{operation:a(()=>[]),table:a(({tableData:s})=>[s!=null&&s.length?(d(),w("div",{key:0,class:"card-list"},[(d(!0),w(P,null,R(s,V=>(d(),I(Ie,{key:V.id,item:V,onRefresh:E,appId:e(r)??""},null,8,["item","appId"]))),128))])):z("",!0)]),_:1},8,["config"]),e(r)?(d(),I(Te,{key:0,visible:e(v),"onUpdate:visible":m[1]||(m[1]=s=>F(v)?v.value=s:null),"app-id":e(r),onRefresh:E},null,8,["visible","app-id"])):z("",!0)],512)}}});const xe=U(he,[["__scopeId","data-v-2df0b927"]]);export{xe as default};
