import{d8 as d,d as M,r as w,v as U,bK as C,c as A,o as E,b as T,w as u,i as r,bu as F,bt as B,f as $,F as z,g as Y,B as I,C as R,bv as k,aN as x,Q as K,ac as W,ao as O,bm as Q,m as y,t as D,bs as H,bT as Z,bU as j,bi as G,iC as J,e as X,l as ee,rW as ae,cc as te,U as le}from"./index-b80d5ef5.js";import{_ as re}from"./TableOperation.vue_vue_type_script_setup_true_lang-4afbb2cb.js";import{A as oe}from"./AzConfirmSwitch-689fcef9.js";const ue=o=>d.value.request.post(`${d.value.SYSTEMURL}/param/listPage`,o),se=o=>d.value.request.post(`${d.value.SYSTEMURL}/param/add`,o),de=o=>d.value.request.post(`${d.value.SYSTEMURL}/param/edit`,o),ne=o=>d.value.request.post(`${d.value.SYSTEMURL}/param/delete/${o}`),q=o=>d.value.request.get(`${d.value.SYSTEMURL}/param/queryById/${o}`),ie=o=>d.value.request.post(`${d.value.SYSTEMURL}/param/reset/${o}`),me=o=>d.value.request.post(`${d.value.SYSTEMURL}/param/enable/${o}`),pe=o=>d.value.request.post(`${d.value.SYSTEMURL}/param/disable/${o}`),ce=M({__name:"AddAndEdit",props:{drawerModel:{type:Boolean},comState:{},paramId:{}},emits:["update:drawerModel","refresh"],setup(o,{emit:i}){const _=w(),b=i,c=o,m=U(c,"drawerModel",b),g=C({parameterName:[{required:!0,message:"请输入参数名称",trigger:"blur"}],parameterType:[{required:!0,message:"请选择参数类别",trigger:"change"}],keyword:[{required:!0,validator:(v,t,f)=>{t===""?f(new Error("请输入参数关键字")):t.match(/^[A-Za-z]+$/)?f():f(new Error("仅支持英文字符"))},trigger:"blur"}],defaultValue:[{required:!0,message:"请输入默认值",trigger:"blur"}],value:[{required:!0,message:"请输入参数值",trigger:"blur"}],valueDescribe:[{required:!0,message:"请输入参数描述",trigger:"blur"}]}),p={parameterName:"",keyword:"",defaultValue:"",status:0,value:"",valueDescribe:""},l=w({...p}),e=v=>c.comState===v,a=A(()=>e("add")?"新增参数":e("edit")?"编辑参数":""),S=async v=>{var t;await((t=_.value)==null?void 0:t.validate()),e("edit")?(await de(l.value),x.success("修改参数成功")):(await se(l.value),x.success("新增参数成功")),v==="submitContinue"&&(l.value={...p}),b("refresh")},h=async()=>{e("edit")&&(l.value=await q(c.paramId))};return(v,t)=>{const f=K,V=W,L=O,N=Q;return E(),T(k,{modelValue:I(m),"onUpdate:modelValue":t[7]||(t[7]=s=>R(m)?m.value=s:null),title:a.value,"show-load":h},{footer:u(()=>[r(F,{editMode:e("edit"),onClose:t[6]||(t[6]=s=>m.value=!1),"on-submit":S},null,8,["editMode"])]),default:u(()=>[r(N,{ref_key:"ruleFormRef",ref:_,rules:g,model:l.value,"label-width":"100px","label-suffix":":"},{default:u(()=>[r(V,{label:"参数名称",prop:"parameterName"},{default:u(()=>[r(f,{modelValue:l.value.parameterName,"onUpdate:modelValue":t[0]||(t[0]=s=>l.value.parameterName=s),placeholder:"请输入参数名称",maxlength:"20","show-word-limit":""},null,8,["modelValue"])]),_:1}),r(V,{label:"参数类别",prop:"parameterType"},{default:u(()=>[r(B,{modelValue:l.value.parameterType,"onUpdate:modelValue":t[1]||(t[1]=s=>l.value.parameterType=s),clearable:"",load:"param_type",style:{width:"100%"}},{default:u(({options:s})=>[(E(!0),$(z,null,Y(s,P=>(E(),T(L,{key:P.value,label:P.label,value:P.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(V,{label:"参数关键字",prop:"keyword"},{default:u(()=>[r(f,{modelValue:l.value.keyword,"onUpdate:modelValue":t[2]||(t[2]=s=>l.value.keyword=s),placeholder:"请输入参数关键字",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1}),r(V,{label:"默认值",prop:"defaultValue"},{default:u(()=>[r(f,{modelValue:l.value.defaultValue,"onUpdate:modelValue":t[3]||(t[3]=s=>l.value.defaultValue=s),placeholder:"请输入默认值",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1}),r(V,{label:"参数值",prop:"value"},{default:u(()=>[r(f,{modelValue:l.value.value,"onUpdate:modelValue":t[4]||(t[4]=s=>l.value.value=s),placeholder:"请输入参数值",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1}),r(V,{label:"参数描述",prop:"valueDescribe"},{default:u(()=>[r(f,{type:"textarea",modelValue:l.value.valueDescribe,"onUpdate:modelValue":t[5]||(t[5]=s=>l.value.valueDescribe=s),placeholder:"请输入参数描述",maxlength:"254","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"])}}}),ve=M({__name:"ParamDetail",props:{paramId:{},drawerModel:{type:Boolean}},emits:["update:drawerModel"],setup(o,{emit:i}){const _=o,c=U(_,"drawerModel",i),m=async()=>{n.value=await q(_.paramId)},n=w();return(g,p)=>{const l=Z,e=j;return E(),T(k,{modelValue:I(c),"onUpdate:modelValue":p[0]||(p[0]=a=>R(c)?c.value=a:null),title:"查看参数","show-load":m},{default:u(()=>[r(e,{class:"user_center-desciptions",border:!0,column:2},{default:u(()=>[r(l,{label:"参数名称"},{default:u(()=>{var a;return[y(D(((a=n.value)==null?void 0:a.parameterName)||"-"),1)]}),_:1}),r(l,{label:"参数类别"},{default:u(()=>{var a;return[y(D(I(H)((a=n.value)==null?void 0:a.parameterType,"param_type")),1)]}),_:1}),r(l,{label:"参数关键字"},{default:u(()=>{var a;return[y(D(((a=n.value)==null?void 0:a.keyword)||"-"),1)]}),_:1}),r(l,{label:"默认值"},{default:u(()=>{var a;return[y(D(((a=n.value)==null?void 0:a.defaultValue)||"-"),1)]}),_:1}),r(l,{label:"参数值"},{default:u(()=>{var a;return[y(D(((a=n.value)==null?void 0:a.value)||"-"),1)]}),_:1}),r(l,{label:"说明",span:2},{default:u(()=>{var a;return[y(D(((a=n.value)==null?void 0:a.valueDescribe)||"-"),1)]}),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),fe={name:"ParamInfo"},ye=M({...fe,setup(o){let i=function(e){return e.P_ADD="system:paraminfo:add",e.P_RESET="system:paraminfo:reset",e.P_VIEW="system:paraminfo:add",e.P_EDIT="system:paraminfo:edit",e.P_DELETE="system:paraminfo:delete",e.P_ENABLE="system:paraminfo:enable",e}({});const _=w(),b=async()=>{var e;await((e=_.value)==null?void 0:e.refresh())},c={query:{list:[{type:"input",label:"参数名称",prop:"parameterName"},{type:"input",label:"参数关键字",prop:"keyword"}]},request:{api:ue},table:{tableCols:[{prop:"parameterName",label:"参数名称"},{prop:"parameterType_dictText",label:"参数类别"},{prop:"keyword",label:"参数关键字"},{prop:"value",label:"参数值",width:100},{prop:"defaultValue",label:"默认值",width:100},{prop:"valueDescribe",label:"参数描述",showOverflowTooltip:!0},{prop:"tenantName",label:"租户名称",width:150},{prop:"status",label:"状态",width:100,slots:{default({row:e}){return r(oe,{disabled:!ae(i.P_ENABLE),tip:"禁用后参数将不可用。确定要禁用？",modelValue:e.status,updateFetch:async()=>{e.status===te?await pe(e.id):await me(e.id),b()}},null)}}},{fixed:"right",width:180,label:"操作",slots:{default({row:e}){const a=async()=>{await ne(e.id),x.success("删除成功"),await b()},S=()=>{l("edit",e.id)},h=()=>{p.value=e.id,g.value="view",m.value=!0},v=async()=>{await ie(e.id),x.success("重置成功"),await b()},t=[{type:"primary",premission:i.P_EDIT,onClick:S,text:"编辑"},{type:"primary",premission:i.P_RESET,text:"重置",popconfirmProps:{title:"重置后恢复到初始默认值，确认重置?",confirm:v}},{type:"primary",premission:i.P_VIEW,onClick:h,text:"查看"},{type:"danger",text:"删除",premission:i.P_DELETE,popconfirmProps:{title:"删除后，参数将不可恢复，确认删除?",confirm:a}}];return r(re,{num:3,rowId:e.id,list:t},null)}}}]}},m=w(!1),n=w(!1),g=w("add"),p=w(""),l=(e,a="")=>{p.value=a,g.value=e,n.value=!0};return(e,a)=>{const S=le,h=G("az-page"),v=J("premission");return E(),$("div",null,[r(h,{class:"layout_box",ref_key:"azPageRef",ref:_,config:c,maxHeight:"var(--az-layout-main-height) - 40px"},{operation:u(()=>[X((E(),T(S,{type:"primary",onClick:a[0]||(a[0]=t=>l("add"))},{default:u(()=>[y(" 新增参数 ")]),_:1})),[[v,i.P_ADD]])]),_:1},512),n.value?(E(),T(ce,{key:0,"drawer-model":n.value,"onUpdate:drawerModel":a[1]||(a[1]=t=>n.value=t),onRefresh:b,"com-state":g.value,paramId:p.value},null,8,["drawer-model","com-state","paramId"])):ee("",!0),r(ve,{"drawer-model":m.value,"onUpdate:drawerModel":a[2]||(a[2]=t=>m.value=t),paramId:p.value},null,8,["drawer-model","paramId"])])}}});export{ye as default};
