import{iO as ra,kg as Ge,po as ua,pp as ia,iU as we,j3 as Ue,iS as $e,iR as Ye,pq as da,d as Q,pc as pa,gf as ca,i_ as ma,iW as va,r,kC as fa,c as E,d5 as ya,pr as ga,bx as ba,o as I,b as S,w as i,k as z,p as Ie,B as e,a2 as Se,i as l,di as _a,f as $,h as de,P as Ia,aR as wa,F as te,g as se,m as B,t as Y,Q as fe,I as Je,aS as pe,bc as ve,ad as Xe,aU as Ze,j1 as ha,kl as Ne,j2 as ka,j5 as Va,er as ea,v as ne,lm as je,h1 as Ca,l as H,j as He,ex as Ta,ew as xa,na as Pa,q as Fe,by as Da,br as La,bC as Ma,c3 as aa,ps as j,dN as ue,gT as Aa,U as me,aW as Ra,aV as Ea,ik as Ua,R as Na,y as ce,C as W,dG as $a,pt as Sa,pu as Oa,et as Fa,dO as Ba,av as qa,_ as oe,pv as za,pw as Ve,px as Ce,bi as ye,py as Te,pz as Ga,cv as ja,cx as Ha,aN as ge,aa as Ke,pA as Ka,pB as Wa,pC as Qa,pD as Ya,L as Ja,pE as Xa,aT as Za,b4 as et,bd as at,pF as tt,bH as lt,pG as nt,ib as st,bv as ot,bu as ta,dl as he,is as ke,pH as rt,eh as la,ac as Be,bm as qe,bn as na,bt as Oe,pI as ut,pJ as it,ao as sa,dj as We,J as dt,fs as pt,bw as ct,dq as mt,pK as vt,id as ft,pL as yt,pM as gt,cV as bt,N as _t}from"./index-b80d5ef5.js";/* empty css                          */import{E as It}from"./el-space-0d01b33a.js";import{u as Qe}from"./useExtractQuery-f96f705c.js";import{a as wt}from"./LoadingData-195d0581.js";import{C as ht}from"./ConditionWrapper-43da1676.js";import{u as kt}from"./store-3b56af45.js";import{G as Vt}from"./GridItem-674e6ecc.js";import{T as Ct}from"./Tabs-69fb071c.js";import{u as Tt}from"./useFlowForm-df7c1aa0.js";const xt=ra({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:Ge(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:Ge([Function,Array]),default:ua},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},label:{type:String},teleported:ia.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:String}),Pt={[we]:c=>Ue(c),[$e]:c=>Ue(c),[Ye]:c=>Ue(c),focus:c=>c instanceof FocusEvent,blur:c=>c instanceof FocusEvent,clear:()=>!0,select:c=>da(c)},Dt=["aria-expanded","aria-owns"],Lt={key:0},Mt=["id","aria-selected","onClick"],oa="ElAutocomplete",At=Q({name:oa,inheritAttrs:!1}),Rt=Q({...At,props:xt,emits:Pt,setup(c,{expose:D,emit:d}){const m=c,n=pa(),x=ca(),P=ma(),v=va("autocomplete"),y=r(),f=r(),w=r(),A=r();let b=!1,R=!1;const u=r([]),o=r(-1),s=r(""),a=r(!1),t=r(!1),g=r(!1),_=fa(),M=E(()=>x.style),V=E(()=>(u.value.length>0||g.value)&&a.value),U=E(()=>!m.hideLoading&&g.value),p=E(()=>y.value?Array.from(y.value.$el.querySelectorAll("input")):[]),h=()=>{V.value&&(s.value=`${y.value.$el.offsetWidth}px`)},C=()=>{o.value=-1},T=ya(async k=>{if(t.value)return;const q=Z=>{g.value=!1,!t.value&&(Ne(Z)?(u.value=Z,o.value=m.highlightFirstItem?0:-1):ka(oa,"autocomplete suggestions must be an array"))};if(g.value=!0,Ne(m.fetchSuggestions))q(m.fetchSuggestions);else{const Z=await m.fetchSuggestions(k,q);Ne(Z)&&q(Z)}},m.debounce),O=k=>{const q=!!k;if(d($e,k),d(we,k),t.value=!1,a.value||(a.value=q),!m.triggerOnFocus&&!k){t.value=!0,u.value=[];return}T(k)},N=k=>{var q;P.value||(((q=k.target)==null?void 0:q.tagName)!=="INPUT"||p.value.includes(document.activeElement))&&(a.value=!0)},K=k=>{d(Ye,k)},F=k=>{R?R=!1:(a.value=!0,d("focus",k),m.triggerOnFocus&&!b&&T(String(m.modelValue)))},ee=k=>{setTimeout(()=>{var q;if((q=w.value)!=null&&q.isFocusInsideContent()){R=!0;return}a.value&&J(),d("blur",k)})},le=()=>{a.value=!1,d(we,""),d("clear")},ae=async()=>{V.value&&o.value>=0&&o.value<u.value.length?Me(u.value[o.value]):m.selectWhenUnmatched&&(d("select",{value:m.modelValue}),u.value=[],o.value=-1)},G=k=>{V.value&&(k.preventDefault(),k.stopPropagation(),J())},J=()=>{a.value=!1},re=()=>{var k;(k=y.value)==null||k.focus()},Le=()=>{var k;(k=y.value)==null||k.blur()},Me=async k=>{d($e,k[m.valueKey]),d(we,k[m.valueKey]),d("select",k),u.value=[],o.value=-1},Ae=k=>{if(!V.value||g.value)return;if(k<0){o.value=-1;return}k>=u.value.length&&(k=u.value.length-1);const q=f.value.querySelector(`.${v.be("suggestion","wrap")}`),ie=q.querySelectorAll(`.${v.be("suggestion","list")} li`)[k],Re=q.scrollTop,{offsetTop:ze,scrollHeight:Ee}=ie;ze+Ee>Re+q.clientHeight&&(q.scrollTop+=Ee),ze<Re&&(q.scrollTop-=Ee),o.value=k,y.value.ref.setAttribute("aria-activedescendant",`${_.value}-item-${o.value}`)};return ga(A,()=>{V.value&&J()}),ba(()=>{y.value.ref.setAttribute("role","textbox"),y.value.ref.setAttribute("aria-autocomplete","list"),y.value.ref.setAttribute("aria-controls","id"),y.value.ref.setAttribute("aria-activedescendant",`${_.value}-item-${o.value}`),b=y.value.ref.hasAttribute("readonly")}),D({highlightedIndex:o,activated:a,loading:g,inputRef:y,popperRef:w,suggestions:u,handleSelect:Me,handleKeyEnter:ae,focus:re,blur:Le,close:J,highlight:Ae}),(k,q)=>(I(),S(e(Ze),{ref_key:"popperRef",ref:w,visible:e(V),placement:k.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[e(v).e("popper"),k.popperClass],teleported:k.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${e(v).namespace.value}-zoom-in-top`,persistent:"",role:"listbox",onBeforeShow:h,onHide:C},{content:i(()=>[z("div",{ref_key:"regionRef",ref:f,class:Ie([e(v).b("suggestion"),e(v).is("loading",e(U))]),style:Se({[k.fitInputWidth?"width":"minWidth"]:s.value,outline:"none"}),role:"region"},[l(e(_a),{id:e(_),tag:"ul","wrap-class":e(v).be("suggestion","wrap"),"view-class":e(v).be("suggestion","list"),role:"listbox"},{default:i(()=>[e(U)?(I(),$("li",Lt,[de(k.$slots,"loading",{},()=>[l(e(Ia),{class:Ie(e(v).is("loading"))},{default:i(()=>[l(e(wa))]),_:1},8,["class"])])])):(I(!0),$(te,{key:1},se(u.value,(Z,ie)=>(I(),$("li",{id:`${e(_)}-item-${ie}`,key:ie,class:Ie({highlighted:o.value===ie}),role:"option","aria-selected":o.value===ie,onClick:Re=>Me(Z)},[de(k.$slots,"default",{item:Z},()=>[B(Y(Z[k.valueKey]),1)])],10,Mt))),128))]),_:3},8,["id","wrap-class","view-class"])],6)]),default:i(()=>[z("div",{ref_key:"listboxRef",ref:A,class:Ie([e(v).b(),k.$attrs.class]),style:Se(e(M)),role:"combobox","aria-haspopup":"listbox","aria-expanded":e(V),"aria-owns":e(_)},[l(e(fe),Je({ref_key:"inputRef",ref:y},e(n),{clearable:k.clearable,disabled:e(P),name:k.name,"model-value":k.modelValue,onInput:O,onChange:K,onFocus:F,onBlur:ee,onClear:le,onKeydown:[q[0]||(q[0]=pe(ve(Z=>Ae(o.value-1),["prevent"]),["up"])),q[1]||(q[1]=pe(ve(Z=>Ae(o.value+1),["prevent"]),["down"])),pe(ae,["enter"]),pe(J,["tab"]),pe(G,["esc"])],onMousedown:N}),Xe({_:2},[k.$slots.prepend?{name:"prepend",fn:i(()=>[de(k.$slots,"prepend")])}:void 0,k.$slots.append?{name:"append",fn:i(()=>[de(k.$slots,"append")])}:void 0,k.$slots.prefix?{name:"prefix",fn:i(()=>[de(k.$slots,"prefix")])}:void 0,k.$slots.suffix?{name:"suffix",fn:i(()=>[de(k.$slots,"suffix")])}:void 0]),1040,["clearable","disabled","name","model-value","onKeydown"])],14,Dt)]),_:3},8,["visible","placement","popper-class","teleported","transition"]))}});var Et=ha(Rt,[["__file","autocomplete.vue"]]);const Ut=Va(Et),be=Q({__name:"TaskList",props:{tableData:{},tableFields:{},tableMode:{},isSelection:{type:Boolean},emptyText:{default:"暂无相关结果"},multipleSelection:{},selections:{},showCheckbox:{type:[Function,Boolean]},checkIntercept:{},showAssignee:{type:Boolean},taskListConfig:{},hightLightWord:{default:""}},emits:["rowClick","update:multipleSelection","update:selections"],setup(c,{expose:D,emit:d}){const m=ea(),n=c,x=d,P=r([]),v=E({set(s){Array.isArray(n.multipleSelection)?x("update:multipleSelection",s):P.value=s},get(){return n.multipleSelection??P.value}}),y=(s,a)=>{const t=m.getFieldInfo(s,{entryId:a});return t!=null&&t.field.type&&Pa.includes(t.field.type)?null:t==null?void 0:t.field},f=s=>{switch(s){case 1:return"warning";case 2:return"success";case 3:case 4:return"danger";case 5:return"info";default:return""}},w=(s,a)=>{x("rowClick",{row:s,index:a,tableData:n.tableData})},A=E(()=>(s,a)=>{const t=y(s,a);return t&&!t.options.alwaysHide});D({selectorAll(){const s=n.tableData.filter(a=>Number(a.isRead)!==1).map(a=>a.taskId);v.value=s}});const b=ne(n,"selections",x),R=E({get(){var s;return((s=b.value)==null?void 0:s.map(a=>a.taskId))??[]},set(s){const a=(s==null?void 0:s.map(t=>({...n.tableData.find(_=>_.taskId===t)})))??[];n.checkIntercept?b.value=n.checkIntercept(a):b.value=a}}),u=E(()=>{switch(n.tableMode){case je.large:return{"line-height":"40px"};case je.small:return{"line-height":"20px"};default:return{"line-height":"30px"}}}),o=E(()=>s=>Ca(n.showCheckbox)?n.showCheckbox(s):!!n.showCheckbox);return(s,a)=>{const t=Fe,g=Da,_=Ze,M=La,V=Ma,U=aa;return I(),$("div",{class:"task_list"},[s.tableData.length?(I(),S(M,{key:0,class:"item_list",modelValue:R.value,"onUpdate:modelValue":a[3]||(a[3]=p=>R.value=p)},{default:i(()=>[(I(!0),$(te,null,se(s.tableData,(p,h)=>(I(),$("div",{key:h,class:"card-item-wrapper"},[l(V,{class:"task-card",onClick:ve(C=>w(p,h),["stop"]),shadow:"hover"},{header:i(()=>{var C;return[z("div",{class:"card-header"},[o.value(p)?(I(),S(t,{key:0,onClick:a[0]||(a[0]=ve(()=>{},["stop"])),label:p.taskId},{default:i(()=>[]),_:2},1032,["label"])):H("",!0),z("span",{class:"card-name"},[p.title?(I(),$("b",{key:0},Y(p.title),1)):(I(),$("b",{key:1},Y(p.taskName?p.taskName:p.appName+"-"+p.entryName),1))]),p.nodeName?(I(),$("span",{key:1,class:"card-node"},[l(_,{effect:"dark",content:"当前节点",placement:"top"},{default:i(()=>[l(g,{type:"info",effect:"light",round:""},{default:i(()=>[B(Y(p.nodeName),1)]),_:2},1024)]),_:2},1024)])):H("",!0),s.showAssignee&&p.assigneeName?(I(),$("span",{key:2},[l(_,{effect:"dark",content:"当前审批人",placement:"top"},{default:i(()=>[l(g,{type:"info",effect:"light",round:""},{default:i(()=>[B(Y(p.assigneeName),1)]),_:2},1024)]),_:2},1024)])):H("",!0),(C=s.taskListConfig)!=null&&C.isStatus?(I(),S(g,{key:3,style:{"margin-left":"5px"},type:f(p.status)},{default:i(()=>[B(Y(p.statusVal),1)]),_:2},1032,["type"])):H("",!0),z("span",{class:"card-time"},Y(p.createTime),1)])]}),default:i(()=>[z("div",{class:"card-content"},[s.isSelection&&Number(p.isRead)!==1?(I(),$("div",{key:0,class:"card-content-check"},[l(M,{modelValue:v.value,"onUpdate:modelValue":a[2]||(a[2]=C=>v.value=C)},{default:i(()=>[l(t,{onClick:a[1]||(a[1]=ve(()=>{},["stop"])),label:p.taskId},{default:i(()=>[]),_:2},1032,["label"])]),_:2},1032,["modelValue"])])):H("",!0),z("div",{class:"card-content-head"},[z("b",null,Y(p.createUser),1)]),z("div",{class:"card-content-form"},[(I(!0),$(te,null,se(p.fields,(C,L)=>(I(),$(te,{key:L},[A.value(C.id,p.entryId)?(I(),$("div",{key:0,class:"form-item",style:Se(u.value)},[l(He,{class:"item-name"},{default:i(()=>{var T;return[B(Y(((T=y(C.id,p.entryId))==null?void 0:T.options.label)??"-"),1)]}),_:2},1024),z("span",{class:"item-sep"},"："),l(He,{class:"item-value"},{default:i(()=>[y(C.id,p.entryId)?(I(),S(Ta,{key:0,emptyText:"-",mode:e(xa).list,content:C.value,field:y(C.id,p.entryId),highlight:{enable:!0,text:s.hightLightWord}},null,8,["mode","content","field","highlight"])):H("",!0)]),_:2},1024)],4)):H("",!0)],64))),128))])])]),_:2},1032,["onClick"])]))),128))]),_:1},8,["modelValue"])):(I(),S(U,{key:1,description:s.emptyText},null,8,["description"]))])}}});const xe=Q({__name:"Group",props:{activeName:{},Group:{},GroupOptions:{default:()=>[{label:"超时",value:j.timeout},{label:"催办",value:j.remind},{label:"进行中",value:j.processing},{label:"已完成",value:j.complete},{label:"已拒绝",value:j.reject},{label:"已中止",value:j.cancel},{label:"已撤销",value:j.repeal}]},isAll:{type:Boolean,default:!0}},emits:["update:activeName"],setup(c,{emit:D}){const d=c,m=E(()=>{const v=d.isAll?[{label:"全部",value:""}]:[],y=d.GroupOptions.filter(f=>{if((d.Group??[]).includes(f.value))return f});return[...v,...y]}),x=ne(d,"activeName",D),P=ue(Aa,{direction:"vertical"});return(v,y)=>{const f=me,w=It;return I(),S(w,{spacer:e(P)},{default:i(()=>[(I(!0),$(te,null,se(m.value,(A,b)=>(I(),S(f,{link:"",key:b,type:e(x)===A.value?"primary":"",onClick:R=>x.value=A.value},{default:i(()=>[B(Y(A.label),1)]),_:2},1032,["type","onClick"]))),128))]),_:1},8,["spacer"])}}}),Nt=c=>{const D=Ra(),d=Ea(),m=Qe("processInstanceId"),n=Qe("taskId");return Ua(()=>{m.value&&c({processInstanceId:m.value,taskId:n.value??""})}),{handleClose:()=>{m.value&&D.replace({...d,query:{...d.query,processInstanceId:void 0,taskId:void 0}})}}},Pe=Nt;var _e=(c=>(c[c.MyPending=0]="MyPending",c[c.MyInitiation=1]="MyInitiation",c[c.MyHandling=2]="MyHandling",c[c.MyCc=3]="MyCc",c))(_e||{});const $t=Q({__name:"FilterGroup",props:{appId:{},flowId:{},flowAppId:{},keyword:{},conditionDTO:{}},emits:["update:flowId","update:flowAppId","update:keyword","update:conditionDTO"],setup(c,{emit:D}){const d=c,m=D,n=ne(d,"flowId",m),x=ne(d,"flowAppId",m),P=ne(d,"keyword",m),v=Na(d,"conditionDTO",m),y=r([]),f=r([]),w=async()=>{const[s,a]=await Promise.all([await Sa(),await Oa()]);y.value=Fa(s);const g=a.map(_=>{var M;return{label:_.name,value:_.id,children:((M=_.appEntryVOList)==null?void 0:M.map(V=>({label:V.name,value:V.id,appId:_.id})))??[]}}).filter(_=>{var M,V;return d.appId?d.appId===_.value&&((M=_.children)==null?void 0:M.length):(V=_.children)==null?void 0:V.length});f.value=[{label:"全部流程",value:"0"},...g]},A=E({get(){return n.value?n.value:"0"},set(s){s==="0"?n.value="":n.value=s}}),b=s=>{x.value=(s==null?void 0:s.appId)??""},R=(s,a)=>a.label.includes(s),u=r(""),o=()=>{P.value=u.value};return ce(()=>u.value,s=>{s||o()}),(s,a)=>{const t=Ba,g=fe,_=qa,M=wt;return I(),S(M,{class:"filter-group",load:w},{default:i(()=>[l(t,{modelValue:e(A),"onUpdate:modelValue":a[0]||(a[0]=V=>W(A)?A.value=V:null),data:e(f),"render-after-expand":!1,style:{width:"200px"},"filter-node-method":R,filterable:"",onCurrentChange:b},null,8,["modelValue","data"]),l(g,{placeholder:"输入关键字，Enter搜索",modelValue:e(u),"onUpdate:modelValue":a[1]||(a[1]=V=>W(u)?u.value=V:null),style:{width:"200px"},onKeyup:pe(o,["enter"]),clearable:""},null,8,["modelValue","onKeyup"]),l(ht,{condition:e(v),"onUpdate:condition":a[2]||(a[2]=V=>W(v)?v.value=V:null),fields:e(y),style:{width:"auto !important"}},{default:i(()=>[l(_,{underline:!1,icon:e($a),type:!e(v)||!e(v).length?"default":"primary"},{default:i(()=>[B(" 筛选 ")]),_:1},8,["icon","type"])]),_:1},8,["condition","fields"])]),_:1})}}});const De=oe($t,[["__scopeId","data-v-a2e59e70"]]),St=Q({__name:"MyInitiation",props:{appId:{}},setup(c){const D=c,d=r(""),m=r({processInstanceId:"",taskId:""}),n=r(),x=r(),P=E(()=>{var t,g;const a={id:"lowcode_InitiateList",query:{list:[]},request:{api:_=>za({..._||{}}),extraParams:E(()=>({appId:D.appId?D.appId:R.value??"",entryId:u.value??"",status:d.value,searchText:o.value,conditionDTO:s.value}))},table:{tableCols:[]},operation:{fullEl:x,position:1,hideField:!0}};return D.appId?(g=a.query)==null||g.list.unshift({type:"select",label:"表单名称",prop:"entryId",options:async()=>(await Ve({appId:D.appId??"",queryType:Ce.create,status:d.value})).map(M=>({label:M.name,value:M.id})),extraOptions:[{label:"全部",value:null}],effectValue:d.value}):(t=a.query)==null||t.list.unshift({type:"input",label:"应用",prop:"appName"}),a}),v=r(!1),y=r({}),f=r(),w=a=>{var _;const{row:t}=a;f.value=t,m.value={processInstanceId:t.processInstanceId,taskId:t.taskId??""};const g=(_=n.value)==null?void 0:_.handleGetParams();y.value={...g,createTimeMs:t.createTimeMs,isNext:1,limit:1,current:1},v.value=!0},A=()=>{var a;(a=n.value)==null||a.refresh()},{handleClose:b}=Pe(a=>{m.value={...a},y.value=void 0,v.value=!0}),R=r(""),u=r(""),o=r(""),s=r();return(a,t)=>{var _,M,V,U;const g=ye("az-page");return I(),$("div",{ref_key:"pendingRef",ref:x},[z("div",{class:"group_wrapper"},[l(xe,{"active-name":d.value,"onUpdate:activeName":t[0]||(t[0]=p=>d.value=p),Group:[e(j).processing,e(j).complete,e(j).reject,e(j).cancel,e(j).repeal]},null,8,["active-name","Group"]),l(De,{appId:a.appId,"flow-app-id":R.value,"onUpdate:flowAppId":t[1]||(t[1]=p=>R.value=p),"flow-id":u.value,"onUpdate:flowId":t[2]||(t[2]=p=>u.value=p),keyword:o.value,"onUpdate:keyword":t[3]||(t[3]=p=>o.value=p),conditionDTO:s.value,"onUpdate:conditionDTO":t[4]||(t[4]=p=>s.value=p)},null,8,["appId","flow-app-id","flow-id","keyword","conditionDTO"])]),l(g,{ref_key:"azPageRef",ref:n,config:P.value},{table:i(({tableData:p,tableFields:h,tableMode:C})=>[l(be,{onRowClick:w,taskListConfig:{isStatus:!0},"table-data":p,"table-fields":h,tableMode:C,"hight-light-word":o.value},null,8,["table-data","table-fields","tableMode","hight-light-word"])]),_:1},8,["config"]),l(Te,{isVisible:v.value,"onUpdate:isVisible":t[5]||(t[5]=p=>v.value=p),params:m.value,"entry-id":(_=f.value)==null?void 0:_.viewEntryId,"data-id":`${(M=f.value)==null?void 0:M.entryId}.${(V=f.value)==null?void 0:V.dataId}`,"view-id":(U=f.value)==null?void 0:U.viewId,onRefresh:A,nextParams:y.value,onClosed:e(b),handleType:e(_e).MyInitiation},null,8,["isVisible","params","entry-id","data-id","view-id","nextParams","onClosed","handleType"])],512)}}});const Ot=oe(St,[["__scopeId","data-v-53296ef5"]]),Ft=Q({__name:"MyPending",props:{appId:{}},setup(c){const D=c,d=r(""),m=r({processInstanceId:"",taskId:""}),n=r(),x=r(),P=E(()=>{var T,O;const L={id:"lowcode_todo",query:{list:[{type:"member",label:"申请人",prop:"creator"}]},request:{api:N=>(Ga.emit(ja),Ha({...N||{}})),extraParams:E(()=>({appId:D.appId?D.appId:U.value??"",entryId:p.value??"",status:d.value,searchText:h.value,conditionDTO:C.value}))},table:{tableCols:[]},operation:{fullEl:x,position:1,hideField:!0}};return D.appId?(O=L.query)==null||O.list.unshift({type:"select",label:"表单名称",prop:"entryId",options:async()=>(await Ve({appId:D.appId??"",queryType:Ce.todo,status:d.value})).map(K=>({label:K.name,value:K.id})),extraOptions:[{label:"全部",value:null}],effectValue:d.value}):(T=L.query)==null||T.list.unshift({type:"input",label:"应用",prop:"appName"}),L}),v=r(!1),y=r({}),f=r(),w=L=>{var N;const{row:T}=L;f.value=T,m.value={processInstanceId:T.processInstanceId,taskId:T.taskId};const O=(N=n.value)==null?void 0:N.handleGetParams();y.value={...O,createTimeMs:T.createTimeMs,isNext:1,limit:1,current:1},y.value,v.value=!0},A=()=>{var L;(L=n.value)==null||L.refresh()},b=L=>{var K;const T=ue("span",{style:"color: green"},"批量通过"),O=ue("span",{style:"color: red"},"批量拒绝"),N=L==="pass";Ke({title:"批量处理确认",message:ue("p",null,[ue("span",null,`当前已选中${((K=o.value)==null?void 0:K.length)??0}条数据，`),ue("span",null,"将进行"),N?T:O,ue("span",null,"操作")]),showCancelButton:!0,confirmButtonText:N?"通过":"拒绝",cancelButtonText:"取消",beforeClose:async(F,ee,le)=>{if(F==="confirm"){ee.confirmButtonLoading=!0;let ae=null;const G=o.value.map(J=>({taskId:J.taskId,formData:J.formData??{},processInstanceId:J.processInstanceId??"",comment:""}));N?ae=await Ka(G):ae=await Wa(G),ee.confirmButtonLoading=!1,A(),s(),R(ae),le()}else le()}})},R=L=>{Ke.alert(L,"批量处理",{dangerouslyUseHTMLString:!0,confirmButtonText:"我知道了"})},u=r(!1),o=r([]),s=()=>{o.value=[],u.value=!1},a=E(()=>{var L,T,O;return((O=(T=(L=n.value)==null?void 0:L.tableData)==null?void 0:T.filter(N=>N.batchExamine))==null?void 0:O.length)??0}),t=E(()=>o.value.length!==0&&o.value.length!==a.value),g=L=>!!a.value&&L.batchExamine,_=L=>{var T;L?o.value=((T=n.value.tableData)==null?void 0:T.filter(O=>O.batchExamine).map(O=>({taskId:O.taskId,formData:O.formData??{},processInstanceId:O.processInstanceId??"",comment:""})))??[]:o.value=[]},M=E(()=>o.value.length>0);ce(()=>o.value,L=>{L.length>100&&(o.value=L.slice(0,100),ge.warning("单次最多审批100条数据")),L.length===a.value&&(u.value=!0),L.length===0&&(u.value=!1)});const{handleClose:V}=Pe(L=>{m.value={...L},y.value=void 0,v.value=!0}),U=r(""),p=r(""),h=r(""),C=r();return(L,T)=>{var F,ee,le,ae;const O=Fe,N=me,K=ye("az-page");return I(),$("div",{ref_key:"pendingRef",ref:x},[z("div",{class:"group_wrapper"},[l(xe,{"active-name":d.value,"onUpdate:activeName":T[0]||(T[0]=G=>d.value=G),Group:[e(j).timeout,e(j).remind]},null,8,["active-name","Group"]),l(De,{appId:L.appId,"flow-app-id":U.value,"onUpdate:flowAppId":T[1]||(T[1]=G=>U.value=G),"flow-id":p.value,"onUpdate:flowId":T[2]||(T[2]=G=>p.value=G),keyword:h.value,"onUpdate:keyword":T[3]||(T[3]=G=>h.value=G),conditionDTO:C.value,"onUpdate:conditionDTO":T[4]||(T[4]=G=>C.value=G)},null,8,["appId","flow-app-id","flow-id","keyword","conditionDTO"])]),l(K,{ref_key:"azPageRef",ref:n,config:P.value},Xe({table:i(({tableData:G,tableFields:J,tableMode:re})=>[l(be,{showCheckbox:g,onRowClick:w,"table-data":G,"table-fields":J,selections:o.value,"onUpdate:selections":T[8]||(T[8]=Le=>o.value=Le),tableMode:re,"hight-light-word":h.value},null,8,["table-data","table-fields","selections","tableMode","hight-light-word"])]),_:2},[a.value?{name:"operation",fn:i(({total:G})=>{var J;return[G>0?(I(),$("div",{key:0,class:"page-operation"},[l(O,{modelValue:u.value,"onUpdate:modelValue":T[5]||(T[5]=re=>u.value=re),indeterminate:t.value,onChange:_,disabled:!a.value},{default:i(()=>[B(" 全选本页 ")]),_:1},8,["modelValue","indeterminate","disabled"]),B(" （已选中 "),z("span",{class:"num"},Y(((J=o.value)==null?void 0:J.length)??0),1),B(" 条） "),z("span",null,[l(N,{type:"primary",disabled:!M.value,onClick:T[6]||(T[6]=re=>b("pass"))},{default:i(()=>[B(" 批量通过 ")]),_:1},8,["disabled"]),l(N,{type:"danger",disabled:!M.value,onClick:T[7]||(T[7]=re=>b("reject"))},{default:i(()=>[B(" 批量拒绝 ")]),_:1},8,["disabled"])])])):H("",!0)]}),key:"0"}:void 0]),1032,["config"]),v.value?(I(),S(Te,{key:0,isVisible:v.value,"onUpdate:isVisible":T[9]||(T[9]=G=>v.value=G),params:m.value,"entry-id":(F=f.value)==null?void 0:F.viewEntryId,"data-id":`${(ee=f.value)==null?void 0:ee.entryId}.${(le=f.value)==null?void 0:le.dataId}`,"view-id":(ae=f.value)==null?void 0:ae.viewId,onRefresh:A,nextParams:y.value,onClosed:e(V),handleType:e(_e).MyPending},null,8,["isVisible","params","entry-id","data-id","view-id","nextParams","onClosed","handleType"])):H("",!0)],512)}}});const Bt=oe(Ft,[["__scopeId","data-v-defa3f8d"]]),qt=Q({__name:"MyCc",props:{appId:{}},setup(c){const D=c,d=r(""),m=r({processInstanceId:"",taskId:""}),n=r(),x=r();r(!0);const P=E(()=>{var h,C;const p={id:"lowcode_cc",query:{list:[{type:"member",label:"申请人",prop:"creator"}]},request:{api:L=>Qa({...L||{}}),extraParams:E(()=>({appId:D.appId?D.appId:_.value??"",entryId:M.value??"",isRead:d.value,searchText:V.value,conditionDTO:U.value}))},table:{tableCols:[]},operation:{fullEl:x,hideField:!0}};return D.appId?(C=p.query)==null||C.list.unshift({type:"select",label:"表单名称",prop:"entryId",options:async()=>(await Ve({appId:D.appId??"",queryType:Ce.cc,isRead:d.value})).map(T=>({label:T.name,value:T.id})),extraOptions:[{label:"全部",value:null}],effectValue:d.value}):(h=p.query)==null||h.list.unshift({type:"input",label:"应用名称",prop:"appName"}),p}),v=r(!1),y=r({}),f=r(),w=p=>{var L;const{row:h}=p;p.row.isRead="1",f.value=p.row.isRead,m.value={processInstanceId:h.processInstanceId,taskId:h.taskId};const C=(L=n.value)==null?void 0:L.handleGetParams();y.value={...C,createTimeMs:h.createTimeMs,isNext:1,limit:1,current:1},y.value,v.value=!0},A=()=>{var p;(p=n.value)==null||p.refresh()},b=r([]),R=r(),u=r(!1),o=()=>{var p;(p=R.value)==null||p.selectorAll(),b.value.length>=1&&(u.value=!0)},s=()=>{b.value=[],u.value=!1},a=r(!1),t=async()=>{a.value=!0;try{await Ya(b.value),ge.success("标记成功"),b.value=[],u.value=!1,A()}finally{a.value=!1}},{handleClose:g}=Pe(p=>{m.value={...p},y.value=void 0,v.value=!0}),_=r(""),M=r(""),V=r(""),U=r();return(p,h)=>{var T,O,N,K;const C=me,L=ye("az-page");return I(),$("div",{ref_key:"pendingRef",ref:x},[z("div",{class:"group_wrapper"},[l(xe,{isAll:"","active-name":d.value,"onUpdate:activeName":h[0]||(h[0]=F=>d.value=F),Group:["1","0"],GroupOptions:[{label:"已阅",value:"1"},{label:"未阅",value:"0"}]},null,8,["active-name"]),l(De,{appId:p.appId,"flow-app-id":_.value,"onUpdate:flowAppId":h[1]||(h[1]=F=>_.value=F),"flow-id":M.value,"onUpdate:flowId":h[2]||(h[2]=F=>M.value=F),keyword:V.value,"onUpdate:keyword":h[3]||(h[3]=F=>V.value=F),conditionDTO:U.value,"onUpdate:conditionDTO":h[4]||(h[4]=F=>U.value=F)},null,8,["appId","flow-app-id","flow-id","keyword","conditionDTO"])]),l(L,{ref_key:"azPageRef",ref:n,config:P.value},{operation:i(()=>[u.value?(I(),S(C,{key:1,loading:a.value,type:"primary",onClick:s},{default:i(()=>[B(" 取消全选 ")]),_:1},8,["loading"])):(I(),S(C,{key:0,type:"primary",onClick:o},{default:i(()=>[B(" 全选 ")]),_:1})),l(C,{loading:a.value,disabled:b.value.length<1,type:"primary",onClick:t},{default:i(()=>[B(" 标为已阅 ")]),_:1},8,["loading","disabled"])]),table:i(({tableData:F,tableFields:ee,tableMode:le})=>[l(be,{onRowClick:w,"table-data":F,multipleSelection:b.value,"onUpdate:multipleSelection":h[5]||(h[5]=ae=>b.value=ae),isSelection:"",taskListConfig:{isStatus:!0},tableMode:le,"table-fields":ee,ref_key:"taskRef",ref:R,"hight-light-word":V.value},null,8,["table-data","multipleSelection","tableMode","table-fields","hight-light-word"])]),_:1},8,["config"]),l(Te,{"is-visible":v.value,"onUpdate:isVisible":h[6]||(h[6]=F=>v.value=F),params:m.value,"entry-id":(T=f.value)==null?void 0:T.viewEntryId,"data-id":`${(O=f.value)==null?void 0:O.entryId}.${(N=f.value)==null?void 0:N.dataId}`,"view-id":(K=f.value)==null?void 0:K.viewId,onRefresh:A,nextParams:y.value,onClosed:e(g),handleType:e(_e).MyCc},null,8,["is-visible","params","entry-id","data-id","view-id","nextParams","onClosed","handleType"])],512)}}});const zt=oe(qt,[["__scopeId","data-v-3b41d76f"]]);var X=(c=>(c.MyPending="MyPending",c.MyInitiation="MyInitiation",c.MyCc="MyCc",c.AllData="AllData",c.MyHandling="MyHandling",c.ProcessCenter="ProcessCenter",c.ProcessManager="ProcessManager",c))(X||{});const Gt=Q({__name:"ProcessCenter",props:{appId:{}},setup(c){const D=c,d=r([]),m=r([]),n=r(""),x=async()=>{const u=await Xa(D.appId);d.value=u,m.value=u,Za(()=>{f.value=b()})},P=kt(),v=(u,o)=>{et(at,{query:{appId:u,entryId:o}}),P.historyPath=tt,P.historyParams={taskPane:X.ProcessCenter}},y=u=>({name:u.name,icon:u.icon,color:u.color,isGradient:!0,isBackGroundColor:!0}),f=r([]),w=(u,o)=>{const s=u?f.value.filter(A(u)):f.value;o(s)},A=u=>o=>o.value.toLowerCase().indexOf(u.toLowerCase())===0,b=()=>lt(d.value).reduce((s,a)=>{const t={value:a.appVO.name,objValue:a},g=Array.isArray(a.appEntryVOList)?a.appEntryVOList.map(_=>({value:_.name,objValue:{appVO:a.appVO,appEntryVOList:[_]}})):[];return s.concat(t).concat(...g)},[]),R=u=>{m.value=[u.objValue]};return ce(()=>n.value,()=>{n.value||(m.value=d.value)}),(u,o)=>{const s=aa,a=Ut;return I(),$("div",null,[l(Ja,{load:x},{default:i(()=>{var t;return[(t=m.value)!=null&&t.length?H("",!0):(I(),S(s,{key:0,description:"暂无相关结果"})),(I(!0),$(te,null,se(m.value,(g,_)=>(I(),$("div",{class:"process_center",key:g.appVO.id},[z("div",null,[z("span",{class:"title"},Y(g.appVO.name),1),_===0?(I(),S(a,{key:0,modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=M=>n.value=M),clearable:"","fetch-suggestions":w,class:"search",placeholder:"输入关键字搜索",onSelect:R},null,8,["modelValue"])):H("",!0)]),z("div",null,[(I(!0),$(te,null,se(g.appEntryVOList,M=>(I(),S(Vt,Je({class:"box_item",key:M.id},{...y(M)},{onClick:V=>v(g.appVO.id,M.id)}),null,16,["onClick"]))),128))])]))),128))]}),_:1})])}}});const jt=oe(Gt,[["__scopeId","data-v-d8237f94"]]),Ht=Q({__name:"MyHandling",props:{appId:{}},setup(c){const D=c,d=r(""),m=r({processInstanceId:"",taskId:""}),n=r(),x=r(),P=E(()=>{var t,g;const a={id:"lowcode_assignList",query:{list:[{type:"member",label:"申请人",prop:"creator"}]},request:{api:_=>nt({..._||{}}),extraParams:E(()=>({appId:D.appId?D.appId:R.value??"",entryId:u.value??"",status:d.value,searchText:o.value,conditionDTO:s.value}))},table:{tableCols:[]},operation:{fullEl:x,position:1,hideField:!0}};return D.appId?(g=a.query)==null||g.list.unshift({type:"select",label:"表单名称",prop:"entryId",options:async()=>(await Ve({appId:D.appId??"",queryType:Ce.party,status:d.value})).map(M=>({label:M.name,value:M.id})),extraOptions:[{label:"全部",value:null}],effectValue:d.value}):(t=a.query)==null||t.list.unshift({type:"input",label:"应用",prop:"appName"}),a}),v=r(!1),y=r({}),f=r(),w=a=>{var _;const{row:t}=a;f.value=t,m.value={processInstanceId:t.processInstanceId,taskId:t.taskId};const g=(_=n.value)==null?void 0:_.handleGetParams();y.value={...g,createTimeMs:t.createTimeMs,isNext:1,limit:1,current:1},v.value=!0},A=()=>{var a;(a=n.value)==null||a.refresh()},{handleClose:b}=Pe(a=>{m.value={...a},y.value=void 0,v.value=!0}),R=r(""),u=r(""),o=r(""),s=r();return(a,t)=>{var _,M,V,U;const g=ye("az-page");return I(),$("div",{ref_key:"pendingRef",ref:x},[z("div",{class:"group_wrapper"},[l(xe,{"active-name":d.value,"onUpdate:activeName":t[0]||(t[0]=p=>d.value=p),Group:[e(j).processing,e(j).complete,e(j).reject,e(j).cancel,e(j).repeal]},null,8,["active-name","Group"]),l(De,{appId:a.appId,"flow-app-id":R.value,"onUpdate:flowAppId":t[1]||(t[1]=p=>R.value=p),"flow-id":u.value,"onUpdate:flowId":t[2]||(t[2]=p=>u.value=p),keyword:o.value,"onUpdate:keyword":t[3]||(t[3]=p=>o.value=p),conditionDTO:s.value,"onUpdate:conditionDTO":t[4]||(t[4]=p=>s.value=p)},null,8,["appId","flow-app-id","flow-id","keyword","conditionDTO"])]),l(g,{ref_key:"azPageRef",ref:n,config:P.value},{table:i(({tableData:p,tableFields:h,tableMode:C})=>[l(be,{onRowClick:w,taskListConfig:{isStatus:!0},"table-data":p,"table-fields":h,tableMode:C,"hight-light-word":o.value},null,8,["table-data","table-fields","tableMode","hight-light-word"])]),_:1},8,["config"]),l(Te,{isVisible:v.value,"onUpdate:isVisible":t[5]||(t[5]=p=>v.value=p),params:m.value,"entry-id":(_=f.value)==null?void 0:_.viewEntryId,"data-id":`${(M=f.value)==null?void 0:M.entryId}.${(V=f.value)==null?void 0:V.dataId}`,"view-id":(U=f.value)==null?void 0:U.viewId,onRefresh:A,nextParams:y.value,onClosed:e(b),handleType:e(_e).MyHandling},null,8,["isVisible","params","entry-id","data-id","view-id","nextParams","onClosed","handleType"])],512)}}});const Kt=oe(Ht,[["__scopeId","data-v-ddee7e1f"]]),Wt=Q({__name:"DetailDialog",props:{modelValue:{type:Boolean},params:{}},emits:["update:modelValue","refresh","changeApprover"],setup(c,{emit:D}){const d=c,m=D,n=ne(d,"modelValue",m),x=r(),{loadFlowData:P,flowTaskInfo:v,formDesigner:y,formOptions:f}=Tt(),w=async()=>{const b=await P(d.params);x.value=(b==null?void 0:b.entryName)??""},A=()=>{m("changeApprover")};return(b,R)=>{const u=me;return I(),S(ot,{class:"current-az-drawer",modelValue:e(n),"onUpdate:modelValue":R[0]||(R[0]=o=>W(n)?n.value=o:null),title:e(x),direction:"btt",size:"90%","show-load":w,"append-to-body":""},{default:i(()=>[e(v)?(I(),S(e(st),{key:0,ref:"formRenderRef","form-designer":e(y),options:e(f)},{bottom:i(()=>[z("div",{class:"form-footer-wrap"},[l(u,{type:"primary",onClick:A},{default:i(()=>[B(" 调整审批人 ")]),_:1})])]),_:1},8,["form-designer","options"])):H("",!0)]),_:1},8,["modelValue","title"])}}});const Qt=oe(Wt,[["__scopeId","data-v-f1ce9a58"]]),Yt=Q({__name:"BatchTran",props:{modelValue:{type:Boolean},selections:{}},emits:["update:modelValue","refresh"],setup(c,{emit:D}){var b,R,u,o;const d=c,m=D,n=ne(d,"modelValue",m),x={comment:"",taskIds:d.selections.map(s=>s.taskId),oldUser:{userId:(R=(b=d.selections)==null?void 0:b[0])==null?void 0:R.assignee,userName:(o=(u=d.selections)==null?void 0:u[0])==null?void 0:o.assigneeName},transferUser:{userId:"",userName:""}},P=r({...x}),v=r(),y=E(()=>{var s,a;return((a=(s=d.selections)==null?void 0:s[0])==null?void 0:a.assigneeName)??"-"}),f=r(),w=s=>{var a,t;P.value.transferUser.userId=((a=s==null?void 0:s[0])==null?void 0:a.__id__)??"",P.value.transferUser.userName=((t=s==null?void 0:s[0])==null?void 0:t.__label__)??""},A=async()=>{var s;await((s=v.value)==null?void 0:s.validate()),await rt(P.value),ge.success("转交成功"),m("refresh")};return(s,a)=>{const t=la,g=Be,_=fe,M=qe,V=na;return I(),S(V,{modelValue:e(n),"onUpdate:modelValue":a[3]||(a[3]=U=>W(n)?n.value=U:null),title:"批量转交",width:"600px"},{footer:i(()=>[l(ta,{editMode:!0,onClose:a[2]||(a[2]=U=>n.value=!1),"on-submit":A})]),default:i(()=>[l(t,{class:"mb-10",title:"将某人的审批任务转交给他人，原审批人不再处理",type:"success",closable:!1}),l(M,{"label-width":"120px",ref_key:"formRef",ref:v,model:e(P),"label-suffix":"："},{default:i(()=>[l(g,{label:"原审批人"},{default:i(()=>[B(Y(e(y)),1)]),_:1}),l(g,{label:"新审批人",prop:"transferUser.userId",rules:[{required:!0,message:"请选择新审批人",trigger:"change"}]},{default:i(()=>[l(he,{modelValue:e(f),"onUpdate:modelValue":a[0]||(a[0]=U=>W(f)?f.value=U:null),ref:"selectPaneRef",tabs:[e(ke).memberByOrg],onChange:w},null,8,["modelValue","tabs"])]),_:1}),l(g,{label:"调整原因",prop:"comment",rules:[{required:!0,message:"请填写调整原因",trigger:"blur"}]},{default:i(()=>[l(_,{modelValue:e(P).comment,"onUpdate:modelValue":a[1]||(a[1]=U=>e(P).comment=U),type:"textarea",placeholder:"请输入调整原因",autosize:{minRows:3,maxRows:6}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}}),Jt=Q({__name:"ChangeApprover",props:{modelValue:{type:Boolean},target:{}},emits:["update:modelValue","refresh"],setup(c,{emit:D}){const d=c,m=D,n=ne(d,"modelValue",m),x={nodeId:d.target.node,comment:"",taskId:"",userList:[],oldList:[]},P=r({...x}),v=r(),y=async()=>{var u;await((u=v.value)==null?void 0:u.validate()),await ut(P.value),ge.success("调整成功"),m("refresh")},f=r([]),w=async()=>(f.value=await it(d.target.processInstanceId),f.value),A=E(()=>{var o,s;const u=f.value.find(a=>a.nodeId===P.value.nodeId);return P.value.oldList=(u==null?void 0:u.taskUsers)??[],P.value.taskId=(u==null?void 0:u.taskId)??"",(o=u==null?void 0:u.taskUsers)!=null&&o.length?(s=u.taskUsers)==null?void 0:s.map(a=>a.userName).join("，"):"-"}),b=r([]),R=u=>{P.value.userList=(u==null?void 0:u.map(o=>({userId:o.__id__,userName:o.__label__??""})))??[]};return(u,o)=>{const s=la,a=sa,t=Be,g=fe,_=qe,M=na;return I(),S(M,{modelValue:e(n),"onUpdate:modelValue":o[4]||(o[4]=V=>W(n)?n.value=V:null),title:"批量转交",width:"600px"},{footer:i(()=>[l(ta,{editMode:!0,onClose:o[3]||(o[3]=V=>n.value=!1),"on-submit":y})]),default:i(()=>[l(s,{class:"mb-10",title:"将当前节点的所有未审批人员进行重新分配，已审批人员保持不变",type:"success",closable:!1}),l(_,{"label-width":"120px",ref_key:"formRef",ref:v,model:e(P),"label-suffix":"："},{default:i(()=>[l(t,{label:"当前节点",prop:"nodeId",rules:[{required:!0,message:"请选择当前节点",trigger:"change"}]},{default:i(()=>[l(Oe,{style:{width:"100%"},load:w,modelValue:e(P).nodeId,"onUpdate:modelValue":o[0]||(o[0]=V=>e(P).nodeId=V)},{default:i(({options:V})=>[(I(!0),$(te,null,se(V,U=>(I(),S(a,{key:U.nodeId,label:U.name,value:U.nodeId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(t,{label:"原审批人"},{default:i(()=>[B(Y(e(A)),1)]),_:1}),l(t,{label:"新审批人",prop:"userList",rules:[{required:!0,message:"请选择新审批人",trigger:"change"}]},{default:i(()=>[l(he,{modelValue:e(b),"onUpdate:modelValue":o[1]||(o[1]=V=>W(b)?b.value=V:null),ref:"selectPaneRef",multiple:"",tabs:[e(ke).memberByOrg],onChange:R},null,8,["modelValue","tabs"])]),_:1}),l(t,{label:"调整原因",prop:"comment",rules:[{required:!0,message:"请填写调整原因",trigger:"blur"}]},{default:i(()=>[l(g,{modelValue:e(P).comment,"onUpdate:modelValue":o[2]||(o[2]=V=>e(P).comment=V),type:"textarea",placeholder:"请输入调整原因",autosize:{minRows:3,maxRows:6}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}}),Xt=Q({__name:"SearchTop",props:{modelValue:{},appId:{},entryList:{},instanceList:{},nodeList:{}},emits:["update:modelValue","refresh","reset"],setup(c,{emit:D}){const d=c,m=D,n=ne(d,"modelValue",m),x=E({get(){return n.value.assignee?{type:We.member,id:n.value.assignee}:null},set(f){n.value.assignee=(f==null?void 0:f.id)??""}}),P=E({get(){return n.value.creator?{type:We.member,id:n.value.creator}:null},set(f){n.value.creator=(f==null?void 0:f.id)??""}}),v=E({get(){return[n.value.startTime,n.value.endTime]},set(f){const[w,A]=f??["",""];n.value.startTime=w,n.value.endTime=A}}),y=async()=>(await pt({appId:"",name:"",orgIds:[]})).map(w=>({label:w.name,value:w.id}));return(f,w)=>{const A=fe,b=Be,R=ct,u=sa,o=mt,s=me,a=qe;return I(),S(a,{model:e(n),"label-width":"100px",inline:""},{default:i(()=>[l(b,{label:"标题"},{default:i(()=>[l(A,{modelValue:e(n).title,"onUpdate:modelValue":w[0]||(w[0]=t=>e(n).title=t),placeholder:"请输入标题",style:{width:"220px"}},null,8,["modelValue"])]),_:1}),l(b,{label:"当前审批人"},{default:i(()=>[l(he,{modelValue:e(x),"onUpdate:modelValue":w[1]||(w[1]=t=>W(x)?x.value=t:null),ref:"selectPaneRef",tabs:[e(ke).memberByOrg],placeholder:"请选择当前审批人",style:{width:"220px"}},null,8,["modelValue","tabs"])]),_:1}),l(b,{label:"发起人"},{default:i(()=>[l(he,{modelValue:e(P),"onUpdate:modelValue":w[2]||(w[2]=t=>W(P)?P.value=t:null),ref:"selectPaneRef",tabs:[e(ke).memberByOrg],placeholder:"请选择发起人",style:{width:"220px"}},null,8,["modelValue","tabs"])]),_:1}),l(b,{label:"发起时间"},{default:i(()=>[l(R,{modelValue:e(v),"onUpdate:modelValue":w[3]||(w[3]=t=>W(v)?v.value=t:null),clearable:"",style:{width:"70%","max-width":"500px"},"value-format":"YYYY-MM-DD HH:mm:ss",type:"datetimerange","range-separator":"至","start-placeholder":"起始时间","end-placeholder":"结束时间","default-time":[new Date(2e3,1,1,0,0,0),new Date(2e3,2,1,23,59,59)]},null,8,["modelValue","default-time"])]),_:1}),f.appId?H("",!0):(I(),S(b,{key:0,label:"所属应用"},{default:i(()=>[l(Oe,{modelValue:e(n).appId,"onUpdate:modelValue":w[4]||(w[4]=t=>e(n).appId=t),placeholder:"请选择所属应用",load:y,clearable:"",filterable:"",style:{width:"220px"}},{default:i(({options:t})=>[(I(!0),$(te,null,se(t,g=>(I(),S(u,{label:g.label,value:g.value,key:g.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})),l(b,{label:"所属业务"},{default:i(()=>[l(o,{modelValue:e(n).entryId,"onUpdate:modelValue":w[5]||(w[5]=t=>e(n).entryId=t),options:f.entryList,placeholder:"请选择所属业务",filterable:"",clearable:"",style:{width:"220px"}},null,8,["modelValue","options"])]),_:1}),l(b,{label:"所属流程"},{default:i(()=>[l(o,{modelValue:e(n).instanceId,"onUpdate:modelValue":w[6]||(w[6]=t=>e(n).instanceId=t),options:f.instanceList,placeholder:"请选择所属流程",filterable:"",clearable:"",style:{width:"220px"}},null,8,["modelValue","options"])]),_:1}),l(b,{label:"当前节点"},{default:i(()=>[l(Oe,{modelValue:e(n).node,"onUpdate:modelValue":w[7]||(w[7]=t=>e(n).node=t),placeholder:"请先选择所属流程",load:f.nodeList,clearable:"",filterable:"",style:{width:"220px"}},{default:i(({options:t})=>[(I(!0),$(te,null,se(t,g=>(I(),S(u,{label:g.label,value:g.value,key:g.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","load"])]),_:1}),l(b,null,{default:i(()=>[l(s,{type:"primary",icon:e(dt),onClick:w[8]||(w[8]=t=>m("refresh"))},{default:i(()=>[B(" 查询 ")]),_:1},8,["icon"]),l(s,{onClick:w[9]||(w[9]=t=>m("reset"))},{default:i(()=>[B("重置")]),_:1})]),_:1})]),_:1},8,["model"])}}}),Zt=c=>{const D=r([]),d=async()=>{const v=await vt(c.value.appId);D.value=v.map(y=>({label:y.appName,value:y.id}))},m=r([]),n=async()=>{const v=await ft.pageFlowList({appId:c.value.appId,current:1,entryId:c.value.entryId,flowName:"",limit:99999999,order:""});m.value=v.records.map(y=>({label:y.title,value:y.flowId}))},x=r([]),P=async()=>{const v=await yt(c.value.instanceId??"");x.value=v.map(y=>({label:y.name,value:y.nodeId}))};return n(),d(),ce(()=>c.value.appId,v=>{c.value={...c.value,instanceId:"",entryId:"",node:""},n(),d()}),ce(()=>c.value.entryId,v=>{c.value={...c.value,instanceId:"",node:""},n()}),ce(()=>c.value.instanceId,v=>{c.value={...c.value,node:""},P()}),{entryList:D,instanceList:m,nodeList:x}},el=Zt,al=Q({__name:"ProcessManager",props:{appId:{}},setup(c){const D=c,d=r(),m={title:"",assignee:"",creator:"",startTime:"",endTime:"",appId:D.appId??"",entryId:"",instanceId:"",node:""},n=r({...m}),{entryList:x,instanceList:P,nodeList:v}=el(n),y=()=>{n.value={...m},w()},f=E(()=>({request:{api:gt,extraParams:E(()=>({...n.value}))}}));function w(){var h;(h=d.value)==null||h.refresh()}const A=E({get(){var h,C;return((h=b.value)==null?void 0:h.length)===((C=d.value.tableData)==null?void 0:C.length)},set(h){h?b.value=a(d.value.tableData):b.value=[]}}),b=r([]),R=E(()=>b.value.length!==0),u=E(()=>b.value.length>0),o=r(!1),s=()=>{o.value=!0},a=h=>{const C=h==null?void 0:h[0];let L=!1;const T=(h==null?void 0:h.filter(O=>O.assignee===C.assignee?!0:(L=!0,!1)))??[];return L&&ge.error("暂只支持同一审批人的多条任务进行批量处理"),T},t=()=>{A.value=!1,w()},g=r(!1),_=r({processInstanceId:"",taskId:"",node:""}),M=h=>{const{row:C}=h;_.value={processInstanceId:C.processInstanceId,taskId:C.taskId,node:C.node},g.value=!0},V=r(!1),U=()=>{V.value=!0},p=()=>{g.value=!1,w()};return(h,C)=>{const L=Fe,T=me,O=ye("az-page");return I(),$("div",{class:"process_manager"},[l(O,{ref_key:"azPageRef",ref:d,config:e(f)},{searchTop:i(()=>[l(Xt,{modelValue:e(n),"onUpdate:modelValue":C[0]||(C[0]=N=>W(n)?n.value=N:null),appId:h.appId,"entry-list":e(x),"instance-list":e(P),"node-list":e(v),onRefresh:w,onReset:y},null,8,["modelValue","appId","entry-list","instance-list","node-list"])]),operation:i(({total:N})=>{var K;return[N>0?(I(),$("div",{key:0,class:"page-operation"},[l(L,{modelValue:e(A),"onUpdate:modelValue":C[1]||(C[1]=F=>W(A)?A.value=F:null),indeterminate:e(R)},{default:i(()=>[B(" 全选本页 ")]),_:1},8,["modelValue","indeterminate"]),B(" （已选中 "),z("span",{class:"num"},Y(((K=e(b))==null?void 0:K.length)??0),1),B(" 条） "),z("span",null,[l(T,{type:"primary",disabled:!e(u),onClick:s},{default:i(()=>[B(" 批量转交 ")]),_:1},8,["disabled"])])])):H("",!0)]}),table:i(({tableData:N,tableFields:K,tableMode:F})=>[l(be,{showCheckbox:"",showAssignee:"",onRowClick:M,"table-data":N,"table-fields":K,selections:e(b),"onUpdate:selections":C[2]||(C[2]=ee=>W(b)?b.value=ee:null),tableMode:F,checkIntercept:a},null,8,["table-data","table-fields","selections","tableMode"])]),_:1},8,["config"]),e(g)?(I(),S(Qt,{key:0,modelValue:e(g),"onUpdate:modelValue":C[3]||(C[3]=N=>W(g)?g.value=N:null),params:e(_),onChangeApprover:U},null,8,["modelValue","params"])):H("",!0),e(o)?(I(),S(Yt,{key:1,modelValue:e(o),"onUpdate:modelValue":C[4]||(C[4]=N=>W(o)?o.value=N:null),selections:e(b),onRefresh:t},null,8,["modelValue","selections"])):H("",!0),e(V)?(I(),S(Jt,{key:2,modelValue:e(V),"onUpdate:modelValue":C[5]||(C[5]=N=>W(V)?V.value=N:null),onRefresh:p,target:e(_)},null,8,["modelValue","target"])):H("",!0)])}}}),tl=Q({__name:"myTask",props:{appId:{}},setup(c){ea();const D=[X.MyPending,X.MyHandling,X.MyInitiation,X.ProcessCenter,X.MyCc,X.ProcessManager],d=E(()=>bt("lowcode:taskManager"));return(m,n)=>{const x=_t;return I(),S(Ct,{queryKey:"taskPane",tabs:D},{default:i(()=>[l(x,{label:"我的待办",name:e(X).MyPending,lazy:""},{default:i(()=>[l(Bt,{class:"content_box",appId:m.appId},null,8,["appId"])]),_:1},8,["name"]),l(x,{label:"我发起的",name:e(X).MyInitiation,lazy:""},{default:i(()=>[l(Ot,{class:"content_box",appId:m.appId},null,8,["appId"])]),_:1},8,["name"]),l(x,{label:"我处理的",name:e(X).MyHandling,lazy:""},{default:i(()=>[l(Kt,{class:"content_box",appId:m.appId},null,8,["appId"])]),_:1},8,["name"]),l(x,{label:"抄送我的",name:"MyCc",lazy:""},{default:i(()=>[l(zt,{class:"content_box",appId:m.appId},null,8,["appId"])]),_:1}),l(x,{label:"流程中心",name:e(X).ProcessCenter,lazy:""},{default:i(()=>[l(jt,{class:"content_box",appId:m.appId},null,8,["appId"])]),_:1},8,["name"]),e(d)?(I(),S(x,{key:0,label:"流程管理",name:e(X).ProcessManager,lazy:""},{default:i(()=>[l(al,{class:"content_box",appId:m.appId},null,8,["appId"])]),_:1},8,["name"])):H("",!0)]),_:1})}}});const ml=oe(tl,[["__scopeId","data-v-2c975794"]]);export{ml as m};
