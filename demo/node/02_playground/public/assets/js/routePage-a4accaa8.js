import{d as k,r as l,bi as P,iC as E,o as w,f as D,i,w as c,e as B,b as N,B as z,ae as U,m as I,rT as M,cc as m,rW as S,bh as L,as as R,aN as g,P as T,U as $}from"./index-b80d5ef5.js";import{P as q,p as F,a as H,b as W,c as j,d as G,e as J}from"./PosAddAndEdit-00e09967.js";const K={name:"Position"},Y=k({...K,setup(O){const n=l(!1),p=l(!1),v=l(),d=l([]),r=l("add"),s=l(),x={query:{list:[{type:"input",label:"职位名称",prop:"positionName"},{type:"select",label:"状态",prop:"status",options:"status",isAll:!0,initValue:m}]},request:{api:F},table:{tableCols:[{type:"index",width:55,label:"序号"},{prop:"positionName",label:"职位名称"},{prop:"status",label:"状态",slots:{default({row:e}){return i(L,{disabled:!S("system:position:enable"),modelValue:e.status,"onUpdate:modelValue":t=>e.status=t,updateFetch:()=>A(e.id,e.status)},null)}}},{fixed:"right",width:230,label:"操作",slots:{default({row:e}){return i(R,{num:4,list:[{id:"system:position:edit",type:"primary",premission:"system:position:edit",onClick:()=>{y("edit",e)},text:"编辑"},{id:"system:position:user",type:"primary",onClick:async()=>{await C(e)},premission:"system:position:user",text:"职位成员"},{id:"system:position:detail",type:"primary",premission:"system:position:detail",onClick:()=>{s.value={...e},r.value="view",n.value=!0},text:"查看"},{id:"system:position:delete",type:"danger",premission:"system:position:delete",text:"删除",popconfirmProps:{title:"您确定要删除该职位吗?",confirm:async()=>{await G(e.id),g.success("删除成功"),await u()}}}]},null)}}}]}},u=async()=>{var e;await((e=v.value)==null?void 0:e.refresh())},y=(e,t)=>{e==="add"?s.value={positionName:"",remark:"",status:m}:t&&(s.value={...t}),r.value=e,n.value=!0},A=async(e,t)=>{t==m?await H(e):await W(e),u()},C=async e=>{const t=e.id;s.value=e;const a=await J(t);d.value=a,p.value=!0},V=async e=>{var a;const t={userList:d.value,id:(a=s.value)==null?void 0:a.id};await j(t),g.success("保存成功")};return(e,t)=>{var h;const a=T,f=$,b=P("az-page"),_=E("premission");return w(),D("div",null,[i(b,{class:"layout_box",ref_key:"azPageRef",ref:v,config:x,maxHeight:"var(--az-layout-main-height) - 32px"},{operation:c(()=>[B((w(),N(f,{onClick:t[0]||(t[0]=o=>y("add")),type:"primary"},{default:c(()=>[i(a,{size:16,style:{"margin-right":"8px"}},{default:c(()=>[i(z(U))]),_:1}),I(" 新增职位 ")]),_:1})),[[_,"system:position:add"]])]),_:1},512),i(q,{"drawer-model":n.value,"onUpdate:drawerModel":t[1]||(t[1]=o=>n.value=o),"row-data":s.value,onRefresh:u,"com-state":r.value},null,8,["drawer-model","row-data","com-state"]),i(M,{modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=o=>d.value=o),visible:p.value,"onUpdate:visible":t[3]||(t[3]=o=>p.value=o),label:"职位成员","mini-title":(h=s.value)==null?void 0:h.positionName,multiple:!0,onChange:V,type:"member"},null,8,["modelValue","visible","mini-title"])])}}});export{Y as default};
