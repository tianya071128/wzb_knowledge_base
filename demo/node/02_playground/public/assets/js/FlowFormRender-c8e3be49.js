import{r as L,bx as De,aT as se,v$ as pe,y as Ee,w0 as Se,w1 as Te,w2 as Pe,i as k,lL as ie,d as te,w3 as xe,w4 as ce,lO as ue,lT as Y,w5 as Re,c as $,w6 as Fe,w7 as Ne,lU as Oe,w8 as Ae,lN as Le,w9 as Ve,bK as ve,I as he,wa as Ue,wb as $e,wc as Me,aS as je,wd as me,we as qe,wf as He,wg as Ke,wh as We,wi as ze,wj as Ye,wk as Je,mb as Ge,d8 as Qe,aN as F,ch as I,wl as Xe,wm as Ze,wn as ea,m9 as aa,wo as ta,wp as na,wq as ra,wr as sa,ws as ca,wt as oa,wu as la,wv as fe,aa as we,a as ia,es as ua,a8 as da,i0 as ma,eo as fa,p$ as be,bI as wa,dW as ba,o as X,b as Z,w as ee,B as D,ib as _a,ww as ya,m as ka,l as ne,wx as va,dY as ha,L as ga,U as Ia,_ as Ca}from"./index-b80d5ef5.js";import{c,N as _e,a as K,d as re}from"./enum-7a2ae6a9.js";import{B as oe}from"./index-ae93b8ef.js";import{r as Ba,u as Da}from"./use-route-c2b2b5be.js";import{u as pa}from"./useFlowForm-df7c1aa0.js";const Ea=(e,r)=>{const n=L(),u=()=>{n.value=Pe(e).height};return De(()=>{if(se(u),r)for(let m=1;m<=3;m++)setTimeout(u,100*m)}),pe(()=>se(u)),Ee([Se,Te],u),n};function Sa(e,r){const n=Ea(e,!0);return u=>k("div",{class:r("placeholder"),style:{height:n.value?`${n.value}px`:void 0}},[u()])}const[ge,ye]=ie("action-bar"),Ie=Symbol(ge),Ta={placeholder:Boolean,safeAreaInsetBottom:ce};var Pa=te({name:ge,props:Ta,setup(e,{slots:r}){const n=L(),u=Sa(n,ye),{linkChildren:m}=xe(Ie);m();const g=()=>{var C;return k("div",{ref:n,class:[ye(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[(C=r.default)==null?void 0:C.call(r)])};return()=>e.placeholder?u(g):g()}});const xa=ue(Pa),[Ra,Fa]=ie("action-bar-button"),Na=Y({},Ba,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var Oa=te({name:Ra,props:Na,setup(e,{slots:r}){const n=Da(),{parent:u,index:m}=Re(Ie),g=$(()=>{if(u){const b=u.children[m.value-1];return!(b&&"isButton"in b)}}),C=$(()=>{if(u){const b=u.children[m.value+1];return!(b&&"isButton"in b)}});return Fe({isButton:!0}),()=>{const{type:b,icon:f,text:T,color:O,loading:P,disabled:p}=e;return k(oe,{class:Fa([b,{last:C.value,first:g.value}]),size:"large",type:b,icon:f,color:O,loading:P,disabled:p,onClick:n},{default:()=>[r.default?r.default():T]})}}});const ke=ue(Oa),[Aa,R,ae]=ie("dialog"),La=Y({},Ne,{title:String,theme:String,width:Oe,message:[String,Function],callback:Function,allowHtml:Boolean,className:Ae,transition:Le("van-dialog-bounce"),messageAlign:String,closeOnPopstate:ce,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:ce,closeOnClickOverlay:Boolean}),Va=[...Ve,"transition","closeOnPopstate"];var Ce=te({name:Aa,props:La,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:r,slots:n}){const u=L(),m=ve({confirm:!1,cancel:!1}),g=d=>r("update:show",d),C=d=>{var v;g(!1),(v=e.callback)==null||v.call(e,d)},b=d=>()=>{e.show&&(r(d),e.beforeClose?(m[d]=!0,We(e.beforeClose,{args:[d],done(){C(d),m[d]=!1},canceled(){m[d]=!1}})):C(d))},f=b("cancel"),T=b("confirm"),O=je(d=>{var v,B;if(d.target!==((B=(v=u.value)==null?void 0:v.popupRef)==null?void 0:B.value))return;({Enter:e.showConfirmButton?T:me,Escape:e.showCancelButton?f:me})[d.key](),r("keydown",d)},["enter","esc"]),P=()=>{const d=n.title?n.title():e.title;if(d)return k("div",{class:R("header",{isolated:!e.message&&!n.default})},[d])},p=d=>{const{message:v,allowHtml:B,messageAlign:E}=e,U=R("message",{"has-title":d,[E]:E}),j=qe(v)?v():v;return B&&typeof j=="string"?k("div",{class:U,innerHTML:j},null):k("div",{class:U},[j])},V=()=>{if(n.default)return k("div",{class:R("content")},[n.default()]);const{title:d,message:v,allowHtml:B}=e;if(v){const E=!!(d||n.title);return k("div",{key:B?1:0,class:R("content",{isolated:!E})},[p(E)])}},h=()=>k("div",{class:[Ke,R("footer")]},[e.showCancelButton&&k(oe,{size:"large",text:e.cancelButtonText||ae("cancel"),class:R("cancel"),style:{color:e.cancelButtonColor},loading:m.cancel,disabled:e.cancelButtonDisabled,onClick:f},null),e.showConfirmButton&&k(oe,{size:"large",text:e.confirmButtonText||ae("confirm"),class:[R("confirm"),{[He]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:m.confirm,disabled:e.confirmButtonDisabled,onClick:T},null)]),W=()=>k(xa,{class:R("footer")},{default:()=>[e.showCancelButton&&k(ke,{type:"warning",text:e.cancelButtonText||ae("cancel"),class:R("cancel"),color:e.cancelButtonColor,loading:m.cancel,disabled:e.cancelButtonDisabled,onClick:f},null),e.showConfirmButton&&k(ke,{type:"danger",text:e.confirmButtonText||ae("confirm"),class:R("confirm"),color:e.confirmButtonColor,loading:m.confirm,disabled:e.confirmButtonDisabled,onClick:T},null)]}),M=()=>n.footer?n.footer():e.theme==="round-button"?W():h();return()=>{const{width:d,title:v,theme:B,message:E,className:U}=e;return k(Me,he({ref:u,role:"dialog",class:[R([B]),U],style:{width:$e(d)},tabindex:0,"aria-labelledby":v||E,onKeydown:O,"onUpdate:show":g},Ue(e,Va)),{default:()=>[P(),V(),M()]})}}});let le;const Ua={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let $a=Y({},Ua);function Ma(){({instance:le}=Ye({setup(){const{state:r,toggle:n}=Je();return()=>k(Ce,he(r,{"onUpdate:show":n}),null)}}))}function ja(e){return ze?new Promise((r,n)=>{le||Ma(),le.open(Y({},$a,e,{callback:u=>{(u==="confirm"?r:n)(u)}}))}):Promise.resolve(void 0)}const qa=e=>ja(Y({showCancelButton:!0},e)),et=ue(Ce),Ha=(e,r,n)=>Ge(e,r,n),Ka=e=>{const r=(e==null?void 0:e.isMobile)??!1,n=L(!1),u=L(),m=L();$(()=>Qe.value.userInfo.orgInfoList??[]);const g=$(()=>{var a;return((a=e.info)==null?void 0:a.appId)??""}),C=$(()=>{var a;return((a=e.info)==null?void 0:a.entryId)??""}),b=$(()=>{var a;return(a=e.info)==null?void 0:a.formData}),f=$(()=>{var a,t;return(a=e.info)!=null&&a.form?((t=JSON.parse(e.info.form))==null?void 0:t.fields)??[]:[]}),T=$(()=>{var o,i,w,y,x;const{hasNext:a}=e,t=[];(o=e.info)!=null&&o.disableSignButton&&t.push(c.sign),a||t.push(c.next),r&&t.push(c.print);const s=((i=e.info)==null?void 0:i.flowNode.type)===_e.StartEvent?e.info.flowActionList:[],l=((y=(w=e.info)==null?void 0:w.buttons)==null?void 0:y.filter(S=>!t.includes(S.type)))??[];return l.length>=1?[...l,...s]:((x=e.info)==null?void 0:x.flowNode.type)===_e.StartEvent?[...((e==null?void 0:e.info.submitSet.btns)??[]).filter(S=>S.selected),...s]:[...l,...s]}),O=async a=>{var t;switch(a.type){case c.pass:await W(a);break;case c.reject:await M(a);break;case c.submit:case c.submit_add:await v(a);break;case c.resubmit:await G();break;case c.save:await d(a);break;case c.transfer:await E(a);break;case c.sign:await U(a);break;case c.back:await B(a);break;case c.revoke:await j(a);break;case c.repeal:await J(a);break;case c.remind:await _(a);break;case c.next:(t=e.nextCallback)==null||t.call(e);break;case c.cancel:e.submitCallback({btn:a});break;case c.reset:e.submitCallback({btn:{...a,afterSubmit:K.reset}});break;case c.print:await N();break;case c.break:await q(a);break;default:F.error("暂不支持该功能")}},P=async()=>{var a;return await((a=u.value)==null?void 0:a.validate())},p=a=>{a||e.submitCallback({btn:{type:c.resubmit,text:"再次发起",afterSubmit:K.close}})},V=async()=>{var o;const a=await((o=u.value)==null?void 0:o.getFormDataPromise()),t=[ia.autoNumber],s=ua(da(f.value,{excludeFilter(i,w){var y,x,S,z;if("defaultValue"in i.options){const Q=(x=(y=i.options)==null?void 0:y.defaultValue)==null?void 0:x.type,H=(z=(S=i.options)==null?void 0:S.defaultValue)==null?void 0:z.formula;if(Q===ma&&H)return!0}return t.includes(i.type)||i.source===fa.system}})).map(i=>i.fieldId);return(a??[]).filter(i=>s.includes(i.fieldId)).reduce((i,w)=>{const y=w.fieldId;return{...i,[y]:w.value}},{})},h=async()=>{var s,l,o,i,w,y,x,S;const a=await((s=u.value)==null?void 0:s.getFormDataPromise());return a?{processInstanceId:((l=e.info)==null?void 0:l.processInstanceId)??"",taskId:((o=e.info)==null?void 0:o.taskId)??"",comment:"",attachment:"",formData:{appId:((i=e.info)==null?void 0:i.appId)??"",entryId:((w=e.info)==null?void 0:w.entryId)??"",formId:((y=e.info)==null?void 0:y.formId)??"",creatorDept:"",save:Ha(a,((x=e.info)==null?void 0:x.entryId)??"",((S=e.info)==null?void 0:S.formData.id)??"")}}:void 0},W=async a=>{var l,o;await((l=u.value)==null?void 0:l.validate());const t=await h();if(!t)return;const s=((o=e.info)==null?void 0:o.flowNode.comment)??{enabled:!1,required:[]};if(s.enabled){const i=s.required.includes(re.agree),w=r?I(()=>import("./ApprovalOpinion-3c9a93e1.js"),["./ApprovalOpinion-3c9a93e1.js","./index-4a9e77d2.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./use-route-c2b2b5be.js","./use-id-d3187131.js","..\\css\\index-6d4f9433.css","./index-c23dfb72.js","./index-30749bf5.js","..\\css\\index-24e8978f.css","..\\css\\index-bc19fac6.css","./AzLink-d3d666fe.js","..\\css\\AzLink-863063be.css","..\\css\\index-00d76fe6.css","./index-ae93b8ef.js","./index-ba3c5d48.js","./enum-7a2ae6a9.js","./useFlowForm-df7c1aa0.js","..\\css\\ApprovalOpinion-ccf881dd.css","..\\css\\index-90a1b522.css","..\\css\\index-a5d1cd41.css","..\\css\\index-af768b88.css"],import.meta.url):I(()=>import("./ApprovalOpinion-8d3f2374.js"),["./ApprovalOpinion-8d3f2374.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./enum-7a2ae6a9.js","..\\css\\ApprovalOpinion-90a0e785.css"],import.meta.url),y=await A(()=>w,{type:c.pass,required:i});t.attachment=y.attachment,t.comment=y.comment}n.value=!0;try{await Xe(t),await e.submitCallback({btn:a})}finally{n.value=!1}},M=async a=>{var l;const t=await h();if(!t)return;const s=((l=e.info)==null?void 0:l.flowNode.comment)??{enabled:!1,required:[]};if(s.enabled){const o=s.required.includes(re.reject),i=r?I(()=>import("./ApprovalOpinion-3c9a93e1.js"),["./ApprovalOpinion-3c9a93e1.js","./index-4a9e77d2.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./use-route-c2b2b5be.js","./use-id-d3187131.js","..\\css\\index-6d4f9433.css","./index-c23dfb72.js","./index-30749bf5.js","..\\css\\index-24e8978f.css","..\\css\\index-bc19fac6.css","./AzLink-d3d666fe.js","..\\css\\AzLink-863063be.css","..\\css\\index-00d76fe6.css","./index-ae93b8ef.js","./index-ba3c5d48.js","./enum-7a2ae6a9.js","./useFlowForm-df7c1aa0.js","..\\css\\ApprovalOpinion-ccf881dd.css","..\\css\\index-90a1b522.css","..\\css\\index-a5d1cd41.css","..\\css\\index-af768b88.css"],import.meta.url):I(()=>import("./ApprovalOpinion-8d3f2374.js"),["./ApprovalOpinion-8d3f2374.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./enum-7a2ae6a9.js","..\\css\\ApprovalOpinion-90a0e785.css"],import.meta.url),w=await A(()=>i,{type:c.reject,required:o});t.attachment=w.attachment,t.comment=w.comment}n.value=!0;try{await Ze(t),await e.submitCallback({btn:a})}finally{n.value=!1}},d=async a=>{const t=await h();t&&(await ea(t),await e.submitCallback({btn:a}))},v=async a=>{var o,i,w,y;await((o=u.value)==null?void 0:o.validate());const t=await h();if(!t)return;const s=await((i=u.value)==null?void 0:i.getFormDataPromise())??[],l=await aa({appId:((w=e.info)==null?void 0:w.appId)??"",entryId:((y=e.info)==null?void 0:y.entryId)??"",formData:s,dataId:""});t.formData&&(t.formData.creatorDept=(l==null?void 0:l.creatorDept)??"",t.formData.flowId=(l==null?void 0:l.flowId)??""),await ta(t),await e.submitCallback({btn:{...a,afterSubmit:K.close}})},B=async a=>{var i,w,y,x,S,z,Q;const t=await h();if(!t)return;const s=((i=e.info)==null?void 0:i.flowNode.comment)??{enabled:!1,required:[]},l=s.required.includes(re.back);let o="";if(r){const H=I(()=>import("./ApprovalOpinion-3c9a93e1.js"),["./ApprovalOpinion-3c9a93e1.js","./index-4a9e77d2.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./use-route-c2b2b5be.js","./use-id-d3187131.js","..\\css\\index-6d4f9433.css","./index-c23dfb72.js","./index-30749bf5.js","..\\css\\index-24e8978f.css","..\\css\\index-bc19fac6.css","./AzLink-d3d666fe.js","..\\css\\AzLink-863063be.css","..\\css\\index-00d76fe6.css","./index-ae93b8ef.js","./index-ba3c5d48.js","./enum-7a2ae6a9.js","./useFlowForm-df7c1aa0.js","..\\css\\ApprovalOpinion-ccf881dd.css","..\\css\\index-90a1b522.css","..\\css\\index-a5d1cd41.css","..\\css\\index-af768b88.css"],import.meta.url),de=await A(()=>H,{type:c.back,required:l});t.comment=de.comment,t.attachment=de.attachment;const Be=I(()=>import("./BackNode-311f9895.js"),["./BackNode-311f9895.js","./index-4a9e77d2.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./use-route-c2b2b5be.js","./use-id-d3187131.js","..\\css\\index-6d4f9433.css","./index-34056eca.js","./index-30749bf5.js","..\\css\\index-24e8978f.css","..\\css\\index-b6ea0dfa.css","./index-d380ed0a.js","..\\css\\index-ef945451.css","./useIncreaseCustomFieldValue-c1159fdb.js","..\\css\\useIncreaseCustomFieldValue-179c0601.css","./AzPopup-b04fec03.js","..\\css\\AzPopup-66217457.css","..\\css\\index-00d76fe6.css","..\\css\\index-af768b88.css","./index-ae93b8ef.js","./index-ba3c5d48.js","./enum-7a2ae6a9.js","./useFlowForm-df7c1aa0.js","..\\css\\BackNode-10e02737.css","..\\css\\index-90a1b522.css","..\\css\\index-a5d1cd41.css"],import.meta.url);o=(await A(()=>Be,{taskId:((w=e.info)==null?void 0:w.taskId)??"",processInstanceId:((y=e.info)==null?void 0:y.processInstanceId)??""})).target}else{const H=await A(()=>I(()=>import("./Back-2fe75f56.js"),["./Back-2fe75f56.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./app.vue_vue_type_script_setup_true_lang-59fd2507.js","./enum-7a2ae6a9.js","./AddOrEditValidate.vue_vue_type_style_index_0_lang-5bd5a73c.js","./Formula.vue_vue_type_style_index_0_lang-ef444f24.js","./index-8e050109.js","..\\css\\Formula-6458579f.css","..\\css\\AddOrEditValidate-f8171a47.css","./utils-a7200637.js","./MessageRemindConfig-98484405.js","./messageTemplate-8658e6b4.js","..\\css\\MessageRemindConfig-e7b111e6.css","..\\css\\el-checkbox-group-987ef89c.css","./index-20639231.js","./FieldConditionView-ad1b057c.js","./index-318b68f4.js","..\\css\\FieldConditionView-994c2635.css","./el-space-0d01b33a.js","..\\css\\el-space-63c9a9a8.css","./ButtonSelectField.vue_vue_type_script_setup_true_lang-aae15f71.js","./cloneDeep-dc1c677b.js","./isTypedArray-10beecc7.js","./SetFieldAuth-3d0b80a0.js","./el-dropdown-item-455a6589.js","..\\css\\el-dropdown-item-ee6896fd.css","..\\css\\SetFieldAuth-c43c9732.css","./el-collapse-transition-4ed993c7.js","./FieldCondition-1c72aa9d.js","./SelectEntryAndOther-76a65b2d.js","..\\css\\SelectEntryAndOther-c49439e9.css","./Base.vue_vue_type_script_setup_true_lang-03820366.js","./useFieldMaxWidth-d82f063e.js","./AddressBase.vue_vue_type_script_setup_true_lang-d809ffc6.js","./AzCascader.vue_vue_type_style_index_0_lang-adc6a4ab.js","..\\css\\AzCascader-6c13ae3b.css","./AzDatePicker.vue_vue_type_style_index_0_lang-c5632a92.js","..\\css\\AzDatePicker-bc99fde3.css","./AzInputNumber-d6212644.js","./el-input-number-c15b1cc7.js","..\\css\\el-input-number-3100e046.css","..\\css\\AzInputNumber-7eb04079.css","./AzTimePicker.vue_vue_type_style_index_0_lang-3726374e.js","..\\css\\AzTimePicker-c7c3a174.css","./useMultipleVal-904406c1.js","./CascaderBase.vue_vue_type_style_index_0_lang-83862970.js","..\\css\\CascaderBase-b08fbeae.css","./CardShowFieldItem-fd24f218.js","..\\css\\CardShowFieldItem-2ebcfade.css","..\\css\\Base-0cce8938.css","..\\css\\FieldCondition-e31264a2.css","./defaultValue-7c7c87ea.js","./keyBy-8fcfdd74.js","./_createAggregator-d66ed64c.js","./InternalComponentSelectPlus-00c8c38f.js","./ComponentParamsSetWrapper-71afc840.js","./default-component-4c80201b.js","./ButtonState-cb54910b.js","..\\css\\ButtonState-a8d21f44.css","./SelectFieldByMultEntry-84abd0c3.js","..\\css\\SelectFieldByMultEntry-5f68cda0.css","./fieldDefaultComponent-58752d9c.js","./Base.vue_vue_type_script_setup_true_lang-4fbdbc85.js","./DaterangeBase.vue_vue_type_script_setup_true_lang-bec97540.js","./InputBase.vue_vue_type_script_setup_true_lang-ffcf63f1.js","./Base-9b7f3306.js","./index-f0ed738f.js","..\\css\\Base-d864bc02.css","./NumberBase.vue_vue_type_script_setup_true_lang-745b39c5.js","./Base-c9aa1df0.js","..\\css\\Base-296ba357.css","..\\css\\el-radio-button-bcf791a1.css","./SliderBase.vue_vue_type_script_setup_true_lang-5d73415b.js","..\\css\\SliderBase-5e1d0cc8.css","./TextareaBase.vue_vue_type_script_setup_true_lang-7091b2cb.js","./TimeBase.vue_vue_type_script_setup_true_lang-ea537bf3.js","./TimerangeBase.vue_vue_type_script_setup_true_lang-0827c241.js","./UploadFileBase.vue_vue_type_script_setup_true_lang-0c253daa.js","./UploadImgBase.vue_vue_type_script_setup_true_lang-d23c1306.js","./CooperateEnterpriseBase.vue_vue_type_script_setup_true_lang-23720971.js","./CooperatePersonnelBase.vue_vue_type_script_setup_true_lang-adcd0db7.js","./Base.vue_vue_type_script_setup_true_lang-0e9a0e2c.js","./Base.vue_vue_type_script_setup_true_lang-aa25657d.js","..\\css\\fieldDefaultComponent-87a40bf5.css","./SelectCascaderEntry.vue_vue_type_script_setup_true_lang-673c5dca.js","./SelectForm.vue_vue_type_script_setup_true_lang-0170236d.js","..\\css\\SelectForm-92279e87.css","..\\css\\ComponentParamsSetWrapper-a498d420.css","..\\css\\InternalComponentSelectPlus-56c2b0f7.css","./useExtractQuery-f96f705c.js","./EditorDraggable-a06dbc71.js","..\\css\\EditorDraggable-dd6eb3a0.css","./typeof-7fd5df1e.js","..\\css\\app-840a98bc.css","..\\css\\Back-433ba347.css"],import.meta.url),{type:c.reject,required:l,enabled:s.enabled,appId:((x=e.info)==null?void 0:x.appId)??"",entryId:((S=e.info)==null?void 0:S.entryId)??"",taskId:((z=e.info)==null?void 0:z.taskId)??"",processInstanceId:((Q=e.info)==null?void 0:Q.processInstanceId)??""});t.comment=H.comment,o=H.target}await na({...t,target:o}),await e.submitCallback({btn:a})},E=async a=>{var i;const t=await h();if(!t)return;const s=((i=e.info)==null?void 0:i.flowNode.candidates)??[],l=r?I(()=>import("./Transfer-77465155.js"),["./Transfer-77465155.js","./index-4a9e77d2.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./use-route-c2b2b5be.js","./use-id-d3187131.js","..\\css\\index-6d4f9433.css","./SelectPane-17fa382a.js","./index-34056eca.js","./index-30749bf5.js","..\\css\\index-24e8978f.css","..\\css\\index-b6ea0dfa.css","./AzPopup-b04fec03.js","..\\css\\AzPopup-66217457.css","..\\css\\index-00d76fe6.css","..\\css\\index-af768b88.css","./useIncreaseCustomFieldValue-c1159fdb.js","..\\css\\useIncreaseCustomFieldValue-179c0601.css","./index-0e679d15.js","..\\css\\index-74a90b35.css","./index-ae93b8ef.js","..\\css\\SelectPane-61f3fc06.css","..\\css\\index-a5d1cd41.css","./index-ba3c5d48.js","./enum-7a2ae6a9.js","./useFlowForm-df7c1aa0.js","..\\css\\index-90a1b522.css"],import.meta.url):I(()=>import("./Transfer-ceae6a7f.js"),["./Transfer-ceae6a7f.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css"],import.meta.url),o=await A(()=>l,{transferScope:s});await ra({...t,comment:o.comment,transferUser:o.transferUser}),await e.submitCallback({btn:a})},U=async a=>{var o,i;const t=await h();if(!t||!((o=e.info)!=null&&o.flowNode))return;const s=r?I(()=>import("./Sign-31d65a82.js"),["./Sign-31d65a82.js","./index-4a9e77d2.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./use-route-c2b2b5be.js","./use-id-d3187131.js","..\\css\\index-6d4f9433.css","./index-34056eca.js","./index-30749bf5.js","..\\css\\index-24e8978f.css","..\\css\\index-b6ea0dfa.css","./index-d380ed0a.js","..\\css\\index-ef945451.css","./SelectPane-17fa382a.js","./AzPopup-b04fec03.js","..\\css\\AzPopup-66217457.css","..\\css\\index-00d76fe6.css","..\\css\\index-af768b88.css","./useIncreaseCustomFieldValue-c1159fdb.js","..\\css\\useIncreaseCustomFieldValue-179c0601.css","./index-0e679d15.js","..\\css\\index-74a90b35.css","./index-ae93b8ef.js","..\\css\\SelectPane-61f3fc06.css","..\\css\\index-a5d1cd41.css","./index-ba3c5d48.js","./enum-7a2ae6a9.js","./useFlowForm-df7c1aa0.js","..\\css\\index-90a1b522.css"],import.meta.url):I(()=>import("./Sign-be9aab3d.js"),["./Sign-be9aab3d.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css"],import.meta.url),l=await A(()=>s,{flowNode:(i=e.info)==null?void 0:i.flowNode,validateForm:P});await sa({...t,...l,attachment:""}),await e.submitCallback({btn:a})},j=async a=>{const t=await h();t&&(await ca(t),await e.submitCallback({btn:a}))},J=async a=>{var o;const t=await h();if(!t)return;const s=r?I(()=>import("./Repeal-9627c21d.js"),["./Repeal-9627c21d.js","./index-4a9e77d2.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./use-route-c2b2b5be.js","./use-id-d3187131.js","..\\css\\index-6d4f9433.css","./enum-7a2ae6a9.js","./index-ae93b8ef.js","./useFlowForm-df7c1aa0.js","..\\css\\index-00d76fe6.css","..\\css\\index-90a1b522.css","..\\css\\index-a5d1cd41.css","..\\css\\index-af768b88.css"],import.meta.url):I(()=>import("./Repeal-b6c86285.js"),["./Repeal-b6c86285.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css"],import.meta.url),l=await A(()=>s,{});await oa({...t,comment:l.comment,flowElementId:((o=e.info)==null?void 0:o.flowNode.nodeId)??""}),await e.submitCallback({btn:a})},_=async a=>{var s;const t=(s=e.info)==null?void 0:s.processInstanceId;t&&(await la(t),await e.submitCallback({btn:a}))},N=async a=>{var t;await((t=m.value)==null?void 0:t.handleClick())},q=async a=>{const t=await h();t&&(r?qa({title:"中止流程",message:"中止后流程结束，确定要中止？"}).then(async()=>{var s;n.value=!0;try{await fe({...t,flowElementId:((s=e.info)==null?void 0:s.flowNode.nodeId)??""}),await e.submitCallback({btn:a})}finally{n.value=!1}}):we.confirm("中止后流程结束，确定要中止？","中止流程",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{var s;await fe({...t,flowElementId:((s=e.info)==null?void 0:s.flowNode.nodeId)??""}),await e.submitCallback({btn:a})}))},G=async a=>{var t,s;if(r){const l=I(()=>import("./ReSubmit-792efc1b.js"),["./ReSubmit-792efc1b.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./index-ae93b8ef.js","./use-route-c2b2b5be.js","./enum-7a2ae6a9.js","./useFlowForm-df7c1aa0.js","..\\css\\ReSubmit-24bc2c0e.css","..\\css\\index-00d76fe6.css","..\\css\\index-90a1b522.css","..\\css\\index-a5d1cd41.css","..\\css\\index-af768b88.css"],import.meta.url);if((await A(()=>l,{transitionDuration:1e3})).action==="copy"){const i=await V();(t=e==null?void 0:e.reSubmitCallback)==null||t.call(e,{formData:{...i}})}else(s=e==null?void 0:e.reSubmitCallback)==null||s.call(e,{})}else we.confirm("是否复制当前数据?可减少部分内容填写","再次发起",{confirmButtonText:"复制",cancelButtonText:"忽略",distinguishCancelAndClose:!0,type:"warning"}).then(async()=>{var o;const l=await V();(o=e==null?void 0:e.reSubmitCallback)==null||o.call(e,{formData:{...l}})}).catch(l=>{var o;l==="cancel"&&((o=e==null?void 0:e.reSubmitCallback)==null||o.call(e,{}))})};return{btns:T,btnCallback:O,handleFormEntrySuccess:p,formRenderRef:u,printRef:m,appId:g,entryId:C,formData:b,loading:n}};function A(e,r){const n=document.createElement("div");document.body.appendChild(n);const u=()=>{n.parentNode&&(be(null,n),document.body.removeChild(n))};return new Promise((m,g)=>{const C=f=>{const T=p=>{u(),m(p)},O=()=>{setTimeout(()=>{u(),g("退出组件")},(r==null?void 0:r.transitionDuration)||300)},P=k(f,{...r,visible:(r==null?void 0:r.visible)??!1,"onUpdate:visible":p=>{P.component.props.visible=p},onSubmit:T,onClose:O});be(P,n),P.component.props.visible=!0},b=f=>{u(),g(new Error(`组件加载失败: ${f instanceof Error?f.message:String(f)}`))};e().then(f=>{if(!(f!=null&&f.default))throw new Error("组件模块错误");C(f.default)}).catch(b)})}const Wa=te({__name:"FlowFormRender",props:{hasNext:{type:Boolean},handleType:{},processInstanceId:{},taskId:{},node:{}},emits:["details","next"],setup(e,{expose:r,emit:n}){const u=e,m=n,g=L(),{loadFlowData:C,flowTaskInfo:b,formDesigner:f,formOptions:T}=pa(),O=async()=>{const{hasNext:_,...N}=u,q=await C(N);q&&m("details",q)},P=async()=>{var _;await((_=B.value)==null?void 0:_.reset())},p=wa("closeDrawer"),V=L(),h=L(!1),W=ve({info:b,hasNext:u.hasNext??!1,submitCallback:async _=>{switch(_.btn.type){case c.pass:case c.reject:F.success("审批成功");break;case c.save:F.success("暂存成功");break;case c.submit:case c.submit_add:F.success("提交成功");break;case c.back:F.success("退回成功");break;case c.transfer:F.success("转交成功");break;case c.sign:F.success("加签成功");break;case c.revoke:F.success("取回重办成功");break;case c.repeal:F.success("撤销成功");break;case c.remind:F.success("催办成功");break;case c.break:F.success("成功中止流程");break}switch(_.btn.afterSubmit){case K.close:p();break;case K.reset:P();break;case K.save_last_submit:break;default:p()}},async reSubmitCallback(_){var N;V.value={renderOptions:{mode:ba.enter,entryId:((N=b.value)==null?void 0:N.entryId)??"",formData:_==null?void 0:_.formData,useDefault:!!(_!=null&&_.formData)}},se(()=>{h.value=!0})},nextCallback(){m("next")}}),{btns:M,handleFormEntrySuccess:d,btnCallback:v,formRenderRef:B,printRef:E,appId:U,entryId:j,formData:J}=Ka(W);return r({reload:()=>{var _;return(_=g.value)==null?void 0:_.reload()}}),(_,N)=>{const q=Ia;return X(),Z(ga,{load:O,ref_key:"LoadingDataRef",ref:g,style:{width:"100%",height:"100%"}},{default:ee(()=>{var G;return[D(b)?(X(),Z(D(_a),{key:0,ref_key:"formRenderRef",ref:B,"form-designer":D(f),options:D(T)},{bottom:ee(()=>[Array.isArray(D(M))&&D(M).length>=1?(X(),Z(ya,{key:0,class:"form-footer-wrap",btns:D(M),num:3,"btn-callback":D(v)},{reference:ee(()=>[k(q,null,{default:ee(()=>[ka("更多")]),_:1})]),_:1},8,["btns","btn-callback"])):ne("",!0)]),_:1},8,["form-designer","options"])):ne("",!0),k(va,{ref_key:"printRef",ref:E,style:{display:"none"},"entry-id":D(j),"app-id":D(U),"data-id":(G=D(J))==null?void 0:G.id,"form-data":D(J)},null,8,["entry-id","app-id","data-id","form-data"]),V.value?(X(),Z(ha,{key:1,modelValue:h.value,"onUpdate:modelValue":N[0]||(N[0]=a=>h.value=a),prop:V.value,onSuccess:D(d)},null,8,["modelValue","prop","onSuccess"])):ne("",!0)]}),_:1},512)}}});const za=Ca(Wa,[["__scopeId","data-v-69238ca2"]]),at=Object.freeze(Object.defineProperty({__proto__:null,default:za},Symbol.toStringTag,{value:"Module"}));export{et as D,at as F};
