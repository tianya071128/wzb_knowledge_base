/* empty css              *//* empty css              *//* empty css              *//* empty css              */import{F as Ze,C as Je}from"./index-4a9e77d2.js";import{lL as de,lT as W,w7 as Ue,w4 as x,xI as Be,lN as q,w9 as Xe,d as L,i,I as j,wa as J,wc as $e,lS as K,xJ as Qe,lK as Te,aT as Ce,lO as fe,wi as De,wj as Oe,wk as Le,lU as re,w8 as Ye,AK as el,c as R,wb as ll,AL as Re,we as al,xx as tl,lM as xe,xy as nl,wh as ol,r as D,du as il,w6 as sl,AM as rl,xw as _e,e as Ie,S as ze,AN as ul,bK as cl,B as C,o8 as H,o as k,b as O,ad as ue,w as $,h as ce,m as be,t as M,cC as Me,f as V,k as T,l as B,_ as pe,wR as dl,xc as oe,xd as fl,wQ as pl,mf as ye,bc as Se,ka as ml,F as Q,g as Y,AO as vl,AP as gl,fx as yl,Z as wl,xk as hl,p as bl,gS as Pe,y as kl,n as ie,Y as Cl,a9 as _l,cR as Il,cS as zl,v as Sl,C as Pl}from"./index-b80d5ef5.js";import{s as Al,a as Vl}from"./index-c23dfb72.js";import"./index-30749bf5.js";import{S as Ae,A as Ne}from"./AzLink-d3d666fe.js";import{B as Fl}from"./index-ae93b8ef.js";import{F as Ul}from"./index-ba3c5d48.js";import{D as Bl}from"./FlowFormRender-c8e3be49.js";import"./use-route-c2b2b5be.js";import"./use-id-d3187131.js";import"./enum-7a2ae6a9.js";import"./useFlowForm-df7c1aa0.js";const[$l,U]=de("action-sheet"),Tl=W({},Ue,{title:String,round:x,actions:Be(),closeIcon:q("cross"),closeable:x,cancelText:String,description:String,closeOnPopstate:x,closeOnClickAction:Boolean,safeAreaInsetBottom:x}),Dl=[...Xe,"round","closeOnPopstate","safeAreaInsetBottom"];var Ol=L({name:$l,props:Tl,emits:["select","cancel","update:show"],setup(e,{slots:a,emit:n}){const u=t=>n("update:show",t),d=()=>{u(!1),n("cancel")},v=()=>{if(e.title)return i("div",{class:U("header")},[e.title,e.closeable&&i(K,{name:e.closeIcon,class:[U("close"),Qe],onClick:d},null)])},m=()=>{if(a.cancel||e.cancelText)return[i("div",{class:U("gap")},null),i("button",{type:"button",class:U("cancel"),onClick:d},[a.cancel?a.cancel():e.cancelText])]},p=t=>{if(t.icon)return i(K,{class:U("item-icon"),name:t.icon},null)},w=(t,r)=>t.loading?i(Te,{class:U("loading-icon")},null):a.action?a.action({action:t,index:r}):[i("span",{class:U("name")},[t.name]),t.subname&&i("div",{class:U("subname")},[t.subname])],_=(t,r)=>{const{color:f,loading:h,callback:A,disabled:F,className:b}=t,y=()=>{F||h||(A&&A(t),e.closeOnClickAction&&u(!1),Ce(()=>n("select",t,r)))};return i("button",{type:"button",style:{color:f},class:[U("item",{loading:h,disabled:F}),b],onClick:y},[p(t),w(t,r)])},o=()=>{if(e.description||a.description){const t=a.description?a.description():e.description;return i("div",{class:U("description")},[t])}};return()=>i($e,j({class:U(),position:"bottom","onUpdate:show":u},J(e,Dl)),{default:()=>{var t;return[v(),o(),i("div",{class:U("content")},[e.actions.map(_),(t=a.default)==null?void 0:t.call(a)]),m()]}})}});const Ll=fe(Ol);let se;const Rl={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,vertical:!1,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,doubleScale:!0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeOnClickOverlay:!0,closeIconPosition:"top-right"};function xl(){({instance:se}=Oe({setup(){const{state:e,toggle:a}=Le(),n=()=>{e.images=[]};return()=>i(Al,j(e,{onClosed:n,"onUpdate:show":a}),null)}}))}const Ml=(e,a=0)=>{if(De)return se||xl(),e=Array.isArray(e)?{images:e,startPosition:a}:e,se.open(W({},Rl,e)),se},[Nl,jl]=de("notify"),El=["lockScroll","position","show","teleport","zIndex"],ql=W({},Ue,{type:q("danger"),color:String,message:re,position:q("top"),className:Ye,background:String,lockScroll:Boolean});var je=L({name:Nl,props:ql,emits:["update:show"],setup(e,{emit:a,slots:n}){const u=d=>a("update:show",d);return()=>i($e,j({class:[jl([e.type]),e.className],style:{color:e.color,background:e.background},overlay:!1,duration:.2,"onUpdate:show":u},J(e,El)),{default:()=>[n.default?n.default():e.message]})}});let Ve,X;const Hl=e=>el(e)?e:{message:e};function Kl(){({instance:X}=Oe({setup(){const{state:e,toggle:a}=Le();return()=>i(je,j(e,{"onUpdate:show":a}),null)}}))}const Wl=()=>({type:"danger",color:void 0,message:"",onClose:void 0,onClick:void 0,onOpened:void 0,duration:3e3,position:void 0,className:"",lockScroll:!1,background:void 0});let Gl=Wl();const Zl=()=>{X&&X.toggle(!1)};function we(e){if(De)return X||Kl(),e=W({},Gl,Hl(e)),X.open(e),clearTimeout(Ve),e.duration>0&&(Ve=setTimeout(Zl,e.duration)),X}fe(je);const[Jl,he]=de("progress"),Xl={color:String,inactive:Boolean,pivotText:String,textColor:String,showPivot:x,pivotColor:String,trackColor:String,strokeWidth:re,percentage:{type:re,default:0,validator:e=>+e>=0&&+e<=100}};var Ql=L({name:Jl,props:Xl,setup(e){const a=R(()=>e.inactive?void 0:e.color),n=()=>{const{textColor:u,pivotText:d,pivotColor:v,percentage:m}=e,p=d??`${m}%`;if(e.showPivot&&p){const w={color:u,left:`${+m}%`,transform:`translate(-${+m}%,-50%)`,background:v||a.value};return i("span",{style:w,class:he("pivot",{inactive:e.inactive})},[p])}};return()=>{const{trackColor:u,percentage:d,strokeWidth:v}=e,m={background:u,height:ll(v)},p={width:`${d}%`,background:a.value};return i("div",{class:he(),style:m},[i("span",{class:he("portion",{inactive:e.inactive}),style:p},null),n()])}}});const Ee=fe(Ql),[Yl,z,ea]=de("uploader");function Fe(e,a){return new Promise(n=>{if(a==="file"){n();return}const u=new FileReader;u.onload=d=>{n(d.target.result)},a==="dataUrl"?u.readAsDataURL(e):a==="text"&&u.readAsText(e)})}function qe(e,a){return Re(e).some(n=>n.file?al(a)?a(n.file):n.file.size>+a:!1)}function la(e,a){const n=[],u=[];return e.forEach(d=>{qe(d,a)?u.push(d):n.push(d)}),{valid:n,invalid:u}}const aa=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|avif)/i,ta=e=>aa.test(e);function He(e){return e.isImage?!0:e.file&&e.file.type?e.file.type.indexOf("image")===0:e.url?ta(e.url):typeof e.content=="string"?e.content.indexOf("data:image")===0:!1}var na=L({props:{name:re,item:tl(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,reupload:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview","reupload"],setup(e,{emit:a,slots:n}){const u=()=>{const{status:o,message:t}=e.item;if(o==="uploading"||o==="failed"){const r=o==="failed"?i(K,{name:"close",class:z("mask-icon")},null):i(Te,{class:z("loading")},null),f=nl(t)&&t!=="";return i("div",{class:z("mask")},[r,f&&i("div",{class:z("mask-message")},[t])])}},d=o=>{const{name:t,item:r,index:f,beforeDelete:h}=e;o.stopPropagation(),ol(h,{args:[r,{name:t,index:f}],done:()=>a("delete")})},v=()=>a("preview"),m=()=>a("reupload"),p=()=>{if(e.deletable&&e.item.status!=="uploading"){const o=n["preview-delete"];return i("div",{role:"button",class:z("preview-delete",{shadow:!o}),tabindex:0,"aria-label":ea("delete"),onClick:d},[o?o():i(K,{name:"cross",class:z("preview-delete-icon")},null)])}},w=()=>{if(n["preview-cover"]){const{index:o,item:t}=e;return i("div",{class:z("preview-cover")},[n["preview-cover"](W({index:o},t))])}},_=()=>{const{item:o,lazyLoad:t,imageFit:r,previewSize:f,reupload:h}=e;return He(o)?i(Vl,{fit:r,src:o.objectUrl||o.content||o.url,class:z("preview-image"),width:Array.isArray(f)?f[0]:f,height:Array.isArray(f)?f[1]:f,lazyLoad:t,onClick:h?m:v},{default:w}):i("div",{class:z("file"),style:xe(e.previewSize)},[i(K,{class:z("file-icon"),name:"description"},null),i("div",{class:[z("file-name"),"van-ellipsis"]},[o.file?o.file.name:o.url]),w()])};return()=>i("div",{class:z("preview")},[_(),u(),p()])}});const oa={name:_e(""),accept:q("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:_e(1/0),imageFit:q("cover"),resultType:q("dataUrl"),uploadIcon:q("photograph"),uploadText:String,deletable:x,reupload:Boolean,afterRead:Function,showUpload:x,modelValue:Be(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:x,previewOptions:Object,previewFullImage:x,maxSize:{type:[Number,String,Function],default:1/0}};var ia=L({name:Yl,props:oa,emits:["delete","oversize","clickUpload","closePreview","clickPreview","clickReupload","update:modelValue"],setup(e,{emit:a,slots:n}){const u=D(),d=[],v=D(-1),m=D(!1),p=(l=e.modelValue.length)=>({name:e.name,index:l}),w=()=>{u.value&&(u.value.value="")},_=l=>{if(w(),qe(l,e.maxSize))if(Array.isArray(l)){const s=la(l,e.maxSize);if(l=s.valid,a("oversize",s.invalid,p()),!l.length)return}else{a("oversize",l,p());return}if(l=cl(l),v.value>-1){const s=[...e.modelValue];s.splice(v.value,1,l),a("update:modelValue",s),v.value=-1}else a("update:modelValue",[...e.modelValue,...Re(l)]);e.afterRead&&e.afterRead(l,p())},o=l=>{const{maxCount:s,modelValue:g,resultType:c}=e;if(Array.isArray(l)){const I=+s-g.length;l.length>I&&(l=l.slice(0,I)),Promise.all(l.map(P=>Fe(P,c))).then(P=>{const E=l.map((le,ae)=>{const te={file:le,status:"",message:"",objectUrl:URL.createObjectURL(le)};return P[ae]&&(te.content=P[ae]),te});_(E)})}else Fe(l,c).then(I=>{const P={file:l,status:"",message:"",objectUrl:URL.createObjectURL(l)};I&&(P.content=I),_(P)})},t=l=>{const{files:s}=l.target;if(e.disabled||!s||!s.length)return;const g=s.length===1?s[0]:[].slice.call(s);if(e.beforeRead){const c=e.beforeRead(g,p());if(!c){w();return}if(ul(c)){c.then(I=>{o(I||g)}).catch(w);return}}o(g)};let r;const f=()=>a("closePreview"),h=l=>{if(e.previewFullImage){const s=e.modelValue.filter(He),g=s.map(c=>(c.objectUrl&&!c.url&&c.status!=="failed"&&(c.url=c.objectUrl,d.push(c.url)),c.url)).filter(Boolean);r=Ml(W({images:g,startPosition:s.indexOf(l),onClose:f},e.previewOptions))}},A=()=>{r&&r.close()},F=(l,s)=>{const g=e.modelValue.slice(0);g.splice(s,1),a("update:modelValue",g),a("delete",l,p(s))},b=l=>{m.value=!0,v.value=l,Ce(()=>N())},y=()=>{m.value||(v.value=-1),m.value=!1},S=(l,s)=>{const g=["imageFit","deletable","reupload","previewSize","beforeDelete"],c=W(J(e,g),J(l,g,!0));return i(na,j({item:l,index:s,onClick:()=>a(e.reupload?"clickReupload":"clickPreview",l,p(s)),onDelete:()=>F(l,s),onPreview:()=>h(l),onReupload:()=>b(s)},J(e,["name","lazyLoad"]),c),J(n,["preview-cover","preview-delete"]))},ee=()=>{if(e.previewImage)return e.modelValue.map(S)},G=l=>a("clickUpload",l),Z=()=>{if(e.modelValue.length>=+e.maxCount&&!e.reupload)return;const l=e.modelValue.length>=+e.maxCount&&e.reupload,s=e.readonly?null:i("input",{ref:u,type:"file",class:z("input"),accept:e.accept,capture:e.capture,multiple:e.multiple&&v.value===-1,disabled:e.disabled,onChange:t,onClick:y},null);return n.default?Ie(i("div",{class:z("input-wrapper"),onClick:G},[n.default(),s]),[[ze,!l]]):Ie(i("div",{class:z("upload",{readonly:e.readonly}),style:xe(e.previewSize),onClick:G},[i(K,{name:e.uploadIcon,class:z("upload-icon")},null),e.uploadText&&i("span",{class:z("upload-text")},[e.uploadText]),s]),[[ze,e.showUpload&&!l]])},N=()=>{u.value&&!e.disabled&&u.value.click()};return il(()=>{d.forEach(l=>URL.revokeObjectURL(l))}),sl({chooseFile:N,closeImagePreview:A}),rl(()=>e.modelValue),()=>i("div",{class:z()},[i("div",{class:z("wrapper",{disabled:e.disabled})},[ee(),Z()])])}});const sa=fe(ia);const ke=L({__name:"BtnConfig",props:{config:{}},setup(e){return(a,n)=>{var d,v,m,p,w,_,o,t,r;const u=Fl;return((d=a.config)==null?void 0:d.style)!==C(H).link?(k(),O(u,j({key:0,type:(v=a.config)==null?void 0:v.type,color:(m=a.config)==null?void 0:m.color,plain:((p=a.config)==null?void 0:p.style)===C(H).plain,round:((w=a.config)==null?void 0:w.style)===C(H).round},a.$attrs),ue({default:$(()=>[ce(a.$slots,"default",{},()=>{var f;return[be(M((f=a.config)==null?void 0:f.name),1)]})]),_:2},[(_=a.config)!=null&&_.icon?{name:"icon",fn:$(()=>[i(Ae,{iconClass:a.config.icon},null,8,["iconClass"])]),key:"0"}:void 0]),1040,["type","color","plain","round"])):(k(),O(Ne,{key:1,type:(o=a.config)==null?void 0:o.type,color:(t=a.config)==null?void 0:t.color},ue({default:$(()=>[ce(a.$slots,"default",{},()=>{var f;return[be(M((f=a.config)==null?void 0:f.name),1)]})]),_:2},[(r=a.config)!=null&&r.icon?{name:"icon",fn:$(()=>[i(Ae,{iconClass:a.config.icon},null,8,["iconClass"])]),key:"0"}:void 0]),1032,["type","color"]))}}});const ra=L({__name:"FileListView",props:{file:{},download:{type:Boolean},readonly:{type:Boolean}},emits:["deleteFile","handleDowload"],setup(e,{emit:a}){const n=e,u=a,d=D(0),v=R(()=>n.file.status&&n.file.status!=="success");let m=null;const p=()=>{if(d.value>=100||!v.value){d.value=100;return}d.value=Math.floor((100-d.value)/4*Math.random()+d.value),m=setTimeout(()=>{p()},40)};p(),Me(()=>{clearTimeout(m)});const w=()=>{n.file.uid&&u("deleteFile",n.file.uid)},_=()=>{n.file.uid&&u("handleDowload",n.file.uid)};return(o,t)=>{var h;const r=K,f=Ee;return k(),V("div",null,[T("ul",{class:"az-uploader-filelist"},[T("li",{class:"az-uploader-fileitem mt-5 mb-5"},[i(r,{name:"description-o"}),T("div",{class:"az-uploader-filename van-ellipsis"},M((h=o.file.file)==null?void 0:h.name),1),o.download?(k(),O(r,{key:0,name:"back-top",class:"mr-10",size:20,color:"#1989fa",onClick:_})):B("",!0),o.readonly?B("",!0):(k(),O(r,{key:1,name:"delete-o",size:20,color:"#ee0a24",class:"mr-10",onClick:w}))]),i(f,{class:"mt-10",percentage:d.value,"show-pivot":!1,isProgress:""},null,8,["percentage"])])])}}});const ua=pe(ra,[["__scopeId","data-v-83008b3d"]]);const ca=L({__name:"ImgListView",props:{file:{},download:{type:Boolean},readonly:{type:Boolean},otherOperate:{},fileIndex:{}},emits:["deleteFile","handleDowload","imgPreview"],setup(e,{emit:a}){const n=e,u=a,d=R(()=>dl(n.file)),v=y=>y<1024*1024?`${Math.floor(y/1024*100)/100}KB`:`${Math.floor(y/1024/1024*100)/100}MB`,m=R(()=>n.file.status&&n.file.status!=="success");let p=null;const w=D(0),_=()=>{if(w.value>=100||!m.value){w.value=100;return}p=setTimeout(()=>{w.value=n.file.progress??Math.floor((100-w.value)/4*Math.random()+w.value),_()},40)};_(),Me(()=>{clearTimeout(p)});const o=R(()=>!!(n.file.uid&&!([oe.txt,oe.ofd,oe.doc,oe.docx].includes(fl(n.file))&&!n.file.response))),t=()=>{n.file.uid&&u("deleteFile",n.file.uid)},r=()=>{o.value&&n.file.uid&&u("imgPreview",n.file.uid)},f=()=>{n.file.uid&&u("handleDowload",n.file.uid)},h=R(()=>{var y;return n.file.status&&n.file.status!=="success"?[]:((y=n.otherOperate)==null?void 0:y.filter(S=>!S.accept||pl({name:n.file.name,accept:S.accept})))??[]}),A=R(()=>{const y=[...h.value];return n.download&&y.push({id:"__download__",btnConfig:h.value.length?{style:H.link,name:"下载",type:ye.primary}:{style:H.link,icon:"Download"},onClick:f}),n.readonly||y.push({id:"__delete__",btnConfig:h.value.length?{style:H.link,type:ye.danger,name:"删除"}:{style:H.link,type:ye.danger,icon:"Delete"},onClick:t}),[...y]}),F=D(!1),b=y=>{var S;(S=y.onClick)==null||S.call(y,n.file,{index:n.fileIndex}),F.value=!1};return(y,S)=>{var Z,N,l,s;const ee=Ll,G=Ee;return k(),V("ul",{class:"az-uploader-filelist"},[T("li",{class:"az-uploader-fileitem mb-5 an-ellipsis"},[T("div",{class:"az-uploader-filitem-content"},[T("div",{class:"az-uploader-fileitem-left mr-10"},[T("img",{src:d.value,alt:(Z=y.file.file)==null?void 0:Z.name,class:"imgBox",onClick:Se(r,["stop"])},null,8,["src","alt","onClick"])]),T("div",{class:"az-uploader-fileitem-right van-ellipsis"},[T("div",{class:"van-ellipsis file_name",onClick:Se(r,["stop"])},M(((N=y.file.file)==null?void 0:N.name)||y.file.name),9,["onClick"]),C(ml)(((l=y.file.file)==null?void 0:l.size)||y.file.size)?(k(),V("div",{key:0,class:"file_size"},M(v(Number(((s=y.file.file)==null?void 0:s.size)||y.file.size))),1)):B("",!0)]),T("div",{class:"az-uploader-opertor"},[(k(!0),V(Q,null,Y(h.value.length?A.value.slice(0,1):A.value,(g,c)=>(k(),V("span",{key:c},[i(ke,{preview:"",config:g.btnConfig,onClick:I=>{var P;return(P=g.onClick)==null?void 0:P.call(g,y.file,{index:y.fileIndex})}},null,8,["config","onClick"])]))),128)),h.value.length&&A.value.length>1?(k(),O(Ne,{key:0,type:"primary",onClick:S[0]||(S[0]=g=>F.value=!0)},{default:$(()=>[be(" ... ")]),_:1})):B("",!0),i(ee,{show:F.value,"onUpdate:show":S[1]||(S[1]=g=>F.value=g),"cancel-text":"取消","close-on-click-action":"",teleport:"body"},{default:$(()=>[(k(!0),V(Q,null,Y(A.value.slice(1),(g,c)=>(k(),V("div",{class:"az-sheet-item az-bg-feedback",key:c,onClick:I=>b(g)},[i(ke,{preview:"",config:g.btnConfig},null,8,["config"])],8,["onClick"]))),128))]),_:1},8,["show"])])]),m.value?(k(),O(G,{key:0,class:"mt-10",percentage:w.value},null,8,["percentage"])):B("",!0)])])}}});const da=pe(ca,[["__scopeId","data-v-b69bf51f"]]),fa=L({__name:"AzUploader",props:{modelValue:{},accept:{},limit:{default:3},size:{default:500},sizeText:{},uploadApi:{},prefixUrl:{},urlLoader:{},imgWidth:{default:"150px"},hideAcceptTip:{type:Boolean},type:{default:"img"},fileInfoMap:{},readonly:{type:Boolean,default:!1},download:{type:Boolean},listType:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},hideDelete:{type:Boolean,default:!1},isShowTrigger:{type:Boolean,default:!0},isShowTip:{type:Boolean,default:!0},showLimitTip:{type:Boolean,default:!1},showSizeTip:{type:Boolean,default:!0},otherOperate:{},btnConfig:{default(){return vl}}},emits:["update:modelValue","uploadFinish","delete"],setup(e,{expose:a,emit:n}){const u=e,d=n,{fileList:v,multiple:m,limit:p,handleDownload:w,handlerDelete:_,handlePreview:o,sizeText:t,uploadApi:r,checkAccept:f,acceptText:h,normlModelValue:A,getFileIndex:F}=gl(u,d),b=R({get(){return v.value.map(l=>{const s={...l,status:l.status==="fail"?"failed":l.status==="success"?"done":l.status==="ready"?"uploading":void 0};return u.type==="img"&&(s.isImage=!0),s})},set(l){v.value=l.map(s=>({...yl(s,["isImage"]),status:s.status==="failed"?"fail":s.status==="done"?"success":s.status==="uploading"||!s.url?"ready":void 0,uid:s.uid??wl()}))}}),y=async l=>{const s=c=>b.value.findIndex(I=>I.file===c.file),g=c=>{const I=s(c);if(I<0)return;const P=[...b.value];P.splice(I,1),b.value=[...P]};for(const c of Pe(l))Ce(()=>{var I,P;if(c.file){const E=s(c);if(E<0)return;const{name:le,size:ae,type:te}=c.file,ne=[...b.value];ne[E]={url:(I=ne[E])==null?void 0:I.objectUrl,...ne[E],name:le,size:ae,type:te},b.value=[...ne],r(c.file,{uid:(P=b.value[E])==null?void 0:P.uid}).then(me=>{if(me){const ve=s(c);if(ve<0)return;const{name:Ke,size:We,type:Ge}=c.file,ge=[...b.value];ge[ve]={...ge[ve],name:Ke,size:We,type:Ge,url:me,response:me,status:"done",message:"上传成功"},b.value=[...ge]}else g(c)}).catch(()=>g(c))}})},S=navigator.userAgent,G=(S.indexOf("Android")>-1||S.indexOf("Linux")>-1)&&S.match(/MMWEBSDK\/200502/i)&&S.match(/XWEB\/2353/i),Z=l=>{const s=Pe(l);if(b.value.length+s.length>p.value)return we({message:`文件数量超出限制,最多上传${p.value}个文件`,type:"warning"}),!1;for(const g of s){if(u.size<g.size/1024)return we({message:`文件上传异常,上传文件大于${t.value},请重新上传`,type:"warning"}),!1;if(!f(g))return we({message:`文件类型异常,请上传文件类型为 ${h.value} 的文件`,type:"warning"}),!1}return!0},N=D();return a({uploadFile(){var l;if(b.value.length>=p.value)return hl({message:`最多上传${p.value}个文件`,type:"fail"}),!1;(l=N.value)==null||l.$el.querySelector("input").click()}}),(l,s)=>{const g=sa;return k(),V(Q,null,[i(g,j({ref_key:"uploadRef",ref:N},l.$attrs,{modelValue:b.value,"onUpdate:modelValue":s[0]||(s[0]=c=>b.value=c),"after-read":y,"before-read":Z,multiple:C(m),disabled:l.disabled,readonly:l.readonly,deletable:!l.readonly,"show-upload":!l.readonly,capture:C(G)?"camera":void 0,accept:l.type==="img"?"image/*":"*",class:`az-uploader-${l.type} az-uploader-${l.listType}`}),ue({_:2},[l.type=="file"||l.type=="img"&&l.listType?{name:"default",fn:$(()=>[l.isShowTrigger?(k(),O(ke,{key:0,class:bl({"is-readonly":l.readonly}),config:l.btnConfig,size:"small",preview:""},null,8,["class","config"])):B("",!0)]),key:"0"}:void 0]),1040,["modelValue","multiple","disabled","readonly","deletable","show-upload","capture","accept","class"]),l.isShowTip&&!l.readonly?(k(),V("div",{key:0},[ce(l.$slots,"tip",{},()=>[T("div",{class:"az-uploader-tips mt-5"},[u.accept&&C(h)&&!l.hideAcceptTip?(k(),V("div",{key:0}," 文件格式："+M(C(h)),1)):B("",!0),l.showSizeTip?(k(),V("div",{key:1},"文件大小限制：不大于 "+M(C(t)),1)):B("",!0),l.showLimitTip&&C(p)!==1/0?(k(),V("div",{key:2}," 文件数："+M(C(A).length)+"/"+M(C(p)),1)):B("",!0)])],!0)])):B("",!0),l.type=="file"&&!l.listType?(k(!0),V(Q,{key:1},Y(C(v),(c,I)=>(k(),O(ua,{key:I,sizeText:C(t),fileList:b.value,file:c,download:l.download,readonly:l.readonly,onHandleDowload:C(w),onDeleteFile:C(_)},null,8,["sizeText","fileList","file","download","readonly","onHandleDowload","onDeleteFile"]))),128)):B("",!0),l.listType?(k(!0),V(Q,{key:2},Y(C(v),(c,I)=>(k(),O(da,{key:I,file:c,download:l.download,readonly:l.readonly,onHandleDowload:C(w),onImgPreview:C(o),onDeleteFile:C(_),otherOperate:l.otherOperate,fileIndex:C(F)(c==null?void 0:c.uid)},null,8,["file","download","readonly","onHandleDowload","onImgPreview","onDeleteFile","otherOperate","fileIndex"]))),128)):B("",!0)],64)}}});const pa=pe(fa,[["__scopeId","data-v-e2436c2a"]]),ma=L({__name:"AzUploaderWrapper",props:{modelValue:{},limit:{default:1}},emits:["update:modelValue"],setup(e,{expose:a,emit:n}){const u=e,d=n,v=R(()=>u.limit>1),m=new Map;kl(()=>ie(Cl(u.modelValue)),o=>{for(const t of o)m.set(t.url??t.response,t)},{immediate:!0});const p=R({get(){var t,r;const o=ie(u.modelValue);return v.value?o.map(f=>f.url??f.response??""):((t=o[0])==null?void 0:t.url)??((r=o[0])==null?void 0:r.response)??""},set(o){const r=ie(o).filter(f=>m.has(f)).map(f=>m.get(f));_l(r,ie(u.modelValue))||d("update:modelValue",v.value?r:r[0]??void 0)}}),w=(o,t)=>{m.set(t.url??t.id,{response:t.id,url:t.url??t.id,name:o.name,type:o.type||null,size:o.size})},_=D();return a({uploadFile(){var o;return(o=_.value)==null?void 0:o.uploadFile()}}),(o,t)=>(k(),O(pa,j({ref_key:"AzUploadRef",ref:_,modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=r=>p.value=r),limit:o.limit,onUploadFinish:w,fileInfoMap:C(m)},o.$attrs),ue({_:2},[Y(o.$slots,(r,f,h)=>({name:f,fn:$(A=>[ce(o.$slots,f,Il(zl(A)))])}))]),1040,["modelValue","limit","fileInfoMap"]))}}),va=L({__name:"ApprovalOpinion",props:{visible:{type:Boolean},required:{type:Boolean},type:{}},emits:["update:visible","submit"],setup(e,{emit:a}){const n=e,u=a,d=Sl(n,"visible",u),v=D(),m=D([]),p=D(""),w=async()=>{var t;p.value,n.required&&await((t=v.value)==null?void 0:t.validate()),u("submit",{comment:p.value,attachment:m.value.length>=1?JSON.stringify(m.value):""})},_=t=>new Promise(r=>{var h;const f=n.required;t==="confirm"&&f?(h=v.value)==null||h.validate().then(()=>{r(!0)}).catch(()=>{r(!1)}):r(!0)}),o={name:"上传附件",type:"primary",icon:"Upload"};return(t,r)=>{const f=Ze,h=Je,A=Ul,F=Bl;return k(),O(F,{show:C(d),"onUpdate:show":r[2]||(r[2]=b=>Pl(d)?d.value=b:null),title:"审批意见","show-cancel-button":"",onConfirm:w,beforeClose:_,teleport:"body"},{default:$(()=>[i(A,{ref_key:"vanFormRef",ref:v,class:"van-form__wrapper"},{default:$(()=>[i(h,{inset:""},{default:$(()=>[i(f,{modelValue:p.value,"onUpdate:modelValue":r[0]||(r[0]=b=>p.value=b),name:"text",required:t.required,rules:[{required:!0,message:"请输入审批意见",trigger:["blur","change"]},{pattern:/^.{2,2000}$/s,message:"长度应为2-2000之间",trigger:["blur","change"]}],autosize:{maxHeight:300,minHeight:60},label:"审批意见",type:"textarea",maxlength:"2000",placeholder:"请填写审批意见","show-word-limit":""},null,8,["modelValue","required","rules"])]),_:1}),i(h,{inset:""},{default:$(()=>[i(ma,{modelValue:m.value,"onUpdate:modelValue":r[1]||(r[1]=b=>m.value=b),limit:10,type:"file",size:1024*10,listType:"",btnConfig:o},null,8,["modelValue"])]),_:1})]),_:1},512)]),_:1},8,["show"])}}});const Ba=pe(va,[["__scopeId","data-v-7b083653"]]);export{Ba as default};
