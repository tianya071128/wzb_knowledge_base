import{d8 as l,d as S,v as E,c as Y,o as h,f as $,k as f,h as U,i as u,B as d,w as o,m as p,a4 as K,Q as j,q as F,av as D,_ as I,bx as z,b as w,F as B,g as H,a5 as Q,P as G,bC as J,r as T,bK as O,y as W,bH as X,bu as Z,l as k,t as ee,C as ae,pa as te,aN as le,ac as se,bm as ue,bn as oe}from"./index-b80d5ef5.js";import{A as N}from"./AzPasswordFormItem-db212711.js";var re=(a=>(a[a.on=0]="on",a[a.off=1]="off",a))(re||{});const fe=a=>l.value.request.post(`${l.value.SYSTEMURL}/core/pluginmyself/mylistPage`,a),_e=a=>l.value.request.post(`${l.value.SYSTEMURL}/core/pluginmarket/listPage`,a),ge=a=>l.value.request.get(`${l.value.SYSTEMURL}/core/pluginmarket/getInstallById/`+a),ye=a=>l.value.request.post(`${l.value.SYSTEMURL}/core/plugintype/list`,a),he=a=>l.value.request.post(`${l.value.SYSTEMURL}/core/pluginmarket/appInstall`,a),be=a=>l.value.request.delete(`${l.value.SYSTEMURL}/core/pluginmyself/delete/${a}`),Pe=a=>l.value.request.delete(`${l.value.SYSTEMURL}/core/pluginmyself/deleteApi/${a}`),Ae=a=>l.value.request.post(`${l.value.SYSTEMURL}/core/pluginmyself/updateStatus/${a}`),ne=a=>l.value.request.post(`${l.value.SYSTEMURL}/core/pluginmyself/updateAuth`,a),Ve=a=>l.value.request.get(`${l.value.SYSTEMURL}/core/pluginmyself/getMyById/${a}`),Me=a=>l.value.request.post(`${l.value.SYSTEMURL}/core/pluginmyself/myselfApilist`,a),Le=a=>l.value.request.post(`${l.value.SYSTEMURL}/core/pluginmyself/updateApiStatus/${a}`),de=S({__name:"AuthParamItem",props:{modelValue:{}},emits:["update:modelValue","delete"],setup(a,{emit:L}){const V=a,_=L,e=E(V,"modelValue",_),s=Y(()=>e.value.cryptoFlag?"password":"text");return(c,n)=>{const b=j,m=F,r=D;return h(),$("div",{class:"params-list"},[f("div",{class:"name"},[U(c.$slots,"name",{},()=>[u(b,{type:s.value,modelValue:d(e).name,"onUpdate:modelValue":n[0]||(n[0]=t=>d(e).name=t),placeholder:"请输入,例如账号"},null,8,["type","modelValue"])],!0)]),f("div",{class:"param"},[U(c.$slots,"param",{},()=>[u(b,{type:s.value,modelValue:d(e).paramName,"onUpdate:modelValue":n[1]||(n[1]=t=>d(e).paramName=t),placeholder:"请输入,例如userName"},null,8,["type","modelValue"])],!0)]),f("div",{class:"value"},[U(c.$slots,"value",{},()=>[u(b,{type:s.value,modelValue:d(e).paramValue,"onUpdate:modelValue":n[2]||(n[2]=t=>d(e).paramValue=t),placeholder:"请输入参数值"},null,8,["type","modelValue"])],!0)]),f("div",{class:"psw"},[U(c.$slots,"psw",{},()=>[u(m,{modelValue:d(e).cryptoFlag,"onUpdate:modelValue":n[3]||(n[3]=t=>d(e).cryptoFlag=t)},{default:o(()=>[p("  ")]),_:1},8,["modelValue"])],!0)]),f("div",{class:"delete"},[U(c.$slots,"delete",{},()=>[u(r,{onClick:n[4]||(n[4]=t=>_("delete")),underline:!1,icon:d(K),type:"danger"},null,8,["icon"])],!0)])])}}});const x=I(de,[["__scopeId","data-v-ce1d3b84"]]),ie=S({__name:"AuthParamList",props:{paramList:{}},emits:["update:paramList"],setup(a,{emit:L}){const V=a,_=L,e={cryptoFlag:!1,name:"",paramName:"",paramValue:""},s=E(V,"paramList",_);z(()=>{s.value.length<=0&&s.value.push({...e})});const c=Y({get(){return s.value.length<=0?!1:s.value.every(m=>m.cryptoFlag)},set(m){const r=s.value.length;for(let t=0;t<r;t++)s.value[t].cryptoFlag=m}}),n=()=>{s.value.push({...e})},b=m=>{s.value.splice(m,1)};return(m,r)=>{const t=F,g=G,P=D,M=J;return h(),w(M,{class:"params-card","body-style":{padding:"10px"}},{default:o(()=>[u(x,{"model-value":e},{name:o(()=>[p("名称")]),param:o(()=>[p("参数名称")]),value:o(()=>[p("参数值")]),psw:o(()=>[f("div",{class:"encryption"},[u(t,{modelValue:c.value,"onUpdate:modelValue":r[0]||(r[0]=A=>c.value=A)},{default:o(()=>[p("加密显示")]),_:1},8,["modelValue"])])]),delete:o(()=>[p(" ")]),_:1}),(h(!0),$(B,null,H(d(s),(A,i)=>(h(),w(x,{key:i,modelValue:d(s)[i],"onUpdate:modelValue":y=>d(s)[i]=y,onDelete:y=>b(i)},null,8,["modelValue","onUpdate:modelValue","onDelete"]))),128)),u(P,{onClick:n,type:"primary",class:"params-card__add",underline:!1},{default:o(()=>[u(g,null,{default:o(()=>[u(d(Q))]),_:1}),p(" 添加参数 ")]),_:1})]),_:1})}}});const pe=I(ie,[["__scopeId","data-v-5d1bf3bc"]]),me=S({__name:"EditAuthInfo",props:{data:{},visible:{type:Boolean},isPluginMarket:{}},emits:["update:visible","refresh"],setup(a,{emit:L}){const V=L,_=a,e=T(),s=E(_,"visible",V),c=O({"basicAuthParam.userName":[{required:!0,message:"请输入账号",trigger:"blur"}],"basicAuthParam.password":[{required:!0,message:"请输入密码",trigger:"blur"}]}),n=T(),b=async()=>{var r,t,g,P,M,A,i,y;return e.value?(_.isPluginMarket?await ne({applicationId:(r=e.value)==null?void 0:r.id,authMethod:(t=e.value)==null?void 0:t.authMethod,basicAuthParam:(g=e.value)==null?void 0:g.basicAuthParam,apiKeyAuthParamList:(P=e.value)==null?void 0:P.apiKeyAuthParamList}):await te.updateAuth({id:(M=e.value)==null?void 0:M.id,authMethod:(A=e.value)==null?void 0:A.authMethod,basicAuthParam:(i=e.value)==null?void 0:i.basicAuthParam,apiKeyAuthParamList:(y=e.value)==null?void 0:y.apiKeyAuthParamList}),m(),le({type:"success",message:"修改成功"}),Promise.resolve(!0)):Promise.reject()},m=()=>{V("refresh")};return W(()=>s.value,r=>{r&&(e.value=X(_.data))}),(r,t)=>{const g=se,P=F,M=ue,A=oe;return h(),$("div",null,[u(A,{modelValue:d(s),"onUpdate:modelValue":t[6]||(t[6]=i=>ae(s)?s.value=i:null),width:"800px",title:"编辑鉴权信息"},{footer:o(()=>[u(Z,{editMode:!0,onClose:t[5]||(t[5]=i=>s.value=!1),"on-submit":b})]),default:o(()=>{var i,y,C;return[u(M,{ref_key:"ruleFormRef",ref:n,model:e.value,rules:c,"label-suffix":":","label-width":"80px"},{default:o(()=>{var q,R;return[u(g,{label:"认证方式"},{default:o(()=>[p("API Key认证")]),_:1}),((q=e.value)==null?void 0:q.authMethod)===1?(h(),w(pe,{key:0,"param-list":e.value.apiKeyAuthParamList,"onUpdate:paramList":t[0]||(t[0]=v=>e.value.apiKeyAuthParamList=v)},null,8,["param-list"])):k("",!0),((R=e.value)==null?void 0:R.authMethod)===2?(h(),$(B,{key:1},[u(g,{label:"账号",prop:"basicAuthParam.userName"},{default:o(()=>[f("div",{class:"flex-center f-item"},[u(N,{modelValue:e.value.basicAuthParam.userName,"onUpdate:modelValue":t[1]||(t[1]=v=>e.value.basicAuthParam.userName=v),placeholder:"请输入账号","show-password":e.value.basicAuthParam.nameCryptoFlag},null,8,["modelValue","show-password"]),u(P,{modelValue:e.value.basicAuthParam.nameCryptoFlag,"onUpdate:modelValue":t[2]||(t[2]=v=>e.value.basicAuthParam.nameCryptoFlag=v)},{default:o(()=>[p(" 加密显示 ")]),_:1},8,["modelValue"])])]),_:1}),u(g,{label:"密码",prop:"basicAuthParam.password"},{default:o(()=>[f("div",{class:"flex-center f-item"},[u(N,{modelValue:e.value.basicAuthParam.password,"onUpdate:modelValue":t[3]||(t[3]=v=>e.value.basicAuthParam.password=v),placeholder:"请输入密码","show-password":e.value.basicAuthParam.pwdCryptoFlag},null,8,["modelValue","show-password"]),u(P,{modelValue:e.value.basicAuthParam.pwdCryptoFlag,"onUpdate:modelValue":t[4]||(t[4]=v=>e.value.basicAuthParam.pwdCryptoFlag=v)},{default:o(()=>[p(" 加密显示 ")]),_:1},8,["modelValue"])])]),_:1})],64)):k("",!0)]}),_:1},8,["model","rules"]),(i=r.data)!=null&&i.authUrl?(h(),$("div",{key:0,style:{"text-align":"center"}},[p(" 无鉴权账号？您可访问 "),f("a",{href:(y=r.data)==null?void 0:y.authUrl,target:"_blank"},ee((C=r.data)==null?void 0:C.authUrl),9,["href"]),p(" 申请账号后填入此处 ")])):k("",!0)]}),_:1},8,["modelValue"])])}}});const Ue=I(me,[["__scopeId","data-v-f50dec70"]]);export{pe as A,Ue as E,fe as M,_e as P,be as a,ye as b,Ae as c,Pe as d,he as e,Le as f,Ve as g,ge as h,Me as m,re as p};
