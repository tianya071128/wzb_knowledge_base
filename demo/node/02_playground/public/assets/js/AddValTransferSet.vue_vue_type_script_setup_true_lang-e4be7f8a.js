import{d as b,v as y,r as V,y as T,Y as B,o as g,b as k,w as i,k as I,i as n,m as D,I as S,B as C,C as E,a as h,aN as w,U as _,bn as A,hP as N,c as F,gY as U,mv as R,eR as $,Aw as M,f as P,t as Y,l as L,F as O}from"./index-b80d5ef5.js";import{S as W}from"./SetFieldDefault-5fc1ae2a.js";import{B as j}from"./ButtonState-cb54910b.js";import{E as q}from"./routePage-70460a50.js";const z=b({__name:"SetFieldDefaultDialog",props:{modelValue:{type:Boolean},prop:{},fieldDefault:{}},emits:["update:modelValue","update:fieldDefault"],setup(c,{emit:d}){const u=c,f=d,t=y(u,"modelValue",f),r=y(u,"fieldDefault",f),o=V([]),p=V(),v=async()=>{var l;if(await((l=p.value)==null?void 0:l.validate()),o.value.some(e=>{var a;return e.fieldType===h.subform&&!((a=e.child)!=null&&a.length)}))return w.error("子表单控件类型需设置子控件填充！");r.value=o.value,t.value=!1};return T(t,()=>{t.value&&(o.value=B(r.value)??[])},{immediate:!0}),(l,e)=>{const a=_,m=A;return g(),k(m,{modelValue:C(t),"onUpdate:modelValue":e[2]||(e[2]=s=>E(t)?t.value=s:null),title:"数据填充设置",width:"700","destroy-on-close":"","close-on-click-modal":!1,"append-to-body":""},{footer:i(()=>[I("span",{class:"dialog-footer"},[n(a,{onClick:e[1]||(e[1]=s=>t.value=!1)},{default:i(()=>[D("取消")]),_:1}),n(a,{type:"primary",onClick:v},{default:i(()=>[D("确定")]),_:1})])]),default:i(()=>[n(W,S({ref_key:"setFieldDefaultRef",ref:p,modelValue:o.value,"onUpdate:modelValue":e[0]||(e[0]=s=>o.value=s)},l.prop),null,16,["modelValue"])]),_:1},8,["modelValue"])}}}),Q=b({__name:"AddValTransferSet",props:{field:{}},setup(c){const d=c,{checkCurrentAppForm:u}=N(),f=F(()=>u(d.field.options.sourceId)),t=U(),r=V(!1),o=()=>{r.value=!0},p=R().map(l=>{const e={...l};return e.value===$.currentField&&(e.label="当前表单字段值"),e}),v=F(()=>M(t.form.fields,{currentFieldId:d.field.fieldId}));return T(()=>d.field.options.sourceId,()=>d.field.options.addValTransfer=[]),(l,e)=>(g(),P(O,null,[f.value&&l.field.options.add?(g(),k(q,{key:0,label:"新增数据设置",id:`${l.field.fieldId}.addValTransfer`},{default:i(({error:a})=>{var m;return[n(j,{"is-error":!!a,"is-set":!!((m=l.field.options.addValTransfer)!=null&&m.length),disabled:!l.field.options.sourceId,onClick:o},{default:i(()=>{var s;return[D(Y((s=l.field.options.addValTransfer)!=null&&s.length?"已设置新增数据设置":"新增数据设置"),1)]}),_:2},1032,["is-error","is-set","disabled"])]}),_:1},8,["id"])):L("",!0),n(z,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),"field-default":l.field.options.addValTransfer,"onUpdate:fieldDefault":e[1]||(e[1]=a=>l.field.options.addValTransfer=a),title:"新增数据设置",prop:{leftSourceId:l.field.options.sourceId,btnText:"选择关联数据集的控件",customTypeList:C(p),rightFields:v.value,isSubform:!0}},null,8,["modelValue","field-default","prop"])],64))}});export{Q as _};
