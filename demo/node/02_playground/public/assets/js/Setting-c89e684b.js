import{d as O,r as k,y as Z,x as G,o as p,b,w as a,i as o,j as le,L as oe,a$ as te,v as ie,f as T,F,g as N,B as g,C as ae,bt as de,a6 as se,ao as J,Y as L,bv as ne,a5 as re,m as E,k as I,qy as P,l as A,T as pe,gK as me,aN as W,Z as Q,U as X,av as ue,gT as fe,eB as ce,bC as ge,_ as x,gY as ve,c as j,bZ as ye,AC as he,oA as _e,b$ as Ve,AD as be,h5 as H,ia as Ie,aq as ke,bz as Ce,c2 as Re,t as we,ib as Se,dW as De,hR as $e,i2 as Ee,e as Te,S as Ue,nh as Ae,aO as Fe,a as q,mM as Me,ap as ze,bn as Be,q as Le}from"./index-b80d5ef5.js";import{E as Ne}from"./EditorDraggable-a06dbc71.js";import{_ as Oe}from"./ButtonSelectField.vue_vue_type_script_setup_true_lang-aae15f71.js";import{_ as je}from"./index.vue_vue_type_script_setup_true_lang-2e692a6b.js";import{A as K,E as z,a as He}from"./routePage-70460a50.js";import{_ as Pe}from"./FormFieldHeaderEditor.vue_vue_type_script_setup_true_lang-6c993e5c.js";import{c as We}from"./Base-16c93ea0.js";import{a as Y,s as qe}from"./Base.vue_vue_type_script_setup_true_lang-832ddae3.js";import{_ as Ke}from"./SubformPulicOpt.vue_vue_type_script_setup_true_lang-491ac15d.js";import{B as Ye}from"./ButtonState-cb54910b.js";import{F as Ze}from"./FieldCondition-1c72aa9d.js";import{F as Ge}from"./FieldConditionView-ad1b057c.js";import"./FormulaWrapper-92a83208.js";import"./Formula.vue_vue_type_style_index_0_lang-ef444f24.js";import"./index-8e050109.js";import"./fieldDefaultComponent-58752d9c.js";import"./AddressBase.vue_vue_type_script_setup_true_lang-d809ffc6.js";import"./AzCascader.vue_vue_type_style_index_0_lang-adc6a4ab.js";import"./useFieldMaxWidth-d82f063e.js";import"./Base.vue_vue_type_script_setup_true_lang-4fbdbc85.js";import"./AzDatePicker.vue_vue_type_style_index_0_lang-c5632a92.js";import"./index-318b68f4.js";import"./DaterangeBase.vue_vue_type_script_setup_true_lang-bec97540.js";import"./InputBase.vue_vue_type_script_setup_true_lang-ffcf63f1.js";import"./Base-9b7f3306.js";/* empty css                          */import"./index-f0ed738f.js";import"./NumberBase.vue_vue_type_script_setup_true_lang-745b39c5.js";import"./AzInputNumber-d6212644.js";import"./el-input-number-c15b1cc7.js";import"./Base-c9aa1df0.js";/* empty css                        */import"./SliderBase.vue_vue_type_script_setup_true_lang-5d73415b.js";import"./TextareaBase.vue_vue_type_script_setup_true_lang-7091b2cb.js";import"./TimeBase.vue_vue_type_script_setup_true_lang-ea537bf3.js";import"./AzTimePicker.vue_vue_type_style_index_0_lang-3726374e.js";import"./TimerangeBase.vue_vue_type_script_setup_true_lang-0827c241.js";import"./UploadFileBase.vue_vue_type_script_setup_true_lang-0c253daa.js";import"./UploadImgBase.vue_vue_type_script_setup_true_lang-d23c1306.js";import"./CooperateEnterpriseBase.vue_vue_type_script_setup_true_lang-23720971.js";import"./useMultipleVal-904406c1.js";import"./CooperatePersonnelBase.vue_vue_type_script_setup_true_lang-adcd0db7.js";import"./Base.vue_vue_type_script_setup_true_lang-0e9a0e2c.js";import"./Base.vue_vue_type_script_setup_true_lang-aa25657d.js";import"./CascaderBase.vue_vue_type_style_index_0_lang-83862970.js";import"./Base.vue_vue_type_script_setup_true_lang-03820366.js";import"./el-dropdown-item-455a6589.js";import"./CardShowFieldItem-fd24f218.js";import"./DataSoureceWrapper-047a1c9d.js";import"./SelectDataSourece-70a968c3.js";import"./useQueryTab-05fa7456.js";import"./useExtractQuery-f96f705c.js";import"./CardTabs-ca59b5e9.js";import"./EditItemTargetForm.vue_vue_type_script_setup_true_lang-199df786.js";import"./SelectEntryAndOther-76a65b2d.js";import"./LoadingData-195d0581.js";import"./AutoJump.vue_vue_type_script_setup_true_lang-a3aa2601.js";import"./ComponentParamsSetWrapper-71afc840.js";import"./default-component-4c80201b.js";import"./SelectFieldByMultEntry-84abd0c3.js";import"./SelectCascaderEntry.vue_vue_type_script_setup_true_lang-673c5dca.js";import"./SelectForm.vue_vue_type_script_setup_true_lang-0170236d.js";import"./ParamsSet.vue_vue_type_script_setup_true_lang-37c252c5.js";import"./MessageRemindConfig-98484405.js";import"./utils-a7200637.js";import"./messageTemplate-8658e6b4.js";import"./SetFieldDefault-5fc1ae2a.js";import"./routePage.vue_vue_type_script_setup_true_lang-efb79c93.js";import"./TableOperation.vue_vue_type_script_setup_true_lang-4afbb2cb.js";import"./CollageTable-791f0954.js";import"./index-617ab4b4.js";import"./ConditionWrapper-43da1676.js";import"./SetAuth-50c8e12e.js";import"./usePublicRelease-2335b254.js";import"./Qrcode-850531ac.js";import"./html2canvas.esm-0543ed55.js";import"./DesignerDialog-22d70853.js";import"./Designer.vue_vue_type_script_setup_true_lang-3c7dafd1.js";import"./form-success-1777d0da.js";import"./keyBy-8fcfdd74.js";import"./_createAggregator-d66ed64c.js";import"./TableRender-bab4d661.js";import"./Resize-eb80395d.js";import"./FormShare-9773b44c.js";import"./dataShare-2d7ae3f7.js";import"./useTransformColor-38b5da33.js";import"./SetFieldAuth-3d0b80a0.js";import"./DesignerTabs-a9795edf.js";import"./Base-3571a39e.js";import"./AddFormDataBtnPlus-a775412e.js";import"./formDesigner-462b10d7.js";import"./useValidateError-9f6399dc.js";import"./AutoNumberBase.vue_vue_type_script_setup_true_lang-56f78b68.js";import"./PluginBase-56c4bf37.js";import"./RichTextBase-228f0924.js";import"./Base-11a86176.js";import"./UploadWrapper.vue_vue_type_script_setup_true_lang-4553cd48.js";import"./index-c89dfa90.js";import"./TemplateCustomEntry.vue_vue_type_script_setup_true_lang-346d01b1.js";import"./TextBase.vue_vue_type_script_setup_true_lang-09411e7a.js";import"./BtnDisplay.vue_vue_type_script_setup_true_lang-cbe1b7c6.js";import"./Base.vue_vue_type_script_setup_true_lang-392ceecd.js";import"./GridBase.vue_vue_type_script_setup_true_lang-f18077d3.js";import"./TableBase-393fac1a.js";import"./TabsBase.vue_vue_type_style_index_0_lang-861f3fae.js";import"./DepartmentBase.vue_vue_type_script_setup_true_lang-6f309530.js";import"./MemberBase.vue_vue_type_script_setup_true_lang-77a28117.js";import"./AddOrEditValidate.vue_vue_type_style_index_0_lang-5bd5a73c.js";import"./ComponentPostAction-12970ad1.js";import"./InternalComponentSelectPlus-00c8c38f.js";import"./app.vue_vue_type_script_setup_true_lang-59fd2507.js";import"./enum-7a2ae6a9.js";import"./index-20639231.js";import"./el-space-0d01b33a.js";import"./cloneDeep-dc1c677b.js";import"./isTypedArray-10beecc7.js";import"./el-collapse-transition-4ed993c7.js";import"./defaultValue-7c7c87ea.js";import"./typeof-7fd5df1e.js";import"./utils-052731c0.js";import"./designerRender.vue_vue_type_script_setup_true_lang-68b31d85.js";import"./FieldOtherEditor.vue_vue_type_script_setup_true_lang-a2d4ed75.js";import"./FormFieldValidateEditor.vue_vue_type_script_setup_true_lang-670668c9.js";import"./FieldLengthEditor.vue_vue_type_script_setup_true_lang-b711d652.js";import"./FieldWidthEditor.vue_vue_type_script_setup_true_lang-3f895778.js";const Je=O({__name:"DataModeLabel",props:{modelId:{}},setup(U){const i=U,u=k();Z(()=>i.modelId,()=>{var c;(c=u.value)==null||c.reload()});const C=G(),_=k(""),S=async()=>{if(_.value="",!i.modelId)return;const c=await C.getDataModelInfos(i.modelId);if(c===null)return Promise.reject({loadState:te.danger,msg:"数据建模不可使用/已被删除"});_.value=(c==null?void 0:c.name)??""};return(c,D)=>(p(),b(oe,{ref_key:"loadingDataRef",ref:u,load:S,inline:"",delay:1e3,style:{width:"100%","min-height":"30px"}},{default:a(()=>[o(le,{style:{width:"100%",color:"var(--el-color-primary)"},content:_.value},null,8,["content"])]),_:1},512))}}),Qe=O({__name:"SelectModelCol",props:{modelValue:{},fieldType:{},modelId:{}},emits:["update:modelValue"],setup(U,{emit:i}){const u=U,_=ie(u,"modelValue",i),S=G(),c=async()=>{const n=u.modelId;if(!n)return[];const f=await S.getDataModelInfos(n);return(f==null?void 0:f.cusomizeCols)??[]},D=n=>{let f=se(u.fieldType);return f||(f=[u.fieldType]),n.filter(r=>f==null?void 0:f.includes(r.controlType))},y=k();return Z(()=>u.modelId,()=>{var n;return(n=y.value)==null?void 0:n.reload()}),(n,f)=>{const r=J;return p(),b(de,{modelValue:g(_),"onUpdate:modelValue":f[0]||(f[0]=d=>ae(_)?_.value=d:null),placeholder:"请选择",load:c,clearable:"",isCheckRemove:"","remove-text":"字段不可被选择/被删除",ref_key:"azSelectRef",ref:y},{default:a(({options:d})=>[(p(!0),T(F,null,N(D(d),(m,V)=>(p(),b(r,{key:V,label:m.title,value:m.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])}}}),Xe=O({__name:"HighlightRow",props:{field:{}},setup(U){const i=U,u=k(!1),C=k(!1),_=()=>{u.value=!0},S=r=>{var d,m;c.value=r??((d=i.field.options.highlightRules)==null?void 0:d.length)??0,n.value=L((r!=null?(m=i.field.options.highlightRules)==null?void 0:m[r]:null)??y),r!=null&&setTimeout(()=>{var V;(V=D.value)==null||V.validate()},40),C.value=!0},c=k(0),D=k(),y={clientId:"",condition:[],color:""},n=k(L(y)),f=async()=>{var d,m;if(await((d=D.value)==null?void 0:d.validate()),n.value.condition.length===0)return W.error("请至少设置一个条件");if(!n.value.color)return W.error("请设置高亮颜色");const r={...n.value,clientId:n.value.clientId||Q((m=i.field.options.highlightRules)==null?void 0:m.map(V=>V.clientId))};i.field.options.highlightRules||(i.field.options.highlightRules=[]),i.field.options.highlightRules.splice(c.value,1,L(r)),C.value=!1};return(r,d)=>{const m=X,V=ue,M=fe,B=ce,e=ge;return p(),b(z,{class:"w100",id:`${r.field.fieldId}.highlightRules`},{default:a(()=>{var l,v;return[o(Ye,{text:"设置显示规则",onClick:_,"is-set":!!((l=r.field.options.highlightRules)!=null&&l.length),setText:`已设置 ${(v=r.field.options.highlightRules)==null?void 0:v.length} 条规则`},null,8,["is-set","setText"]),o(ne,{modelValue:u.value,"onUpdate:modelValue":d[1]||(d[1]=s=>u.value=s),"append-to-body":"",title:"设置显示规则",size:"90%",direction:"btt",class:"highlight_row"},{default:a(()=>[o(e,{class:"rule-card"},{header:a(()=>[o(m,{type:"primary",icon:g(re),onClick:d[0]||(d[0]=s=>S())},{default:a(()=>[E(" 添加规则 ")]),_:1},8,["icon"])]),default:a(()=>{var s;return[(p(!0),T(F,null,N(r.field.options.highlightRules,(h,$)=>(p(),T("div",{key:h.clientId,class:"rule-item"},[I("div",{class:"rule-describe"},[I("div",{class:"mb-5"},"满足以下条件："),I("div",{class:"pl-10"},[o(Ge,{fields:r.field.fields,condition:h.condition},null,8,["fields","condition"])]),I("div",{class:"mt-5 mb-5"},"高亮颜色："),o(P,{modelValue:h.color,"onUpdate:modelValue":R=>h.color=R,style:{"padding-left":"10px"},"show-alpha":"",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),I("div",{class:"rule-operate"},[o(V,{type:"primary",underline:!1,onClick:R=>S($)},{default:a(()=>[E(" 编辑 ")]),_:2},1032,["onClick"]),o(M,{direction:"vertical"}),o(B,{title:"确定要删除该规则?",onConfirm:R=>{var t;return(t=r.field.options.highlightRules)==null?void 0:t.splice($,1)}},{reference:a(()=>[o(V,{type:"danger",underline:!1},{default:a(()=>[E("删除")]),_:1})]),_:2},1032,["onConfirm"])])]))),128)),(s=r.field.options.highlightRules)!=null&&s.length?A("",!0):(p(),T("div",{key:0,class:"rule-empty"}," 让满足条件的数据整行在特定条件成立时，高亮指定颜色 "))]}),_:1})]),_:1},8,["modelValue"]),o(pe,{modelValue:C.value,"onUpdate:modelValue":d[5]||(d[5]=s=>C.value=s),"destroy-on-close":"","append-to-body":"",title:"设置显示规则","close-on-click-modal":!1,width:"750px"},{footer:a(()=>[I("span",{class:"dialog-footer"},[o(m,{onClick:d[4]||(d[4]=s=>C.value=!1)},{default:a(()=>[E("取消")]),_:1}),o(m,{type:"primary",onClick:f},{default:a(()=>[E("确定")]),_:1})])]),default:a(()=>[o(K,{name:"筛选条件",class:"mb-20"},{default:a(()=>[o(Ze,{condition:n.value.condition,"onUpdate:condition":d[2]||(d[2]=s=>n.value.condition=s),ref_key:"fieldConditionRef",ref:D,fields:r.field.fields,mode:g(me).rule},null,8,["condition","fields","mode"])]),_:1}),o(K,{name:"高亮颜色"},{default:a(()=>[o(P,{modelValue:n.value.color,"onUpdate:modelValue":d[3]||(d[3]=s=>n.value.color=s),"show-alpha":""},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]}),_:1},8,["id"])}}});const xe=x(Xe,[["__scopeId","data-v-7d14313c"]]),el=O({__name:"Setting",props:{field:{}},setup(U){var B;const i=U,u=ve(),C=j(()=>ye().reduce((e,l)=>[...e,...l.fields.map(v=>v.type).filter(v=>{const s=Ae(v);return(s==null?void 0:s.isFormItem)&&!he.includes(v)})],[]).map(e=>{const l=_e(e);return l?(l.fieldId=Q(),l.options.label=Ve(e)??"",l):null}).filter(e=>!!e)),_=({type:e})=>{const l=Fe(e);l&&((l.type===q.radio||l.type===q.multiple)&&(l.options.displayMode=Me),i.field.fields.push(We(l)))},S=e=>{u.setSelectedField(e)},c=e=>i.field.options.statistical[e]??"",D=(e,l)=>{if(!e)return delete i.field.options.statistical[l];i.field.options.statistical[l]=e};be(()=>[...i.field.fields],()=>{for(const e of Object.keys(i.field.options.statistical))i.field.fields.some(l=>l.fieldId===e)||delete i.field.options.statistical[e]});const y=k(!1),n=k(),f=j(()=>{const e=L(i.field);return e.options.showLabel=!1,e.options.mode=H.table,{formConfig:Ie(),fields:[e]}}),r=()=>{y.value=!0},d=()=>{var l,v,s;if(!i.field.options.defaultValue)return;const e=(s=(v=(l=n.value)==null?void 0:l.getFormData())==null?void 0:v[0].childs)==null?void 0:s.filter(h=>!h.every($=>!$.value));!Array.isArray(e)||!e.length?i.field.options.defaultValue.custom=null:i.field.options.defaultValue.custom=e.map(h=>h.reduce(($,R)=>({...$,[R.fieldId]:R.value}),{})),y.value=!1},m=k(!!((B=i.field.options.highlightRules)!=null&&B.length)),V=()=>{m.value||(i.field.options.highlightRules=[])},M=j({get(){return i.field.options.mode??H.table},set(e){i.field.options.mode=e}});return(e,l)=>{const v=J,s=ze,h=X,$=Be,R=Le;return p(),T(F,null,[o(Pe,{modelValue:e.field.options,"onUpdate:modelValue":l[0]||(l[0]=t=>e.field.options=t),id:e.field.fieldId},null,8,["modelValue","id"]),e.field.subformMode==="2"?(p(),b(z,{key:0,label:"关联数据建模"},{default:a(()=>[o(Je,{modelId:e.field.modelId??""},null,8,["modelId"])]),_:1})):A("",!0),o(z,{label:"子表单控件",tip:"点击控件进行编辑",id:`${e.field.fieldId}.fields`},{default:a(()=>[o(Ne,{modelValue:e.field.fields,"onUpdate:modelValue":l[1]||(l[1]=t=>e.field.fields=t),class:"subform_setting-drag"},{default:a(({element:t})=>[o(ke,{"model-value":t.options.label,readonly:"",class:"subform-item",onClick:w=>S(t),title:t.options.label},{prefix:a(()=>[o(Ce,{"icon-class":g(Re)(t.type)},null,8,["icon-class"])]),_:2},1032,["model-value","onClick","title"]),e.field.subformMode==="2"?(p(),b(z,{key:0,id:`${e.field.fieldId}.${t.fieldId}`,style:{flex:"0 0 100px"}},{default:a(()=>[o(Qe,{modelValue:t.modelColId,"onUpdate:modelValue":w=>t.modelColId=w,clearable:!1,placeholder:"模型字段",fieldType:t.type,modelId:e.field.modelId??""},null,8,["modelValue","onUpdate:modelValue","fieldType","modelId"])]),_:2},1032,["id"])):A("",!0),g(Y)(t.type)?(p(),b(s,{key:1,"model-value":c(t.fieldId),"onUpdate:modelValue":w=>D(w,t.fieldId),placeholder:"统计设置",clearable:""},{default:a(()=>[(p(!0),T(F,null,N(g(Y)(t.type),(w,ee)=>(p(),b(v,{key:ee,value:w.value,label:w.label},null,8,["value","label"]))),128))]),_:2},1032,["model-value","onUpdate:modelValue"])):A("",!0)]),_:1},8,["modelValue"]),I("div",{class:"w100 mt-10",style:{"line-height":"initial"}},[o(Oe,{onClickField:_,fields:C.value,isSelect:!1,placeholder:"增加子控件"},null,8,["fields"])])]),_:1},8,["id"]),e.field.options.defaultValue?(p(),b(je,{key:1,modelValue:e.field.options.defaultValue,"onUpdate:modelValue":l[4]||(l[4]=t=>e.field.options.defaultValue=t),field:e.field,type:[g($e),g(Ee)]},{default:a(()=>[o(h,{class:"w100",onClick:r,type:"primary",plain:""},{default:a(()=>[E(we(e.field.options.defaultValue.custom?"已设置默认值":"设置"),1)]),_:1}),y.value?(p(),b($,{key:0,modelValue:y.value,"onUpdate:modelValue":l[3]||(l[3]=t=>y.value=t),title:"默认值",width:"70%","append-to-body":""},{footer:a(()=>[I("span",{class:"dialog-footer"},[o(h,{onClick:l[2]||(l[2]=t=>y.value=!1)},{default:a(()=>[E("取消")]),_:1}),o(h,{type:"primary",onClick:d},{default:a(()=>[E(" 确定 ")]),_:1})])]),default:a(()=>[o(g(Se),{class:"preview-form","form-designer":f.value,ref_key:"formRenderRef",ref:n,options:{appId:g(u).appId,entryId:g(u).entryId,mode:g(De).simple,formData:{[e.field.fieldId]:e.field.options.defaultValue.custom}}},null,8,["form-designer","options"])]),_:1},8,["modelValue"])):A("",!0)]),_:1},8,["modelValue","field","type"])):A("",!0),o(He,{label:"子表单规则",tip:"让子表单的子控件在特定条件成立时，执行对应动作",field:e.field,id:`${i.field.fieldId}.rules`},null,8,["field","id"]),o(Ke,{field:e.field},null,8,["field"]),o(z,{label:"显示设置"},{default:a(()=>[I("div",{class:"w100"},[o(s,{modelValue:M.value,"onUpdate:modelValue":l[5]||(l[5]=t=>M.value=t),placeholder:"请选择"},{default:a(()=>[(p(!0),T(F,null,N(g(qe),(t,w)=>(p(),b(v,{key:w,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),M.value===g(H).table?(p(),T(F,{key:0},[I("div",{class:"w100"},[o(R,{modelValue:e.field.options.stripe,"onUpdate:modelValue":l[6]||(l[6]=t=>e.field.options.stripe=t),label:"隔行变色"},null,8,["modelValue"])]),I("div",{class:"w100"},[o(R,{modelValue:m.value,"onUpdate:modelValue":l[7]||(l[7]=t=>m.value=t),label:"高亮标识指定数据",onChange:V},null,8,["modelValue"])]),Te(o(xe,{field:e.field},null,8,["field"]),[[Ue,m.value]])],64)):A("",!0)]),_:1})],64)}}});const _t=x(el,[["__scopeId","data-v-7adbc6d7"]]);export{_t as default};
