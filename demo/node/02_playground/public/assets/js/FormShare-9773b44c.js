import{d as q,r as m,p5 as p,p6 as c,p7 as O,c as h,dj as T,o as d,f as S,b as v,B as t,p8 as D,l as x,i as n,w as o,k,eI as J,m as M,F as V,g as z,bp as j,p9 as L,dl as P,is as $,aN as A,U as G,ao as H,ap as K,ac as Q,bm as W,q as X,aU as Y,bn as Z,_ as ee}from"./index-b80d5ef5.js";import{d as ae}from"./dataShare-2d7ae3f7.js";const le=q({__name:"FormShare",props:{options:{},entryId:{},readonly:{type:Boolean},dataSummary:{}},setup(E,{expose:w}){const i=E,r=m(!1),a=m({shareRange:p.designee,isSendMsg:c.no,shareData:"",shareType:O.data}),y=h({get(){return a.value.shareStaff?JSON.parse(a.value.shareStaff).map(e=>({id:e,type:T.member})):[]},set(s){a.value.shareStaff=s.length?JSON.stringify(s.map(e=>e.id)):""}}),g=m(),_=m(!1),N=async()=>{var s;try{await((s=g.value)==null?void 0:s.validate()),_.value=!0;const e={...i.options};a.value.shareJson=JSON.stringify(e),a.value.shareData=i.dataSummary??"",a.value.entryId=i.entryId,await ae(a.value),A.success("分享成功"),r.value=!1}finally{_.value=!1}},u=h(()=>!!i.readonly);return w({open:s=>{a.value={...s},r.value=!0}}),(s,e)=>{const f=G,B=H,F=K,b=Q,R=W,C=X,I=Y,U=Z;return d(),S(V,null,[u.value?x("",!0):(d(),v(f,{key:0,title:"分享",icon:t(D),link:"",onClick:e[0]||(e[0]=l=>r.value=!0),style:{"font-size":"18px"}},null,8,["icon"])),n(U,{modelValue:r.value,"onUpdate:modelValue":e[4]||(e[4]=l=>r.value=l),title:"分享",width:"500px"},{footer:o(()=>[k("div",{class:"az_flex w100",style:{"align-items":"center"}},[k("div",{class:"az_flex w100",style:{"justify-content":"left","margin-left":"100px"}},[n(C,{modelValue:a.value.isSendMsg,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.isSendMsg=l),label:"发送信息","true-label":t(c).yes,"false-label":t(c).no,disabled:u.value},null,8,["modelValue","true-label","false-label","disabled"]),n(I,{effect:"dark",content:"确定分享后同步发送站内消息给人员",placement:"top"},{default:o(()=>[n(f,{type:"primary",link:"",icon:t(J)},null,8,["icon"])]),_:1})]),u.value?x("",!0):(d(),v(f,{key:0,type:"primary",onClick:N,loading:_.value},{default:o(()=>[M(" 确定 ")]),_:1},8,["loading"]))])]),default:o(()=>[n(R,{model:a.value,"label-width":"100px",style:{"max-width":"600px"},ref_key:"formRef",ref:g,disabled:u.value},{default:o(()=>[n(b,{label:"分享范围"},{default:o(()=>[n(F,{modelValue:a.value.shareRange,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.shareRange=l)},{default:o(()=>[(d(!0),S(V,null,z(t(j)(t(L)),l=>(d(),v(B,{key:l.value,label:l.label,value:l.value,disabled:l.value==t(p).public},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(b,{label:"分享到人员",prop:"shareStaff",required:a.value.shareRange==t(p).designee,rules:[{required:a.value.shareRange==t(p).designee,message:"请选择指定人员",trigger:"change"}]},{default:o(()=>[n(P,{tabs:[t($).memberByOrg],multiple:"",modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=l=>y.value=l),disabled:u.value},null,8,["tabs","modelValue","disabled"])]),_:1},8,["required","rules"])]),_:1},8,["model","disabled"])]),_:1},8,["modelValue"])],64)}}});const ne=ee(le,[["__scopeId","data-v-d8653082"]]);export{ne as F};
