import{d as k,r as i,bi as E,iC as D,o as _,f as B,i as s,w as p,e as N,b as P,B as z,ae as U,m as G,rT as I,cc as h,rW as M,bh as S,as as T,aN as w,P as L,U as R}from"./index-b80d5ef5.js";import{G as $,g as q,a as O,b as j,c as F,d as H,e as W}from"./GroupAddAndEdit-f668234f.js";const J={name:"Group"},Y=k({...J,setup(K){const o=i(!1),u=i(!1),c=i(),n=i([]),d=i("add"),a=i({}),x={query:{list:[{type:"input",label:"分组名称",prop:"groupName"},{type:"select",label:"状态",prop:"status",options:"status",isAll:!0,initValue:h}]},request:{api:q},table:{tableCols:[{type:"index",width:55,label:"序号"},{prop:"groupName",label:"分组名称",showOverflowTooltip:!0},{prop:"status",label:"状态",slots:{default({row:e}){return s(S,{disabled:!M("system:group:enable"),modelValue:e.status,"onUpdate:modelValue":t=>e.status=t,updateFetch:()=>A(e.id,e.status)},null)}}},{fixed:"right",width:230,label:"操作",slots:{default({row:e}){return s(T,{num:4,list:[{id:"system:group:edit",type:"primary",premission:"system:group:edit",onClick:()=>{v("edit",e)},text:"编辑"},{id:"system:group:user",type:"primary",premission:"systemgroup:user",onClick:async()=>{await C(e)},text:"组内成员"},{id:"system:group:detail",type:"primary",premission:"system:group:detail",onClick:()=>{a.value={...e},d.value="view",o.value=!0},text:"查看"},{id:"system:group:delete",type:"danger",premission:"system:group:delete",text:"删除",popconfirmProps:{title:"您确定要删除该分组吗?",confirm:async()=>{await H(e.id),w.success("删除成功"),await m()}}}]},null)}}}]}},m=async()=>{var e;await((e=c.value)==null?void 0:e.refresh())},v=(e,t)=>{e==="add"?a.value={groupName:"",remark:"",status:1}:a.value=Object.assign({},t),d.value=e,o.value=!0},A=async(e,t)=>t==h?await O(e):await j(e),C=async e=>{const t=e.id;a.value=e;const r=await W(t);n.value=r,u.value=!0},V=async e=>{const t={userList:n.value,id:a.value.id};await F(t),w.success("保存成功")};return(e,t)=>{var b;const r=L,g=R,y=E("az-page"),f=D("premission");return _(),B("div",null,[s(y,{class:"layout_box",ref_key:"azPageRef",ref:c,config:x,maxHeight:"var(--az-layout-main-height) - 32px"},{operation:p(()=>[N((_(),P(g,{onClick:t[0]||(t[0]=l=>v("add")),type:"primary"},{default:p(()=>[s(r,{size:16,style:{"margin-right":"8px"}},{default:p(()=>[s(z(U))]),_:1}),G(" 新增分组 ")]),_:1})),[[f,"system:group:add"]])]),_:1},512),s($,{"drawer-model":o.value,"onUpdate:drawerModel":t[1]||(t[1]=l=>o.value=l),"row-data":a.value,onRefresh:m,"com-state":d.value},null,8,["drawer-model","row-data","com-state"]),s(I,{modelValue:n.value,"onUpdate:modelValue":t[2]||(t[2]=l=>n.value=l),visible:u.value,"onUpdate:visible":t[3]||(t[3]=l=>u.value=l),label:"组内成员","mini-title":(b=a.value)==null?void 0:b.groupName,multiple:!0,onChange:V,type:"member"},null,8,["modelValue","visible","mini-title"])])}}});export{Y as default};
