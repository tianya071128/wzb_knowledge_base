import{iO as Ie,iQ as Ge,yT as Je,cB as he,em as Xe,r as R,c as D,B as e,fl as ge,j3 as Ze,y as q,cm as xe,bx as Ce,uc as et,du as tt,bJ as lt,yU as ot,c7 as at,d as Y,iW as ke,iV as st,o as c,f as T,k as X,b as $,w as v,e as le,p as j,bc as J,i as f,P as de,hN as nt,S as oe,gl as ye,l as P,nO as rt,h as Ve,a2 as we,F,g as G,t as ae,j1 as Se,bI as ut,bK as Ee,cC as it,iY as ct,j5 as dt,kT as mt,dw as ft,Y as ne,eK as vt,v as Te,R as Ue,m as re,bt as me,d9 as Me,at as pt,bu as Ne,C as Z,bv as _t,E as Re,ab as $e,ac as Ae,ao as ze,bm as Le,_ as Be,Q as gt,bn as yt,av as bt}from"./index-b80d5ef5.js";import{M as It}from"./ModuleWrapper-dbe018a4.js";import{E as ht}from"./el-image-ee5f9ae3.js";import"./el-image-viewer-e054799e.js";import{i as se,j as Ct,o as fe,u as kt,k as Vt,l as wt,m as St,n as Et,q as Tt}from"./createDesigner-82222fc7.js";import"./dashboardDesigner-ce3c2e23.js";import"./enum-baae9292.js";const Ut=Ie({initialIndex:{type:Number,default:0},height:{type:String,default:""},trigger:{type:String,values:["hover","click"],default:"hover"},autoplay:{type:Boolean,default:!0},interval:{type:Number,default:3e3},indicatorPosition:{type:String,values:["","none","outside"],default:""},arrow:{type:String,values:["always","hover","never"],default:"hover"},type:{type:String,values:["","card"],default:""},loop:{type:Boolean,default:!0},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},pauseOnHover:{type:Boolean,default:!0}}),Mt={change:(i,I)=>[i,I].every(Ge)},Pe=Symbol("carouselContextKey"),be=300,Nt=(i,I,u)=>{const{children:s,addChild:n,removeChild:d}=Je(he(),"ElCarouselItem"),V=Xe(),l=R(-1),p=R(null),t=R(!1),a=R(),m=R(0),w=R(!0),C=D(()=>i.arrow!=="never"&&!e(M)),_=D(()=>s.value.some(r=>r.props.label.toString().length>0)),L=D(()=>i.type==="card"),M=D(()=>i.direction==="vertical"),o=D(()=>i.height!=="auto"?{height:i.height}:{height:`${m.value}px`,overflow:"hidden"}),h=ge(r=>{E(r)},be,{trailing:!0}),O=ge(r=>{W(r)},be),g=r=>w.value?l.value<=1?r<=1:r>1:!0;function y(){p.value&&(clearInterval(p.value),p.value=null)}function S(){i.interval<=0||!i.autoplay||p.value||(p.value=setInterval(()=>N(),i.interval))}const N=()=>{l.value<s.value.length-1?l.value=l.value+1:i.loop&&(l.value=0)};function E(r){if(Ze(r)){const Q=s.value.filter(K=>K.props.name===r);Q.length>0&&(r=s.value.indexOf(Q[0]))}if(r=Number(r),Number.isNaN(r)||r!==Math.floor(r))return;const k=s.value.length,H=l.value;r<0?l.value=i.loop?k-1:0:r>=k?l.value=i.loop?0:k-1:l.value=r,H===l.value&&b(H),ve()}function b(r){s.value.forEach((k,H)=>{k.translateItem(H,l.value,r)})}function B(r,k){var H,Q,K,ee;const te=e(s),pe=te.length;if(pe===0||!r.states.inStage)return!1;const Fe=k+1,We=k-1,_e=pe-1,Ke=te[_e].states.active,Ye=te[0].states.active,Qe=(Q=(H=te[Fe])==null?void 0:H.states)==null?void 0:Q.active,qe=(ee=(K=te[We])==null?void 0:K.states)==null?void 0:ee.active;return k===_e&&Ye||Qe?"left":k===0&&Ke||qe?"right":!1}function x(){t.value=!0,i.pauseOnHover&&y()}function ue(){t.value=!1,S()}function A(r){e(M)||s.value.forEach((k,H)=>{r===B(k,H)&&(k.states.hover=!0)})}function U(){e(M)||s.value.forEach(r=>{r.states.hover=!1})}function z(r){l.value=r}function W(r){i.trigger==="hover"&&r!==l.value&&(l.value=r)}function ie(){E(l.value-1)}function De(){E(l.value+1)}function ve(){y(),i.pauseOnHover||S()}function He(r){i.height==="auto"&&(m.value=r)}function je(){var r;const k=(r=V.default)==null?void 0:r.call(V);if(!k)return null;const H=ot(k),Q="ElCarouselItem",K=H.filter(ee=>at(ee)&&ee.type.name===Q);return(K==null?void 0:K.length)===2&&i.loop&&!L.value?(w.value=!0,K):(w.value=!1,null)}q(()=>l.value,(r,k)=>{b(k),w.value&&(r=r%2,k=k%2),k>-1&&I("change",r,k)}),q(()=>i.autoplay,r=>{r?S():y()}),q(()=>i.loop,()=>{E(l.value)}),q(()=>i.interval,()=>{ve()});const ce=xe();return Ce(()=>{q(()=>s.value,()=>{s.value.length>0&&E(i.initialIndex)},{immediate:!0}),ce.value=et(a.value,()=>{b()}),S()}),tt(()=>{y(),a.value&&ce.value&&ce.value.stop()}),lt(Pe,{root:a,isCardType:L,isVertical:M,items:s,loop:i.loop,addItem:n,removeItem:d,setActiveItem:E,setContainerHeight:He}),{root:a,activeIndex:l,arrowDisplay:C,hasLabel:_,hover:t,isCardType:L,items:s,isVertical:M,containerStyle:o,isItemsTwoLength:w,handleButtonEnter:A,handleButtonLeave:U,handleIndicatorClick:z,handleMouseEnter:x,handleMouseLeave:ue,setActiveItem:E,prev:ie,next:De,PlaceholderItem:je,isTwoLengthShow:g,throttledArrowClick:h,throttledIndicatorHover:O}},Rt=["aria-label"],$t=["aria-label"],At=["onMouseenter","onClick"],zt=["aria-label"],Lt={key:0},Bt="ElCarousel",Pt=Y({name:Bt}),Ot=Y({...Pt,props:Ut,emits:Mt,setup(i,{expose:I,emit:u}){const s=i,{root:n,activeIndex:d,arrowDisplay:V,hasLabel:l,hover:p,isCardType:t,items:a,isVertical:m,containerStyle:w,handleButtonEnter:C,handleButtonLeave:_,handleIndicatorClick:L,handleMouseEnter:M,handleMouseLeave:o,setActiveItem:h,prev:O,next:g,PlaceholderItem:y,isTwoLengthShow:S,throttledArrowClick:N,throttledIndicatorHover:E}=Nt(s,u),b=ke("carousel"),{t:B}=st(),x=D(()=>{const A=[b.b(),b.m(s.direction)];return e(t)&&A.push(b.m("card")),A}),ue=D(()=>{const A=[b.e("indicators"),b.em("indicators",s.direction)];return e(l)&&A.push(b.em("indicators","labels")),s.indicatorPosition==="outside"&&A.push(b.em("indicators","outside")),e(m)&&A.push(b.em("indicators","right")),A});return I({setActiveItem:h,prev:O,next:g}),(A,U)=>(c(),T("div",{ref_key:"root",ref:n,class:j(e(x)),onMouseenter:U[6]||(U[6]=J((...z)=>e(M)&&e(M)(...z),["stop"])),onMouseleave:U[7]||(U[7]=J((...z)=>e(o)&&e(o)(...z),["stop"]))},[X("div",{class:j(e(b).e("container")),style:we(e(w))},[e(V)?(c(),$(ye,{key:0,name:"carousel-arrow-left",persisted:""},{default:v(()=>[le(X("button",{type:"button",class:j([e(b).e("arrow"),e(b).em("arrow","left")]),"aria-label":e(B)("el.carousel.leftArrow"),onMouseenter:U[0]||(U[0]=z=>e(C)("left")),onMouseleave:U[1]||(U[1]=(...z)=>e(_)&&e(_)(...z)),onClick:U[2]||(U[2]=J(z=>e(N)(e(d)-1),["stop"]))},[f(e(de),null,{default:v(()=>[f(e(nt))]),_:1})],42,Rt),[[oe,(A.arrow==="always"||e(p))&&(s.loop||e(d)>0)]])]),_:1})):P("v-if",!0),e(V)?(c(),$(ye,{key:1,name:"carousel-arrow-right",persisted:""},{default:v(()=>[le(X("button",{type:"button",class:j([e(b).e("arrow"),e(b).em("arrow","right")]),"aria-label":e(B)("el.carousel.rightArrow"),onMouseenter:U[3]||(U[3]=z=>e(C)("right")),onMouseleave:U[4]||(U[4]=(...z)=>e(_)&&e(_)(...z)),onClick:U[5]||(U[5]=J(z=>e(N)(e(d)+1),["stop"]))},[f(e(de),null,{default:v(()=>[f(e(rt))]),_:1})],42,$t),[[oe,(A.arrow==="always"||e(p))&&(s.loop||e(d)<e(a).length-1)]])]),_:1})):P("v-if",!0),f(e(y)),Ve(A.$slots,"default")],6),A.indicatorPosition!=="none"?(c(),T("ul",{key:0,class:j(e(ue))},[(c(!0),T(F,null,G(e(a),(z,W)=>le((c(),T("li",{key:W,class:j([e(b).e("indicator"),e(b).em("indicator",A.direction),e(b).is("active",W===e(d))]),onMouseenter:ie=>e(E)(W),onClick:J(ie=>e(L)(W),["stop"])},[X("button",{class:j(e(b).e("button")),"aria-label":e(B)("el.carousel.indicator",{index:W+1})},[e(l)?(c(),T("span",Lt,ae(z.props.label),1)):P("v-if",!0)],10,zt)],42,At)),[[oe,e(S)(W)]])),128))],2)):P("v-if",!0)],34))}});var Dt=Se(Ot,[["__file","carousel.vue"]]);const Ht=Ie({name:{type:String,default:""},label:{type:[String,Number],default:""}}),jt=(i,I)=>{const u=ut(Pe),s=he(),n=.83,d=R(),V=R(!1),l=R(0),p=R(1),t=R(!1),a=R(!1),m=R(!1),w=R(!1),{isCardType:C,isVertical:_}=u;function L(g,y,S){const N=S-1,E=y-1,b=y+1,B=S/2;return y===0&&g===N?-1:y===N&&g===0?S:g<E&&y-g>=B?S+1:g>b&&g-y>=B?-2:g}function M(g,y){var S,N;const E=e(_)?((S=u.root.value)==null?void 0:S.offsetHeight)||0:((N=u.root.value)==null?void 0:N.offsetWidth)||0;return m.value?E*((2-n)*(g-y)+1)/4:g<y?-(1+n)*E/4:(3+n)*E/4}function o(g,y,S){const N=u.root.value;return N?((S?N.offsetHeight:N.offsetWidth)||0)*(g-y):0}const h=(g,y,S)=>{var N;const E=e(C),b=(N=u.items.value.length)!=null?N:Number.NaN,B=g===y;!E&&!ct(S)&&(w.value=B||g===S),!B&&b>2&&u.loop&&(g=L(g,y,b));const x=e(_);t.value=B,E?(m.value=Math.round(Math.abs(g-y))<=1,l.value=M(g,y),p.value=e(t)?1:n):l.value=o(g,y,x),a.value=!0,B&&d.value&&u.setContainerHeight(d.value.offsetHeight)};function O(){if(u&&e(C)){const g=u.items.value.findIndex(({uid:y})=>y===s.uid);u.setActiveItem(g)}}return Ce(()=>{u.addItem({props:i,states:Ee({hover:V,translate:l,scale:p,active:t,ready:a,inStage:m,animating:w}),uid:s.uid,translateItem:h})}),it(()=>{u.removeItem(s.uid)}),{carouselItemRef:d,active:t,animating:w,hover:V,inStage:m,isVertical:_,translate:l,isCardType:C,scale:p,ready:a,handleItemClick:O}},Ft=Y({name:"ElCarouselItem"}),Wt=Y({...Ft,props:Ht,setup(i){const I=i,u=ke("carousel"),{carouselItemRef:s,active:n,animating:d,hover:V,inStage:l,isVertical:p,translate:t,isCardType:a,scale:m,ready:w,handleItemClick:C}=jt(I),_=D(()=>[u.e("item"),u.is("active",n.value),u.is("in-stage",l.value),u.is("hover",V.value),u.is("animating",d.value),{[u.em("item","card")]:a.value,[u.em("item","card-vertical")]:a.value&&p.value}]),L=D(()=>{const o=`${`translate${e(p)?"Y":"X"}`}(${e(t)}px)`,h=`scale(${e(m)})`;return{transform:[o,h].join(" ")}});return(M,o)=>le((c(),T("div",{ref_key:"carouselItemRef",ref:s,class:j(e(_)),style:we(e(L)),onClick:o[0]||(o[0]=(...h)=>e(C)&&e(C)(...h))},[e(a)?le((c(),T("div",{key:0,class:j(e(u).e("mask"))},null,2)),[[oe,!e(n)]]):P("v-if",!0),Ve(M.$slots,"default")],6)),[[oe,e(w)]])}});var Oe=Se(Wt,[["__file","carousel-item.vue"]]);const Kt=dt(Dt,{CarouselItem:Oe}),Yt=mt(Oe);const Qt=Y({__name:"Main",props:{options:{}},setup(i){const I=i,u=D(()=>+I.options.dur_time*1e3),s=n=>{n.effect===se.LINK&&(n.openType===fe.CURRENT?window.location.href=n.link:window.open(n.link))};return(n,d)=>{const V=ht,l=Yt,p=Kt;return c(),$(p,{autoplay:n.options.dur_time!==0,interval:u.value,class:j(["custom-carousel",{"fade-ani":n.options.play_style===e(Ct).FADE}])},{default:v(()=>[(c(!0),T(F,null,G(n.options.imgs,t=>(c(),$(l,{key:t.url},{default:v(()=>[X("div",{class:"carousel-wrap",onClick:a=>s(t)},[f(V,{src:t.url,class:"img",alt:"carousel-item",fit:n.options.fit_type,"preview-teleported":"",crossorigin:null,"preview-src-list":t.effect===e(se).PREVIEW?[t.url]:[]},null,8,["src","fit","preview-src-list"]),t.title||t.desc?(c(),T("div",{key:0,class:"desc-wrap"},[t.title?(c(),T("div",{key:0,class:"title az-ellipsis"},ae(t.title),1)):P("",!0),t.desc?(c(),T("div",{key:1,class:"desc az-ellipsis"},ae(t.desc),1)):P("",!0)])):P("",!0)],8,["onClick"])]),_:2},1024))),128))]),_:1},8,["autoplay","interval","class"])}}});const qt=i=>{const I=Ee({carouselSetting_visible:!1,imgSetting_visible:!1,curUrl:""}),u=kt(),s=D(()=>ft.design===u.mode),n=R(ne(i.moduleItem.options)),d=V=>{I.curUrl=V,I.imgSetting_visible=!0};return q(()=>I.carouselSetting_visible,()=>{n.value=ne(i.moduleItem.options)}),{...vt(I),carouselForm:n,onSetImg:d,isDesignMode:s}},Gt=qt,Jt=Y({__name:"CarouselSetting",props:{visible:{type:Boolean},form:{}},emits:["update:visible","update:form","settingImg","confirm"],setup(i,{emit:I}){const u=i,s=I,n=Te(u,"visible",s),d=Ue(u,"form",s),V=t=>{s("settingImg",t.response)},l=async()=>{s("confirm")},p=D({get(){return d.value.imgs.map(t=>t.url)},set(t){d.value.imgs=t.map(a=>d.value.imgs.find(m=>m.url===a)??{url:a,title:"",desc:"",effect:se.PREVIEW,link:"",openType:fe.CURRENT})}});return(t,a)=>{const m=Re,w=$e,C=Ae,_=ze,L=de,M=Le;return c(),$(_t,{modelValue:e(n),"onUpdate:modelValue":a[5]||(a[5]=o=>Z(n)?n.value=o:null),title:"轮播图设置","append-to-body":""},{default:v(()=>[f(M,{"label-suffix":":","label-width":"80px"},{default:v(()=>[f(C,{label:"播放样式"},{default:v(()=>[f(w,{modelValue:e(d).play_style,"onUpdate:modelValue":a[0]||(a[0]=o=>e(d).play_style=o),class:"ml-4"},{default:v(()=>[(c(!0),T(F,null,G(e(Vt),(o,h)=>(c(),$(m,{key:h,label:o.value},{default:v(()=>[re(ae(o.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),f(C,{label:"间隔时间"},{default:v(()=>[f(me,{modelValue:e(d).dur_time,"onUpdate:modelValue":a[1]||(a[1]=o=>e(d).dur_time=o),placeholder:"请选择",load:e(wt)},{default:v(({options:o})=>[(c(!0),T(F,null,G(o,(h,O)=>(c(),$(_,{key:O,label:h.label,value:h.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","load"])]),_:1}),f(C,{label:"填充方式"},{default:v(()=>[f(me,{modelValue:e(d).fit_type,"onUpdate:modelValue":a[2]||(a[2]=o=>e(d).fit_type=o),placeholder:"请选择",load:e(St)},{default:v(({options:o})=>[(c(!0),T(F,null,G(o,(h,O)=>(c(),$(_,{key:O,label:h.label,value:h.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","load"])]),_:1}),e(n)?(c(),$(C,{key:0,label:"上传图片"},{default:v(()=>[f(Me,{ref:"AzUploadRef",limit:8,modelValue:p.value,"onUpdate:modelValue":a[3]||(a[3]=o=>p.value=o),type:"img",size:1024*5,accept:["jpg","jpeg","bmp","png"]},{operation:v(({file:o})=>[f(L,{class:"operation-icon",onClick:J(h=>V(o),["stop"]),title:"设置"},{default:v(()=>[f(e(pt))]),_:2},1032,["onClick"])]),_:1},8,["modelValue"])]),_:1})):P("",!0)]),_:1}),f(Ne,{"edit-mode":"",onClose:a[4]||(a[4]=o=>n.value=!1),"on-submit":l,"submit-text":"保存"})]),_:1},8,["modelValue"])}}});const Xt=Be(Jt,[["__scopeId","data-v-14e7d1a6"]]),Zt=Y({__name:"ImgSetting",props:{visible:{type:Boolean},form:{},curUrl:{}},emits:["update:visible","update:form","refresh"],setup(i,{emit:I}){const u=i,s=I,n=Te(u,"visible",s),d=Ue(u,"form",s),V=async()=>{d.value.imgs=d.value.imgs.map(p=>p.url===u.curUrl?{...l.value}:p),s("refresh")},l=R({url:"",title:"",desc:"",effect:se.PREVIEW,link:"",openType:fe.CURRENT});return q(()=>[n.value,u.curUrl],p=>{if(p[0]&&p[1]){const t=d.value.imgs.find(a=>a.url===p[1]);t&&(l.value=ne(t))}},{immediate:!0}),(p,t)=>{const a=Ae,m=gt,w=ze,C=Re,_=$e,L=Le,M=yt;return c(),$(M,{title:"图片设置",modelValue:e(n),"onUpdate:modelValue":t[7]||(t[7]=o=>Z(n)?n.value=o:null),"append-to-body":""},{footer:v(()=>[f(Ne,{editMode:!0,onClose:t[6]||(t[6]=o=>n.value=!1),"on-submit":V})]),default:v(()=>[f(L,{"label-suffix":":","label-width":"100px"},{default:v(()=>[f(a,null,{default:v(()=>[f(Me,{modelValue:l.value.url,"onUpdate:modelValue":t[0]||(t[0]=o=>l.value.url=o),ref:"imgAzUploadRef",limit:1,size:1024*5,type:"img",accept:["jpg","jpeg","bmp","png"],hideDelete:""},null,8,["modelValue"])]),_:1}),f(a,{label:"显示标题"},{default:v(()=>[f(m,{modelValue:l.value.title,"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.title=o),placeholder:"请输入显示标题"},null,8,["modelValue"])]),_:1}),f(a,{label:"文案"},{default:v(()=>[f(m,{modelValue:l.value.desc,"onUpdate:modelValue":t[2]||(t[2]=o=>l.value.desc=o),type:"textarea",autosize:{minRows:2,maxRows:3},placeholder:"请输入文案"},null,8,["modelValue"])]),_:1}),f(a,{label:"点击图片效果"},{default:v(()=>[f(me,{modelValue:l.value.effect,"onUpdate:modelValue":t[3]||(t[3]=o=>l.value.effect=o),placeholder:"请选择",load:e(Et)},{default:v(({options:o})=>[(c(!0),T(F,null,G(o,(h,O)=>(c(),$(w,{key:O,label:h.label,value:h.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","load"])]),_:1}),l.value.effect===e(se).LINK?(c(),T(F,{key:0},[f(a,{label:"超链接"},{default:v(()=>[f(m,{modelValue:l.value.link,"onUpdate:modelValue":t[4]||(t[4]=o=>l.value.link=o),type:"textarea",autosize:{minRows:2,maxRows:3},placeholder:"请输入超链接"},null,8,["modelValue"])]),_:1}),f(a,{label:"打开方式"},{default:v(()=>[f(_,{modelValue:l.value.openType,"onUpdate:modelValue":t[5]||(t[5]=o=>l.value.openType=o),class:"ml-4"},{default:v(()=>[(c(!0),T(F,null,G(e(Tt),(o,h)=>(c(),$(C,{key:h,label:o.value},{default:v(()=>[re(ae(o.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})],64)):P("",!0)]),_:1})]),_:1},8,["modelValue"])}}}),xt=Y({__name:"render",props:{moduleItem:{}},setup(i){const I=i,{carouselSetting_visible:u,imgSetting_visible:s,carouselForm:n,curUrl:d,onSetImg:V,isDesignMode:l}=Gt(I),p=()=>{I.moduleItem.options={...I.moduleItem.options,...ne(n.value)}},t=R();return(a,m)=>{const w=bt;return c(),$(It,{"module-item":a.moduleItem,onEdit:m[5]||(m[5]=C=>u.value=!0)},{default:v(()=>{var C;return[(C=a.moduleItem.options)!=null&&C.imgs.length?(c(),$(Qt,{key:1,options:a.moduleItem.options},null,8,["options"])):(c(),T("div",{key:0,class:"carousel-box-tips"},[X("div",null,[re(" 暂未配置轮播图 "),e(l)?(c(),$(w,{key:0,underline:!1,type:"primary",class:"config-text",onClick:m[0]||(m[0]=_=>u.value=!0)},{default:v(()=>[re(" 配置 ")]),_:1})):P("",!0)])])),e(l)?(c(),T(F,{key:2},[f(Xt,{ref_key:"carouselSettingRef",ref:t,visible:e(u),"onUpdate:visible":m[1]||(m[1]=_=>Z(u)?u.value=_:null),form:e(n),"onUpdate:form":m[2]||(m[2]=_=>Z(n)?n.value=_:null),onSettingImg:e(V),onConfirm:p},null,8,["visible","form","onSettingImg"]),e(s)?(c(),$(Zt,{key:0,visible:e(s),"onUpdate:visible":m[3]||(m[3]=_=>Z(s)?s.value=_:null),form:e(n),"onUpdate:form":m[4]||(m[4]=_=>Z(n)?n.value=_:null),curUrl:e(d)},null,8,["visible","form","curUrl"])):P("",!0)],64)):P("",!0)]}),_:1},8,["module-item"])}}});const rl=Be(xt,[["__scopeId","data-v-2eef59f5"]]);export{rl as default};
