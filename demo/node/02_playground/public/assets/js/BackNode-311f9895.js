/* empty css              *//* empty css              *//* empty css              *//* empty css              */import{F as ee,a as le,C as ae}from"./index-4a9e77d2.js";import{d as R,hd as oe,c as V,bI as M,AS as te,r as C,bX as se,y as L,cC as ne,o as n,b as $,ad as E,w as r,h as c,k as D,f as v,l as F,_ as j,n as O,q1 as ue,i as z,bc as W,m as T,t as P,F as U,g as X,I as ie,p as re,B as b,lS as de,lK as pe,v as ce,C as me,AX as ve}from"./index-b80d5ef5.js";import"./index-34056eca.js";import"./index-30749bf5.js";import{P as fe}from"./index-d380ed0a.js";import{u as ye,T as ge,C as _e}from"./useIncreaseCustomFieldValue-c1159fdb.js";import{A as ke}from"./AzPopup-b04fec03.js";import{B as be}from"./index-ae93b8ef.js";import{F as he}from"./index-ba3c5d48.js";import{D as $e}from"./FlowFormRender-c8e3be49.js";import"./use-route-c2b2b5be.js";import"./use-id-d3187131.js";import"./enum-7a2ae6a9.js";import"./useFlowForm-df7c1aa0.js";const Ve=Symbol("移动端.自定义表单项"),Fe=R({__name:"AzField",props:{modelValue:{},readonly:{type:Boolean}},emits:["update:modelValue"],setup(w,{expose:B,emit:o}){oe(l=>({"276b2431":I.value}));const f=w,u=o,g=V({get(){const l=f.modelValue??"";return typeof l!="string"?"":l},set(l){u("update:modelValue",l??"")}}),p=M(te,null);ye(()=>f.modelValue);const y=()=>{f.readonly||p&&(p.resetValidation(),p.validateWithTrigger("onBlur"))},m=C(),{width:S}=se(m),I=V(()=>`${S.value}px`),i=C(),a=M(Ve,null);return L(i,(l,_)=>{_&&(a==null||a.deleteField(_)),l&&(a==null||a.addField(l))}),ne(()=>{i.value&&(a==null||a.deleteField(i.value))}),B({focus(){var l;return(l=i.value)==null?void 0:l.focus()},blur(){var l;return(l=i.value)==null?void 0:l.blur()}}),(l,_)=>{const d=ee;return n(),$(d,{ref_key:"vanFieldRef",ref:i,class:"az_field",modelValue:g.value,"onUpdate:modelValue":_[0]||(_[0]=k=>g.value=k),readonly:l.readonly,onBlur:y},E({_:2},[l.$slots.input?{name:"input",fn:r(()=>[c(l.$slots,"input",{},void 0,!0)]),key:"0"}:void 0,l.$slots.prepend||l.$slots.prefix||l.$slots["right-icon"]||l.$slots.append?{name:"right-icon",fn:r(()=>[D("div",{class:"az_field-left-slot",ref_key:"azFieldLeftSlot",ref:m},[l.$slots.prepend?(n(),v("div",{key:0,class:"az_field-prepend"},[c(l.$slots,"prepend",{},void 0,!0)])):F("",!0),l.$slots.prefix?(n(),v("div",{key:1,class:"az_field-prefix"},[c(l.$slots,"prefix",{},void 0,!0)])):F("",!0)],512),D("div",{class:"az_field-right-slot"},[l.$slots["right-icon"]?(n(),v("div",{key:0,class:"az_field-right-icon"},[c(l.$slots,"right-icon",{},void 0,!0)])):F("",!0),l.$slots.append?(n(),v("div",{key:1,class:"az_field-append"},[c(l.$slots,"append",{},void 0,!0)])):F("",!0)])]),key:"1"}:void 0,l.$slots.extra?{name:"extra",fn:r(()=>[c(l.$slots,"extra",{},void 0,!0)]),key:"2"}:void 0]),1032,["modelValue","readonly"])}}});const ze=j(Fe,[["__scopeId","data-v-585b1fcc"]]),Ce=R({inheritAttrs:!1,__name:"AzSelect",props:{modelValue:{},placeholder:{default:"请选择"},load:{},keys:{},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},columnsFieldNames:{default(){return{text:"label"}}},title:{default:"选择"},clearable:{type:Boolean,default:!1},loading:{type:Boolean},isTile:{type:Boolean},emptyText:{default:"没有数据"},custom:{type:Boolean}},emits:["update:modelValue","loadFinish","visibleChange","change"],setup(w,{emit:B}){const o=w,f=B,u=V({get(){let e=O(o.modelValue);return y.value!=="success"?e=[]:typeof o.load=="string"&&typeof o.load=="string"&&(e=e.map(t=>typeof t=="number"?String(t):t)),e},set(e){f("update:modelValue",o.multiple?e:(e==null?void 0:e[0])??"")}});L(()=>o.modelValue,()=>{f("change",o.modelValue)});const g=e=>{const t=new Set(u.value);t.delete(e),u.value=[...t]},p=V(()=>o.multiple||o.isTile),{state:y,options:m,refresh:S}=ue(o,f),I=V(()=>y.value==="loading"?"选项数据正在加载中":y.value==="fail"?"选项数据加载失败":o.placeholder),i=V(()=>y.value==="loading"||o.loading),a=V(()=>({label:o.columnsFieldNames.text??"label",value:o.columnsFieldNames.value??"value"})),l=e=>{var t;return((t=m.value.find(N=>N[a.value.value]===e))==null?void 0:t[a.value.label])??e},_=()=>{o.custom||o.disabled||(d.value=!0)},d=C(!1),k=C(),h=C(new Set),K=(e,t)=>{e?o.multiple?h.value.add(t):h.value=new Set([t]):h.value.delete(t)};L(d,()=>{d.value&&(h.value=new Set(u.value)),setTimeout(()=>{var e;d.value&&!p.value?k.value=O(((e=u.value)==null?void 0:e[0])??void 0):k.value=void 0},200)},{immediate:!0}),L(d,()=>{f("visibleChange",d.value)});const G=({selectedValues:e})=>{p.value?u.value=[...h.value]:(u.value=e,!e.length&&m.value.length>0&&(u.value=[m.value[0][a.value.value]])),d.value=!1};return(e,t)=>{const N=de,J=ge,Y=pe,H=be,Q=_e,Z=le,x=fe;return n(),v(U,null,[z(ze,ie(e.$attrs,{readonly:"","is-link":!e.disabled,disabled:e.disabled,name:"datePicker",placeholder:I.value,"model-value":o.modelValue,onClick:_}),E({_:2},[e.clearable?{name:"right-icon",fn:r(()=>[u.value.length?(n(),$(N,{key:0,onClick:t[0]||(t[0]=W(s=>u.value=[],["stop"])),name:"clear",style:{opacity:"0.5"}})):F("",!0)]),key:"0"}:void 0,u.value.length?{name:"input",fn:r(()=>[e.multiple?(n(),v("div",{key:1},[c(e.$slots,"reference",{},()=>[(n(!0),v(U,null,X(u.value,s=>(n(),$(J,{class:"mr-5",key:s,closeable:"",plain:"",type:"primary",size:"medium",onClose:A=>g(s)},{default:r(()=>[T(P(l(s)),1)]),_:2},1032,["onClose"]))),128))],!0)])):(n(),v("div",{key:0,class:"az_select-single-reference van-multi-ellipsis--l2"},[c(e.$slots,"reference",{},()=>{var s;return[T(P(l((s=u.value)==null?void 0:s[0])),1)]},!0)]))]),key:"1"}:void 0,e.$slots.extra?{name:"extra",fn:r(()=>[c(e.$slots,"extra",{},void 0,!0)]),key:"2"}:void 0]),1040,["is-link","disabled","placeholder","model-value"]),z(ke,{show:d.value,"onUpdate:show":t[3]||(t[3]=s=>d.value=s),position:"bottom",round:"",closeable:!1},{default:r(()=>[z(x,{class:re(["az_select-picker",{"is-multiple":p.value,"hide-columns":p.value||i.value||b(y)==="fail"||!b(m).length}]),"model-value":k.value,title:e.title,columns:b(m),columnsFieldNames:e.columnsFieldNames,onCancel:t[2]||(t[2]=s=>d.value=!1),onConfirm:G},E({"columns-top":r(()=>[c(e.$slots,"columns-top",{},void 0,!0),i.value||b(y)==="fail"||!b(m).length?(n(),v("div",{key:0,class:"az_select-state"},[i.value?(n(),$(Y,{key:0,color:"#1989fa",size:"28px"})):b(y)==="fail"?(n(),v(U,{key:1},[D("span",{class:"mr-5 az-empty"},"数据加载失败"),z(H,{type:"primary",size:"small",onClick:b(S)},{default:r(()=>[T(" 重新加载 ")]),_:1},8,["onClick"])],64)):c(e.$slots,"empty",{key:2},()=>[D("span",{class:"az-empty"},P(e.emptyText),1)],!0)])):p.value?(n(),v("div",{key:1,class:"az_select-multiple"},[(n(!0),v(U,null,X(b(m),(s,A)=>(n(),$(Z,{center:"",clickable:"",key:s[a.value.value],onClick:q=>K(!h.value.has(s[a.value.value]),s[a.value.value])},{title:r(()=>[c(e.$slots,"option",{option:s,index:A},()=>[T(P(s[a.value.label]),1)],!0)]),"right-icon":r(()=>[e.multiple?(n(),$(Q,{key:0,shape:"square","model-value":h.value.has(s[a.value.value]),"onUpdate:modelValue":q=>K(q,s[a.value.value]),onClick:t[1]||(t[1]=W(()=>{},["stop"]))},null,8,["model-value","onUpdate:modelValue"])):h.value.has(s[a.value.value])?(n(),$(N,{key:1,name:"success",color:"var(--van-primary-color)"})):F("",!0)]),_:2},1032,["onClick"]))),128))])):F("",!0)]),_:2},[e.$slots.option?{name:"option",fn:r((s,A)=>[c(e.$slots,"option",{option:s,index:A},void 0,!0)]),key:"0"}:void 0]),1032,["class","model-value","title","columns","columnsFieldNames"])]),_:3},8,["show"])],64)}}});const Se=j(Ce,[["__scopeId","data-v-d26876eb"]]),je=R({__name:"BackNode",props:{visible:{type:Boolean},processInstanceId:{},taskId:{}},emits:["update:visible","submit"],setup(w,{emit:B}){const o=w,f=B,u=C(),g=C({target:""}),p=ce(o,"visible",f),y=()=>{var i;(i=u.value)==null||i.validate(),f("submit",{target:g.value.target})},m=i=>new Promise(a=>{var l;i==="confirm"?(l=u.value)==null||l.validate().then(()=>{a(!0)}).catch(()=>{a(!1)}):a(!0)}),S=async()=>await ve({processInstanceId:o.processInstanceId,taskId:o.taskId}),I=()=>{var i;g.value.target="",(i=u.value)==null||i.resetValidation()};return(i,a)=>{const l=ae,_=he,d=$e;return n(),$(d,{show:b(p),"onUpdate:show":a[1]||(a[1]=k=>me(p)?p.value=k:null),title:"退回","show-cancel-button":"","confirm-button-text":"确定","before-close":m,onConfirm:y,teleport:"body",onOpen:I},{default:r(()=>[z(_,{ref_key:"ruleFormRef",ref:u},{default:r(()=>[z(l,{inset:""},{default:r(()=>[z(Se,{modelValue:g.value.target,"onUpdate:modelValue":a[0]||(a[0]=k=>g.value.target=k),"on-load-finish":S,columnsFieldNames:{text:"name",value:"nodeId"},label:"退回到",load:S,rules:[{required:!0,message:"请选择需要退回的节点",trigger:"change"}]},null,8,["modelValue"])]),_:1})]),_:1},512)]),_:1},8,["show"])}}});export{je as default};
