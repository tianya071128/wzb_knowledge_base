import{d as O,c as I,dj as P,is as L,o as g,b as f,ad as N,g as R,w as t,h as $,cR as q,cS as M,dl as x,gS as T,x as j,r as V,y as U,sR as h,k as S,i as s,B as v,rC as D,rw as z,l as w,f as Q,bh as G,sS as H,t as K,rr as W,cc as X,sT as Y,sU as Z,sV as ee,Q as le,ac as ae,bm as se,rx as oe,ry as re,_ as te}from"./index-b80d5ef5.js";import{A as C}from"./AzPasswordFormItem-db212711.js";import{_ as de}from"./AccountFormItem.vue_vue_type_script_setup_true_lang-c783353b.js";import{_ as ue}from"./SelectOrg.vue_vue_type_script_setup_true_lang-3e503345.js";const ie=O({__name:"SelectJob",props:{modelValue:{},placeholder:{default:"选择岗位"},multiple:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(_,{emit:c}){const o=_,n=c,m=I({get(){return(Array.isArray(o.modelValue)?[...o.modelValue]:o.modelValue?[o.modelValue]:[]).map(d=>({id:d,type:P.job}))},set(e){var p;e=T(e);let d;o.multiple?d=e.map(b=>b.id):d=(p=e==null?void 0:e[0])==null?void 0:p.id,n("update:modelValue",d)}}),y=I(()=>[{label:"岗位",name:L.jobByOrg}]);return(e,d)=>(g(),f(x,{modelValue:m.value,"onUpdate:modelValue":d[0]||(d[0]=p=>m.value=p),tabsList:y.value,placeholder:e.placeholder,multiple:e.multiple,searchPlaceholder:"搜索岗位",dialogTitle:"岗位列表"},N({_:2},[R(e.$slots||{},(p,b,k)=>({name:b,fn:t(A=>[$(e.$slots,b,q(M(A)))])}))]),1032,["modelValue","tabsList","placeholder","multiple"]))}}),me=()=>{const _=j(),c=V("");return{firstOrgName:c,getOrgName:async n=>{if(n){const m=await _.getOrg(n);c.value=(m==null?void 0:m.name)??"-"}else c.value="-"}}},ne=me,pe=O({__name:"AddAndEditMember",props:{edit:{},isSimple:{type:Boolean}},setup(_,{expose:c}){const o=_,n=I(()=>!!o.edit),m=V(),y={memberId:void 0,nickname:"",username:"",mobile:"",passwordType:W,password:"",idCard:"",email:"",address:"",status:X,leader:"",orgJobIds:[],orgIds:[]},e=V({...y,confirmPass:""}),d=V([]),p=V([]),b=V([]);U(()=>o.edit,()=>{var r;o.edit?(e.value={...o.edit},e.value.leader=((r=o.edit.leader)==null?void 0:r.memberId)??"",e.value.orgJobIds=(o.edit.orgJobList||[]).map(l=>l.id)??[],e.value.orgIds=(o.edit.orgList||[]).map(l=>l.id)??[],d.value=o.edit.leader?[o.edit.leader]:[],p.value=o.edit.orgJobList||[],b.value=o.edit.orgList||[]):(e.value={...y,confirmPass:""},d.value=[],p.value=[],b.value=[])},{immediate:!0});const k=I({set(r){e.value.mobile=r==null?void 0:r.replaceAll(" ","")},get(){return h(e.value.mobile)}}),E={nickname:[{required:!0,message:"姓名不能为空",trigger:"blur"}],mobile:[{required:!0,message:"手机号不能为空",trigger:"blur"},{pattern:Y,message:"请输入正确的手机号码",trigger:"blur"}],passwordType:[{required:!0,message:"请选择密码生成方式",trigger:"change"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{validator:(r,l,u)=>{if(!oe(l))u(new Error(re));else{if(e.value.confirmPass!==""){if(!m.value)return;m.value.validateField("confirmPass",()=>null)}u()}},trigger:"blur"}],confirmPass:[{required:!0,message:"确认密码不能为空",trigger:"blur"},{validator:(r,l,u)=>{l!==e.value.password?u(new Error("两次填写的密码不一致！")):u()},trigger:"blur"}],idCard:[{pattern:Z,message:"身份证号码格式不正确",trigger:"blur"}],email:[{pattern:ee,message:"邮箱格式不正确",trigger:"blur"}],status:[{required:!0,message:"状态不能为空",trigger:"change"}]},{firstOrgName:B,getOrgName:F}=ne();return U(()=>e.value.orgIds,async r=>{F(r==null?void 0:r[0])},{immediate:!0}),c({ruleFormRef:m,form:e}),(r,l)=>{const u=le,i=ae,J=se;return g(),f(J,{model:e.value,rules:E,"label-position":"left","label-width":"120px",ref_key:"ruleFormRef",ref:m},{default:t(()=>[S("div",{class:"form-title"},"基本信息："),s(i,{label:"姓名",prop:"nickname"},{default:t(()=>[s(u,{modelValue:e.value.nickname,"onUpdate:modelValue":l[0]||(l[0]=a=>e.value.nickname=a),placeholder:"请输入姓名",maxlength:"20"},null,8,["modelValue"])]),_:1}),s(de,{modelValue:e.value.username,"onUpdate:modelValue":l[1]||(l[1]=a=>e.value.username=a),label:"账号",prop:"username",inputProps:{disabled:n.value},"no-check":!n.value},null,8,["modelValue","inputProps","no-check"]),n.value?(g(),f(i,{key:1,label:"手机号码",required:""},{default:t(()=>[s(u,{"model-value":v(D)(e.value.mobile),disabled:"",placeholder:"请输入手机号"},null,8,["model-value"])]),_:1})):(g(),f(i,{key:0,label:"手机号码",prop:"mobile"},{default:t(()=>[s(u,{modelValue:k.value,"onUpdate:modelValue":l[2]||(l[2]=a=>k.value=a),formatter:v(h),placeholder:"请输入手机号"},null,8,["modelValue","formatter"])]),_:1})),n.value?w("",!0):(g(),f(i,{key:2,label:"密码",prop:"password"},{default:t(()=>[s(C,{modelValue:e.value.password,"onUpdate:modelValue":l[3]||(l[3]=a=>e.value.password=a),placeholder:v(z),"show-password":""},null,8,["modelValue","placeholder"])]),_:1})),n.value?w("",!0):(g(),f(i,{key:3,label:"确认密码",prop:"confirmPass"},{default:t(()=>[s(C,{modelValue:e.value.confirmPass,"onUpdate:modelValue":l[4]||(l[4]=a=>e.value.confirmPass=a),"show-password":"",placeholder:"请再次输入密码"},null,8,["modelValue"])]),_:1})),r.isSimple?w("",!0):(g(),f(i,{key:4,label:"身份证号码",prop:"idCard"},{default:t(()=>[s(u,{modelValue:e.value.idCard,"onUpdate:modelValue":l[5]||(l[5]=a=>e.value.idCard=a),disabled:e.value.certificateAuthStatus===1,placeholder:"请输入身份证号码",maxlength:"18"},null,8,["modelValue","disabled"])]),_:1})),s(i,{label:"联系邮箱",prop:"email"},{default:t(()=>[s(u,{modelValue:e.value.email,"onUpdate:modelValue":l[6]||(l[6]=a=>e.value.email=a),placeholder:"请输入联系邮箱"},null,8,["modelValue"])]),_:1}),r.isSimple?w("",!0):(g(),f(i,{key:5,label:"联系地址",prop:"address"},{default:t(()=>[s(u,{modelValue:e.value.address,"onUpdate:modelValue":l[7]||(l[7]=a=>e.value.address=a),placeholder:"请输入联系地址"},null,8,["modelValue"])]),_:1})),r.isSimple?w("",!0):(g(),Q("div",{key:6},[S("div",{class:"form-title"},"组织信息："),s(i,{label:"状态",prop:"status"},{default:t(()=>[s(G,{modelValue:e.value.status,"onUpdate:modelValue":l[8]||(l[8]=a=>e.value.status=a)},null,8,["modelValue"])]),_:1}),s(i,{label:"直属主管",prop:"leader"},{default:t(()=>[s(H,{modelValue:e.value.leader,"onUpdate:modelValue":l[9]||(l[9]=a=>e.value.leader=a),placeholder:"选择直属主管","is-member-id":"","init-options":{[v(P).memberSelectMemberId]:d.value}},null,8,["modelValue","init-options"])]),_:1}),s(i,{label:"岗位分配",prop:"orgJobIds"},{default:t(()=>[s(ie,{modelValue:e.value.orgJobIds,"onUpdate:modelValue":l[10]||(l[10]=a=>e.value.orgJobIds=a),multiple:"",placeholder:"选择岗位","init-options":{[v(P).job]:p.value}},null,8,["modelValue","init-options"])]),_:1}),s(i,{label:"所属组织",prop:"orgIds"},{default:t(()=>[s(ue,{modelValue:e.value.orgIds,"onUpdate:modelValue":l[11]||(l[11]=a=>e.value.orgIds=a),multiple:"",drag:"",placeholder:"选择所属组织","init-options":{[v(P).org]:b.value}},null,8,["modelValue","init-options"]),S("span",{class:"tips"},"第一个为主部门，当前主部门为"+K(v(B)),1)]),_:1})]))]),_:1},8,["model"])}}});const Ve=te(pe,[["__scopeId","data-v-599c896c"]]);export{Ve as A,ne as u};
