import{d as g,r as o,vW as v,bx as b,cC as y,o as _,b as x,w as h,f as I,l as k,cr as w,i5 as C,_ as S}from"./index-b80d5ef5.js";import{u as E}from"./useExtractQuery-f96f705c.js";import{s as N,g as P}from"./signature-084c6754.js";const B=g({__name:"routePage",setup(R){const u=E("subId"),t=o(),e=o(),r=o(0),m=async()=>{var s;try{e.value=await P({batchId:((s=t.value)==null?void 0:s.batchId)??""}),r.value>1e3&&(a(),C({title:"提示",message:"获取签章结果失败",type:"error"})),[2,11].includes(Number(e.value.signState))&&a(),r.value++}catch{}},{pause:a,resume:p}=v(m,3e3);return b(async()=>{u.value&&(t.value=await N({subId:u.value}),p())}),y(()=>{a()}),(s,d)=>{var c,n,l,i;const f=w;return[2,11].includes(Number((c=e.value)==null?void 0:c.signState))?(_(),x(f,{key:0,icon:((n=e.value)==null?void 0:n.signState)==2?"success":"error",title:(l=e.value)==null?void 0:l.message},{extra:h(()=>[]),_:1},8,["icon","title"])):t.value?(_(),I("iframe",{key:1,class:"signature_page",src:(i=t.value)==null?void 0:i.signUrl,allow:"camera *;autoplay *;microphone *",frameborder:"0"},null,8,["src"])):k("",!0)}}});const Q=S(B,[["__scopeId","data-v-c795b76f"]]);export{Q as default};
