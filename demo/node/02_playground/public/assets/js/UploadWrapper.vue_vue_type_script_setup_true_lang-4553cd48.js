import{e9 as he,hM as Te,ch as $,cg as we,d as Q,v as le,r as b,c as C,a as p,aO as ne,o as R,f as Z,i as d,w as f,B as s,H as Y,m as W,K as fe,t as Ce,F as J,g as ce,b as j,o3 as De,cj as Ee,bv as te,Y as H,ap as ve,U as se,ao as ye,y as X,a$ as ke,l as ee,k as A,mZ as _e,d0 as ge,eR as ae,a3 as Le,L as Se,o4 as de,C as N,o5 as Pe,aN as Re,fx as Ue,g2 as ze,a8 as xe,Q as Oe,dC as Ae,_ as ue,jG as be,es as Be,o6 as $e,n as Fe,mb as Ne,o7 as We,bK as je,eK as Ke,e as Me,ig as qe,S as He,gY as Ye,mf as ie,o8 as oe,I as Ze}from"./index-b80d5ef5.js";import{_ as Ge}from"./SelectForm.vue_vue_type_script_setup_true_lang-0170236d.js";import{S as Qe}from"./SetFieldDefault-5fc1ae2a.js";import{g as Je,t as Ve,a as Xe,b as el,o as ll,c as me,P as tl}from"./index-c89dfa90.js";import{B as al}from"./ButtonState-cb54910b.js";import{a as il}from"./LoadingData-195d0581.js";import{_ as ol}from"./TemplateCustomEntry.vue_vue_type_script_setup_true_lang-346d01b1.js";const Ie={},nl=Object.assign({"../../field/advancedField/address/pc/SettingPlus.vue":()=>$(()=>import("./SettingPlus-cf88c7a3.js"),["./SettingPlus-cf88c7a3.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./fieldDefaultComponent-58752d9c.js","./AddressBase.vue_vue_type_script_setup_true_lang-d809ffc6.js","./AzCascader.vue_vue_type_style_index_0_lang-adc6a4ab.js","..\\css\\AzCascader-6c13ae3b.css","./useFieldMaxWidth-d82f063e.js","./Base.vue_vue_type_script_setup_true_lang-4fbdbc85.js","./AzDatePicker.vue_vue_type_style_index_0_lang-c5632a92.js","..\\css\\AzDatePicker-bc99fde3.css","./index-318b68f4.js","./DaterangeBase.vue_vue_type_script_setup_true_lang-bec97540.js","./InputBase.vue_vue_type_script_setup_true_lang-ffcf63f1.js","./Base-9b7f3306.js","./index-f0ed738f.js","..\\css\\Base-d864bc02.css","..\\css\\el-checkbox-group-987ef89c.css","./NumberBase.vue_vue_type_script_setup_true_lang-745b39c5.js","./AzInputNumber-d6212644.js","./el-input-number-c15b1cc7.js","..\\css\\el-input-number-3100e046.css","..\\css\\AzInputNumber-7eb04079.css","./Base-c9aa1df0.js","..\\css\\Base-296ba357.css","..\\css\\el-radio-button-bcf791a1.css","./SliderBase.vue_vue_type_script_setup_true_lang-5d73415b.js","..\\css\\SliderBase-5e1d0cc8.css","./TextareaBase.vue_vue_type_script_setup_true_lang-7091b2cb.js","./TimeBase.vue_vue_type_script_setup_true_lang-ea537bf3.js","./AzTimePicker.vue_vue_type_style_index_0_lang-3726374e.js","..\\css\\AzTimePicker-c7c3a174.css","./TimerangeBase.vue_vue_type_script_setup_true_lang-0827c241.js","./UploadFileBase.vue_vue_type_script_setup_true_lang-0c253daa.js","./UploadImgBase.vue_vue_type_script_setup_true_lang-d23c1306.js","./CooperateEnterpriseBase.vue_vue_type_script_setup_true_lang-23720971.js","./useMultipleVal-904406c1.js","./CooperatePersonnelBase.vue_vue_type_script_setup_true_lang-adcd0db7.js","./Base.vue_vue_type_script_setup_true_lang-0e9a0e2c.js","./Base.vue_vue_type_script_setup_true_lang-aa25657d.js","./CascaderBase.vue_vue_type_style_index_0_lang-83862970.js","..\\css\\CascaderBase-b08fbeae.css","./Base.vue_vue_type_script_setup_true_lang-03820366.js","./el-dropdown-item-455a6589.js","..\\css\\el-dropdown-item-ee6896fd.css","./CardShowFieldItem-fd24f218.js","..\\css\\CardShowFieldItem-2ebcfade.css","..\\css\\Base-0cce8938.css","..\\css\\fieldDefaultComponent-87a40bf5.css","./FieldValidateEditorPlus.vue_vue_type_script_setup_true_lang-afaa3bca.js","..\\css\\FieldValidateEditorPlus-35e12a91.css"],import.meta.url),"../../field/basicField/date/pc/SettingPlus.vue":()=>$(()=>import("./SettingPlus-fef5855d.js"),["./SettingPlus-fef5855d.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./AzDatePicker.vue_vue_type_style_index_0_lang-c5632a92.js","..\\css\\AzDatePicker-bc99fde3.css","./index-318b68f4.js","./FieldValidateEditorPlus.vue_vue_type_script_setup_true_lang-afaa3bca.js","..\\css\\FieldValidateEditorPlus-35e12a91.css"],import.meta.url),"../../field/basicField/input/pc/SettingPlus.vue":()=>$(()=>import("./SettingPlus-fb080f50.js"),["./SettingPlus-fb080f50.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./TipTooltip-b2409537.js","..\\css\\TipTooltip-388ddfb4.css","./fieldDefaultComponent-58752d9c.js","./AddressBase.vue_vue_type_script_setup_true_lang-d809ffc6.js","./AzCascader.vue_vue_type_style_index_0_lang-adc6a4ab.js","..\\css\\AzCascader-6c13ae3b.css","./useFieldMaxWidth-d82f063e.js","./Base.vue_vue_type_script_setup_true_lang-4fbdbc85.js","./AzDatePicker.vue_vue_type_style_index_0_lang-c5632a92.js","..\\css\\AzDatePicker-bc99fde3.css","./index-318b68f4.js","./DaterangeBase.vue_vue_type_script_setup_true_lang-bec97540.js","./InputBase.vue_vue_type_script_setup_true_lang-ffcf63f1.js","./Base-9b7f3306.js","./index-f0ed738f.js","..\\css\\Base-d864bc02.css","..\\css\\el-checkbox-group-987ef89c.css","./NumberBase.vue_vue_type_script_setup_true_lang-745b39c5.js","./AzInputNumber-d6212644.js","./el-input-number-c15b1cc7.js","..\\css\\el-input-number-3100e046.css","..\\css\\AzInputNumber-7eb04079.css","./Base-c9aa1df0.js","..\\css\\Base-296ba357.css","..\\css\\el-radio-button-bcf791a1.css","./SliderBase.vue_vue_type_script_setup_true_lang-5d73415b.js","..\\css\\SliderBase-5e1d0cc8.css","./TextareaBase.vue_vue_type_script_setup_true_lang-7091b2cb.js","./TimeBase.vue_vue_type_script_setup_true_lang-ea537bf3.js","./AzTimePicker.vue_vue_type_style_index_0_lang-3726374e.js","..\\css\\AzTimePicker-c7c3a174.css","./TimerangeBase.vue_vue_type_script_setup_true_lang-0827c241.js","./UploadFileBase.vue_vue_type_script_setup_true_lang-0c253daa.js","./UploadImgBase.vue_vue_type_script_setup_true_lang-d23c1306.js","./CooperateEnterpriseBase.vue_vue_type_script_setup_true_lang-23720971.js","./useMultipleVal-904406c1.js","./CooperatePersonnelBase.vue_vue_type_script_setup_true_lang-adcd0db7.js","./Base.vue_vue_type_script_setup_true_lang-0e9a0e2c.js","./Base.vue_vue_type_script_setup_true_lang-aa25657d.js","./CascaderBase.vue_vue_type_style_index_0_lang-83862970.js","..\\css\\CascaderBase-b08fbeae.css","./Base.vue_vue_type_script_setup_true_lang-03820366.js","./el-dropdown-item-455a6589.js","..\\css\\el-dropdown-item-ee6896fd.css","./CardShowFieldItem-fd24f218.js","..\\css\\CardShowFieldItem-2ebcfade.css","..\\css\\Base-0cce8938.css","..\\css\\fieldDefaultComponent-87a40bf5.css","./utils-fa734101.js","./FieldValidateEditorPlus.vue_vue_type_script_setup_true_lang-afaa3bca.js","..\\css\\FieldValidateEditorPlus-35e12a91.css"],import.meta.url),"../../field/basicField/multiple/pc/SettingPlus.vue":()=>$(()=>import("./SettingPlus-a6e655c6.js"),["./SettingPlus-a6e655c6.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./SelectDisplayEditorPlus.vue_vue_type_script_setup_true_lang-fafaad75.js","./FieldValidateEditorPlus.vue_vue_type_script_setup_true_lang-afaa3bca.js","..\\css\\FieldValidateEditorPlus-35e12a91.css","./SelectDict.vue_vue_type_script_setup_true_lang-83251d28.js","./EditorDraggable-a06dbc71.js","..\\css\\EditorDraggable-dd6eb3a0.css","./TipTooltip-b2409537.js","..\\css\\TipTooltip-388ddfb4.css","..\\css\\SelectDisplayEditorPlus-afd8e63f.css","..\\css\\el-radio-button-bcf791a1.css"],import.meta.url),"../../field/basicField/number/pc/SettingPlus.vue":()=>$(()=>import("./SettingPlus-ef0cf227.js"),["./SettingPlus-ef0cf227.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./AzInputNumber-d6212644.js","./el-input-number-c15b1cc7.js","..\\css\\el-input-number-3100e046.css","..\\css\\AzInputNumber-7eb04079.css","./fieldDefaultComponent-58752d9c.js","./AddressBase.vue_vue_type_script_setup_true_lang-d809ffc6.js","./AzCascader.vue_vue_type_style_index_0_lang-adc6a4ab.js","..\\css\\AzCascader-6c13ae3b.css","./useFieldMaxWidth-d82f063e.js","./Base.vue_vue_type_script_setup_true_lang-4fbdbc85.js","./AzDatePicker.vue_vue_type_style_index_0_lang-c5632a92.js","..\\css\\AzDatePicker-bc99fde3.css","./index-318b68f4.js","./DaterangeBase.vue_vue_type_script_setup_true_lang-bec97540.js","./InputBase.vue_vue_type_script_setup_true_lang-ffcf63f1.js","./Base-9b7f3306.js","./index-f0ed738f.js","..\\css\\Base-d864bc02.css","..\\css\\el-checkbox-group-987ef89c.css","./NumberBase.vue_vue_type_script_setup_true_lang-745b39c5.js","./Base-c9aa1df0.js","..\\css\\Base-296ba357.css","..\\css\\el-radio-button-bcf791a1.css","./SliderBase.vue_vue_type_script_setup_true_lang-5d73415b.js","..\\css\\SliderBase-5e1d0cc8.css","./TextareaBase.vue_vue_type_script_setup_true_lang-7091b2cb.js","./TimeBase.vue_vue_type_script_setup_true_lang-ea537bf3.js","./AzTimePicker.vue_vue_type_style_index_0_lang-3726374e.js","..\\css\\AzTimePicker-c7c3a174.css","./TimerangeBase.vue_vue_type_script_setup_true_lang-0827c241.js","./UploadFileBase.vue_vue_type_script_setup_true_lang-0c253daa.js","./UploadImgBase.vue_vue_type_script_setup_true_lang-d23c1306.js","./CooperateEnterpriseBase.vue_vue_type_script_setup_true_lang-23720971.js","./useMultipleVal-904406c1.js","./CooperatePersonnelBase.vue_vue_type_script_setup_true_lang-adcd0db7.js","./Base.vue_vue_type_script_setup_true_lang-0e9a0e2c.js","./Base.vue_vue_type_script_setup_true_lang-aa25657d.js","./CascaderBase.vue_vue_type_style_index_0_lang-83862970.js","..\\css\\CascaderBase-b08fbeae.css","./Base.vue_vue_type_script_setup_true_lang-03820366.js","./el-dropdown-item-455a6589.js","..\\css\\el-dropdown-item-ee6896fd.css","./CardShowFieldItem-fd24f218.js","..\\css\\CardShowFieldItem-2ebcfade.css","..\\css\\Base-0cce8938.css","..\\css\\fieldDefaultComponent-87a40bf5.css","./FieldValidateEditorPlus.vue_vue_type_script_setup_true_lang-afaa3bca.js","..\\css\\FieldValidateEditorPlus-35e12a91.css","..\\css\\SettingPlus-149cf0e0.css"],import.meta.url),"../../field/basicField/radio/pc/SettingPlus.vue":()=>$(()=>import("./SettingPlus-c6911f11.js"),["./SettingPlus-c6911f11.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./SelectDisplayEditorPlus.vue_vue_type_script_setup_true_lang-fafaad75.js","./FieldValidateEditorPlus.vue_vue_type_script_setup_true_lang-afaa3bca.js","..\\css\\FieldValidateEditorPlus-35e12a91.css","./SelectDict.vue_vue_type_script_setup_true_lang-83251d28.js","./EditorDraggable-a06dbc71.js","..\\css\\EditorDraggable-dd6eb3a0.css","./TipTooltip-b2409537.js","..\\css\\TipTooltip-388ddfb4.css","..\\css\\SelectDisplayEditorPlus-afd8e63f.css","..\\css\\el-radio-button-bcf791a1.css"],import.meta.url),"../../field/basicField/uploadImg/pc/SettingPlus.vue":()=>$(()=>import("./SettingPlus-5a9ee6ee.js"),["./SettingPlus-5a9ee6ee.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./AzInputNumber-d6212644.js","./el-input-number-c15b1cc7.js","..\\css\\el-input-number-3100e046.css","..\\css\\AzInputNumber-7eb04079.css","./FieldValidateEditorPlus.vue_vue_type_script_setup_true_lang-afaa3bca.js","..\\css\\FieldValidateEditorPlus-35e12a91.css"],import.meta.url),"../../field/relationField/subform/pc/SettingPlus.vue":()=>$(()=>import("./SettingPlus-35d43afa.js"),["./SettingPlus-35d43afa.js","./index-b80d5ef5.js","..\\css\\index-13cb634b.css","./FieldValidateEditorPlus.vue_vue_type_script_setup_true_lang-afaa3bca.js","..\\css\\FieldValidateEditorPlus-35e12a91.css","./fieldDefaultComponent-58752d9c.js","./AddressBase.vue_vue_type_script_setup_true_lang-d809ffc6.js","./AzCascader.vue_vue_type_style_index_0_lang-adc6a4ab.js","..\\css\\AzCascader-6c13ae3b.css","./useFieldMaxWidth-d82f063e.js","./Base.vue_vue_type_script_setup_true_lang-4fbdbc85.js","./AzDatePicker.vue_vue_type_style_index_0_lang-c5632a92.js","..\\css\\AzDatePicker-bc99fde3.css","./index-318b68f4.js","./DaterangeBase.vue_vue_type_script_setup_true_lang-bec97540.js","./InputBase.vue_vue_type_script_setup_true_lang-ffcf63f1.js","./Base-9b7f3306.js","./index-f0ed738f.js","..\\css\\Base-d864bc02.css","..\\css\\el-checkbox-group-987ef89c.css","./NumberBase.vue_vue_type_script_setup_true_lang-745b39c5.js","./AzInputNumber-d6212644.js","./el-input-number-c15b1cc7.js","..\\css\\el-input-number-3100e046.css","..\\css\\AzInputNumber-7eb04079.css","./Base-c9aa1df0.js","..\\css\\Base-296ba357.css","..\\css\\el-radio-button-bcf791a1.css","./SliderBase.vue_vue_type_script_setup_true_lang-5d73415b.js","..\\css\\SliderBase-5e1d0cc8.css","./TextareaBase.vue_vue_type_script_setup_true_lang-7091b2cb.js","./TimeBase.vue_vue_type_script_setup_true_lang-ea537bf3.js","./AzTimePicker.vue_vue_type_style_index_0_lang-3726374e.js","..\\css\\AzTimePicker-c7c3a174.css","./TimerangeBase.vue_vue_type_script_setup_true_lang-0827c241.js","./UploadFileBase.vue_vue_type_script_setup_true_lang-0c253daa.js","./UploadImgBase.vue_vue_type_script_setup_true_lang-d23c1306.js","./CooperateEnterpriseBase.vue_vue_type_script_setup_true_lang-23720971.js","./useMultipleVal-904406c1.js","./CooperatePersonnelBase.vue_vue_type_script_setup_true_lang-adcd0db7.js","./Base.vue_vue_type_script_setup_true_lang-0e9a0e2c.js","./Base.vue_vue_type_script_setup_true_lang-aa25657d.js","./CascaderBase.vue_vue_type_style_index_0_lang-83862970.js","..\\css\\CascaderBase-b08fbeae.css","./Base.vue_vue_type_script_setup_true_lang-03820366.js","./el-dropdown-item-455a6589.js","..\\css\\el-dropdown-item-ee6896fd.css","./CardShowFieldItem-fd24f218.js","..\\css\\CardShowFieldItem-2ebcfade.css","..\\css\\Base-0cce8938.css","..\\css\\fieldDefaultComponent-87a40bf5.css"],import.meta.url)});Object.entries(nl).forEach(([o,c])=>{const r=o.split(he.sep),V=r[r.length-3];let a=c;a=a.default||a,Ie[V]=we(a)});function sl(o){let c=Ie[o]??null;return Te(c)==="module"&&(c=c.default),c||console.error(`你需要查找控件类型为${o}的配置组件, 但是并没有找到, 请检查一下是否存在该类型, 或者组件路径存在问题`),c}const dl=Q({__name:"CustromConfig",props:{modelValue:{}},emits:["update:modelValue"],setup(o,{emit:c}){const a=le(o,"modelValue",c),m=b(!1),n=b(a.value),v=_=>sl(_),I=()=>{var _,y;m.value=!0,n.value=H(a.value),n.value.config||(n.value.config=ne(t.value)??void 0,n.value.config.fieldId=a.value.fieldId),((_=n.value.config)==null?void 0:_.type)===p.subform&&(n.value.config.fields=((y=Je(Ve(n.value)))==null?void 0:y.fields)??[])},h=C(()=>n.value.fieldType===p.uploadImg?[{label:"图片",value:p.uploadImg}]:n.value.fieldType===p.subform?[{label:"子表单",value:p.subform}]:n.value.fieldType===p.radio?[{label:"单选",value:p.radio},{label:"多选",value:p.multiple}]:[{label:"文本",value:p.input},{label:"数值",value:p.number},{label:"日期",value:p.date},{label:"单选",value:p.radio},{label:"多选",value:p.multiple},{label:"地址",value:p.address}]),t=C({get(){var _;return((_=n.value.config)==null?void 0:_.type)??n.value.fieldType??p.input},set(_){n.value.config=ne(_)}}),g=b(!1),k=b(),T=async()=>{var _,y,z;g.value=!0;try{await((y=(_=k.value)==null?void 0:_.ruleFormRef)==null?void 0:y.validate());const L=n.value;((z=L.config)==null?void 0:z.type)===p.subform&&(L.config.fields=[]),a.value={...L},m.value=!1}finally{g.value=!1}};return(_,y)=>{const z=ye,L=ve,O=se;return R(),Z(J,null,[d(Y,{"hide-label":"",style:{flex:"1"}},{default:f(()=>{var D;return[d(al,{onClick:I,text:"设置","is-set":!!((D=s(a))!=null&&D.config)},null,8,["is-set"])]}),_:1}),d(te,{modelValue:m.value,"onUpdate:modelValue":y[2]||(y[2]=D=>m.value=D),title:"设置属性","append-to-body":"",size:"400"},{footer:f(()=>[d(O,{onClick:y[1]||(y[1]=D=>m.value=!1)},{default:f(()=>[W("取消")]),_:1}),d(O,{type:"primary",onClick:T,loading:g.value},{default:f(()=>[W(" 确定 ")]),_:1},8,["loading"])]),default:f(()=>[d(fe,{model:n.value.config,ref_key:"azForm",ref:k,"label-position":"top"},{default:f(()=>[d(Y,{label:"字段名称"},{default:f(()=>{var D;return[W(Ce((D=s(a))==null?void 0:D.label),1)]}),_:1}),d(Y,{label:"字段类型"},{default:f(()=>[d(L,{modelValue:t.value,"onUpdate:modelValue":y[0]||(y[0]=D=>t.value=D),placeholder:"请选择",disabled:[s(p).uploadImg,s(p).subform].includes(t.value)},{default:f(()=>[(R(!0),Z(J,null,ce(h.value,(D,E)=>(R(),j(z,{key:E,label:D.label,value:D.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),(R(),j(Ee(v(t.value)),{field:n.value.config,key:t.value,mode:s(De).simple,isParse:""},null,8,["field","mode"]))]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}}),ul=Q({__name:"TemplateDesigner",props:{modelValue:{type:Boolean},file:{},appId:{},entryId:{},fields:{},field:{}},emits:["update:modelValue","update:file"],setup(o,{emit:c}){const r=o,V=c,a=le(r,"modelValue",V),m=b(),n=b(),v=b(),I=b(),h=Xe(),t=b(H(h)),g={entryId:[{required:!0,message:"请选择",trigger:"change"}],outputFormat:[{required:!0,message:"请选择",trigger:"change"}],outputFileFieldId:[{required:!0,message:"请选择",trigger:"change"}]},k=C(()=>t.value.entryId===r.entryId?void 0:t.value.entryId),T=C(()=>t.value.entryId===r.entryId?r.fields:void 0),_=async()=>{var u;const e=await Pe(((u=m.value)==null?void 0:u.response)??"");function l(F,B){var q;const w=H(B.find(i=>i.name===F.name&&i.type===F.type));return!w||w.type!==F.type?F:((w==null?void 0:w.defaultType)===ae.custom&&(w.defaultType="config",w.config=ne(me(w.type)),w.config.options.defaultValue.custom=w.customDefault,delete w.customDefault),F.type===tl.subform&&(w.list=((q=F.list)==null?void 0:q.map(i=>l(i,w.list??[])))??[]),w.type=F.type,w)}t.value.pointList=(e.pointList??[]).map(F=>l(F,t.value.pointList))};X(a,e=>{var l;e&&(m.value=H(r.file),t.value=H(((l=r.file)==null?void 0:l.options)??{...h,entryId:r.entryId}))},{immediate:!0});const y={blockFilter(e){return e.type===p.subform},excludeFilter(e){return e.type!==p.uploadFile}},z=e=>e.map(l=>({...l,name:l.id===r.entryId?"当前表单":l.name})),L=e=>{e.forEach(l=>{var u;l.currentFieldId&&(l.currentFieldId=void 0,l.currentFieldType=void 0),(u=l.list)!=null&&u.length&&L(l.list)})},O=()=>{t.value.outputFileFieldId="",L(t.value.pointList)},D=async()=>{var e,l,u;if(r.file)try{await Promise.all([(l=(e=v.value)==null?void 0:e.ruleFormRef)==null?void 0:l.validate(),(u=I.value)==null?void 0:u.validate()]),V("update:file",{...m.value??r.file,options:t.value}),a.value=!1}catch{Re.error("配置异常, 请检查您的配置!")}};function E(e,l){var F;const u={...Ue(e,["list","name","type"]),fieldId:`${e.name}`,fieldType:me(e.type),defaultType:e.defaultType??(l==null?void 0:l.defaultType)??ae.currentField};return u.fieldType===p.subform&&(u.child=(F=e.list)==null?void 0:F.map(B=>E(B,e))),u}const S=C({get(){return t.value.pointList.map(e=>E(e))},set(e){t.value.pointList=e.map(l=>Ve(l))}}),K=C(()=>el(t.value.pointList)),M=e=>{var w,q;let l=e.fields??[];const u=e.fieldInfo.fieldType??p.input,F=[p.subform,p.uploadImg,p.uploadFile],B=(w=e.parent)==null?void 0:w.currentFieldId;if(B){const i=(q=ze(B,l))==null?void 0:q.field;(i==null?void 0:i.type)===p.subform&&(l=i.fields.map(U=>{const G=H(U);return G.options.label=`${i.options.label}.${G.options.label}`,G}))}return xe(l,{blockFilter(i){return u!==p.subform&&i.type===p.subform},excludeFilter(i,U){return F.includes(u)?i.type!==u:[p.radio,p.multiple].includes(u)?![p.radio,p.multiple].includes(i.type):F.includes(i.type)||!(U!=null&&U.isFormItem)}})},P=b(),x=b();X(x,()=>{var e,l,u;x.value&&((e=x.value)==null?void 0:e.response)!==((l=m.value)==null?void 0:l.response)&&(m.value={...x.value,options:t.value},(u=n.value)==null||u.reload()),setTimeout(()=>{x.value=void 0},100)});const re=async()=>{var e;(e=P.value)==null||e.uploadFile()},pe=C(()=>{var l,u;return(u=(l=P.value)==null?void 0:l.fileList)==null?void 0:u.some(F=>F.status&&F.status!=="success")});return(e,l)=>{const u=se,F=Oe,B=Ae,w=ye,q=ve;return R(),j(te,{modelValue:s(a),"onUpdate:modelValue":l[6]||(l[6]=i=>N(a)?a.value=i:null),"destroy-on-close":"",size:"90%","append-to-body":"",direction:"btt",title:"设计",class:"template_designer-drawer"},{footer:f(()=>{var i;return[((i=n.value)==null?void 0:i.state)===s(ke).success?(R(),Z("div",{key:0,style:{"text-align":"left"}},[d(u,{type:"primary",onClick:D},{default:f(()=>[W("确定")]),_:1}),d(u,{onClick:l[5]||(l[5]=U=>a.value=!1)},{default:f(()=>[W("取消")]),_:1})])):ee("",!0)]}),default:f(()=>[A("div",{class:"template_designer"},[A("div",{class:"template_designer-header"},[A("div",{class:"header-left"},"模板变量设置"),A("div",{class:"header-right"},"模板文件预览"),d(u,{class:"header-btn",type:"primary",link:"",onClick:re,loading:pe.value},{default:f(()=>[W(" 更新文件 ")]),_:1},8,["loading"]),d(ge,{modelValue:x.value,"onUpdate:modelValue":l[0]||(l[0]=i=>x.value=i),limit:1,size:s(_e)(e.field.options),accept:["doc","docx"],type:"file",ref_key:"azUploadWrapperRef",ref:P,isCustom:""},null,8,["modelValue","size"])]),m.value?(R(),Z("div",{key:0,class:"template_designer-contnet"},[d(Se,{load:_,class:"contnet-left",ref_key:"loadingDataRef",ref:n},{default:f(()=>[d(fe,{ref_key:"azFormRef",ref:v,model:t.value,rules:g,"label-position":"top"},{default:f(()=>[d(Y,{label:"参数值来源",prop:"entryId"},{default:f(()=>[d(Ge,{modelValue:t.value.entryId,"onUpdate:modelValue":l[1]||(l[1]=i=>t.value.entryId=i),style:{width:"70%"},appId:e.appId,filter:z,onChange:O},null,8,["modelValue","appId"])]),_:1}),d(Y,null,{default:f(()=>[d(Qe,{modelValue:S.value,"onUpdate:modelValue":l[2]||(l[2]=i=>S.value=i),ref_key:"setFieldDefaultRef",ref:I,leftFields:K.value,customTypeList:[{label:"取字段",value:s(ae).currentField}],externalTypeList:[{label:"自定义",value:"config",childFollow:["config"]}],rightEntryId:k.value,rightFields:T.value,maxHeight:null,required:!1,isAdd:!1,isDelete:!1,isParse:!1,leftFieldColumnName:"参数名",rightFieldColumnName:"参数值",customRightFields:M,leftFieldColumnWidth:"150"},{"prep-column":f(()=>[d(B,{prop:"fieldName",label:"名称",width:"150","class-name":"current-field"},{default:f(({row:i})=>[d(F,{modelValue:i.label,"onUpdate:modelValue":U=>i.label=U,placeholder:"请输入"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),"external-type-set":f(({data:i,onUpdateData:U})=>[d(dl,{"model-value":i,"onUpdate:modelValue":G=>U(G)},null,8,["model-value","onUpdate:modelValue"])]),_:1},8,["modelValue","leftFields","customTypeList","rightEntryId","rightFields"])]),_:1}),d(Y,{label:"输出文件格式",prop:"outputFormat"},{default:f(()=>[d(q,{modelValue:t.value.outputFormat,"onUpdate:modelValue":l[3]||(l[3]=i=>t.value.outputFormat=i),style:{width:"70%"},placeholder:"请选择"},{default:f(()=>[(R(!0),Z(J,null,ce(s(ll),(i,U)=>(R(),j(w,{key:U,label:i.label,value:i.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),d(Y,{label:"输出文件填充到",prop:"outputFileFieldId"},{default:f(()=>[d(Le,{modelValue:t.value.outputFileFieldId,"onUpdate:modelValue":l[4]||(l[4]=i=>t.value.outputFileFieldId=i),style:{width:"70%"},entryId:k.value,fields:T.value,filterOptions:y,placeholder:"选择输出文件控件"},null,8,["modelValue","entryId","fields"])]),_:1})]),_:1},8,["model"])]),_:1},512),A("div",{class:"contnet-right"},[d(de,{modelValue:!0,isEmbed:"",options:{list:[m.value]}},null,8,["options"])])])):ee("",!0)])]),_:1},8,["modelValue"])}}});const rl=ue(ul,[["__scopeId","data-v-8666d072"]]);function pl(o){const c=be(),r=b(),V=C(()=>{var v;const m={...o.file,response:"",name:"",type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",url:`data:application/vnd.openxmlformats-officedocument.wordprocessingml.document;base64,${r.value}`},n=((v=o.file)==null?void 0:v.name.split("."))??[];return m.name=n.splice(0,n.length-1).join(".")+".docx",m});return{handleLoad:async()=>{if(!c)return;const m=c.packageData(void 0,Be(c.totalFields).filter(v=>v.type===p.templateFile&&v.fieldId!==o.field.fieldId).map(v=>v.fieldId));o.previewTemplateFile&&m.forEach(v=>{v.fieldId===o.field.fieldId&&(v.value=$e.setFormat(Fe(o.previewTemplateFile),o.field))});const n=Ne(m,c.entryId);n.tableNames=void 0,r.value=await We(n)},previewFile:V}}const ml=Q({__name:"TemplatePreview",props:{modelValue:{type:Boolean},field:{},file:{}},emits:["update:modelValue"],setup(o,{emit:c}){const r=o,a=le(r,"modelValue",c),{handleLoad:m,previewFile:n}=pl(je({...Ke(r)}));return(v,I)=>{const h=il;return R(),j(te,{modelValue:s(a),"onUpdate:modelValue":I[0]||(I[0]=t=>N(a)?a.value=t:null),"destroy-on-close":"",size:"90%","append-to-body":"",direction:"btt",title:"预览"},{default:f(()=>[d(h,{load:s(m),class:"preview-template",ref:"loadingDataRef"},{default:f(()=>[d(de,{modelValue:!0,isEmbed:"",options:{list:[s(n)]}},null,8,["options"])]),_:1},8,["load"])]),_:1},8,["modelValue"])}}});const fl=ue(ml,[["__scopeId","data-v-30145721"]]);function cl(o,c){const r=le(o,"modelValue",c),V=b({});X(r,()=>{var I;r.value&&(V.value=H((I=o.file)==null?void 0:I.customData)??{})},{immediate:!0});const a=b(),m=()=>({...o.file,customData:V.value});return{templateCustomEntry:a,visible:r,handleSave:async()=>{var I,h;o.file&&(await((h=(I=a.value)==null?void 0:I.formRender)==null?void 0:h.validate()),c("update:file",m()),r.value=!1)},handlePreview:()=>{c("preview",m())},customData:V}}const vl=Q({__name:"TemplateEntry",props:{modelValue:{type:Boolean},field:{},file:{}},emits:["update:modelValue","update:file","preview"],setup(o,{emit:c}){const r=o,V=c,{visible:a,handleSave:m,customData:n,templateCustomEntry:v}=cl(r,V),I=b(),h=C(()=>{var t;return(t=I.value)==null?void 0:t.collapse});return X([h,()=>{var t,g;return(g=(t=v.value)==null?void 0:t.formRender)==null?void 0:g.render},a],()=>{var t,g,k,T;(g=(t=v.value)==null?void 0:t.formRender)!=null&&g.render&&a.value&&((T=(k=v.value)==null?void 0:k.formRender)==null||T.render.setAllFieldSpan(h.value?24:12))},{immediate:!0}),(t,g)=>{const k=se;return R(),j(te,{modelValue:s(a),"onUpdate:modelValue":g[2]||(g[2]=T=>N(a)?a.value=T:null),"destroy-on-close":"",size:"90%","append-to-body":"",direction:"btt",title:"填写",class:"template_entry-drawer"},{footer:f(()=>[A("div",{style:{"text-align":"left"}},[d(k,{type:"primary",onClick:s(m)},{default:f(()=>[W("保存")]),_:1},8,["onClick"]),d(k,{onClick:g[1]||(g[1]=T=>a.value=!1)},{default:f(()=>[W("取消")]),_:1})])]),default:f(()=>{var T,_;return[A("div",{class:"template_entry"},[A("div",{class:"template_entry-left"},[s(a)?(R(),j(ol,{key:0,ref_key:"templateCustomEntry",ref:v,modelValue:s(n),"onUpdate:modelValue":g[0]||(g[0]=y=>N(n)?n.value=y:null),"point-list":(_=(T=t.file)==null?void 0:T.options)==null?void 0:_.pointList,"entry-id":t.field.entryId},null,8,["modelValue","point-list","entry-id"])):ee("",!0)]),d(qe,{class:"template_entry-right",width:{normal:"calc(100vw - 600px)",collapse:"20px"},checkWindowSizw:!1,position:"right",isCollapseWidthZero:!1,ref_key:"azCollapseContainerRef",ref:I},{default:f(({collapse:y})=>[Me(A("div",{style:{height:"100%"}},[t.file?(R(),j(de,{key:0,modelValue:!0,isEmbed:"",options:{list:[t.file]}},null,8,["options"])):ee("",!0)],512),[[He,y]])]),_:1},8,["width"])])]}),_:1},8,["modelValue"])}}});const yl=ue(vl,[["__scopeId","data-v-6e8d3531"]]);function _l(o,c,r){const V=Ye(),a=be(),m=C({get(){var e;return(e=o.modelValue)==null?void 0:e[0]},set(e){const l=Fe(e);c("update:modelValue",l)}}),n=C(()=>o.isDesigner?V.appId:a.appId),v=C(()=>o.isDesigner?V.entryId:a.entryId),I=C(()=>o.isDesigner?V.totalFields:a.totalFields),h=e=>o.auth?o.auth.includes(e):o.isDesigner?o.field.options[e]??o.field.options.edit:a.getFieldAuth(o.field.fieldId,e),t=C(()=>h("add_template")),g=C(()=>h("delete_template")),k=C(()=>h("design_template")),T=C(()=>h("entry_template")),_=C(()=>h("preview_template")),y=C(()=>{const e=[];return k.value&&!(r!=null&&r.isMobile)&&e.push({id:"1",btnConfig:{type:ie.primary,style:oe.link,name:"模板设计"},onClick(l,u){L.value=!0,O.value=(u==null?void 0:u.index)??0}}),T.value&&e.push({id:"3",btnConfig:{type:ie.primary,style:oe.link,name:"填写"},onClick(l,u){P.value=!0,x.value=(u==null?void 0:u.index)??0}}),_.value&&e.push({id:"2",btnConfig:{type:ie.primary,style:oe.link,name:"预览"},onClick(l){M(l)}}),e}),z=C(()=>y.value.length>1?2:y.value.length===1?1:void 0),L=b(!1),O=b(0),D=e=>{m.value=e},E=b(!1),S=b(),K=b(),M=(e,l)=>{E.value=!0,S.value=e,K.value=l!=null&&l.isCustom?e:void 0},P=b(!1),x=b(0);return{normlList:m,fileOperate:y,btnNum:z,designerVisible:L,designerIndex:O,handleConfirm:D,appId:n,entryId:v,fields:I,previewVisible:E,previewFile:S,add_template:t,delete_template:g,design_template:k,entry_template:T,preview_template:_,entryVisible:P,entryIndex:x,handleCustomData:e=>{m.value=e},handleEntryPreview:e=>{M(e,{isCustom:!0})},previewTemplateFile:K}}const wl=Q({inheritAttrs:!1,__name:"UploadWrapper",props:{field:{},modelValue:{},auth:{},isDesigner:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(o,{emit:c}){const r=o,V=c,{normlList:a,fileOperate:m,btnNum:n,designerVisible:v,designerIndex:I,handleConfirm:h,appId:t,entryId:g,fields:k,previewVisible:T,previewFile:_,add_template:y,delete_template:z,entryVisible:L,entryIndex:O,handleCustomData:D}=_l(r,V);return(E,S)=>{var K,M;return R(),Z(J,null,[d(ge,Ze({modelValue:s(a),"onUpdate:modelValue":S[0]||(S[0]=P=>N(a)?a.value=P:null),limit:1,otherOperate:s(m),btnConfig:E.field.options.btnConfig,type:"file",listType:"picture",showSizeTip:E.field.options.size!=null,size:s(_e)(E.field.options),accept:["docx"],readonly:!s(y)&&!s(z),btnNum:s(n),hideDelete:!s(z),isShowTrigger:s(y),isShowTip:s(y)},E.$attrs),null,16,["modelValue","otherOperate","btnConfig","showSizeTip","size","readonly","btnNum","hideDelete","isShowTrigger","isShowTip"]),d(rl,{modelValue:s(v),"onUpdate:modelValue":S[1]||(S[1]=P=>N(v)?v.value=P:null),file:(K=E.modelValue)==null?void 0:K[s(I)],"onUpdate:file":s(h),appId:s(t),entryId:s(g),fields:s(k),field:E.field},null,8,["modelValue","file","onUpdate:file","appId","entryId","fields","field"]),d(fl,{modelValue:s(T),"onUpdate:modelValue":S[2]||(S[2]=P=>N(T)?T.value=P:null),field:E.field,file:s(_)},null,8,["modelValue","field","file"]),d(yl,{modelValue:s(L),"onUpdate:modelValue":S[3]||(S[3]=P=>N(L)?L.value=P:null),field:E.field,file:(M=E.modelValue)==null?void 0:M[s(O)],"onUpdate:file":s(D)},null,8,["modelValue","field","file","onUpdate:file"])],64)}}});export{wl as _};
