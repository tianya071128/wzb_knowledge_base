import{d as Pe,ci as ke,c as Ee,rE as Ae,bx as Le,o as Me,f as xe}from"./index-b80d5ef5.js";const T=typeof window<"u"?window:void 0,b=typeof document<"u"?document:void 0,p=typeof navigator<"u"?navigator:void 0,P=typeof location<"u"?location:void 0;function Re(){return(P==null?void 0:P.href)||""}const y=(p==null?void 0:p.userAgent)||"",We=(p==null?void 0:p.platform)||"";var we;(we=y==null?void 0:y.match(/wxwork\/([\d.]+)/i))==null||we[1];Ie();function Ie(){const e=(p==null?void 0:p.maxTouchPoints)??1,t=/Mac/i.test(We);return t&&e>2?{isMac:!1,isIOS:!0}:{isMac:t,isIOS:/\b(iPhone|iPad|iPod)\b/i.test(y)}}const Oe={config:"preVerifyJsApi",onMenuShareTimeline:"menu:share:timeline",onMenuShareAppMessage:"menu:share:appmessage",onMenuShareWechat:"menu:share:wechat",onMenuShareQQ:"menu:share:qq",onMenuShareWeibo:"menu:share:weiboApp",onMenuShareQZone:"menu:share:QZone",previewImage:"imagePreview",getLocation:"geoLocation",openProductSpecificView:"openProductViewWithPid",addCard:"batchAddCard",openCard:"batchViewCard",chooseWXPay:"getBrandWCPayRequest",openEnterpriseRedPacket:"getRecevieBizHongBaoRequest",startSearchBeacons:"startMonitoringBeacons",stopSearchBeacons:"stopMonitoringBeacons",onSearchBeacons:"onBeaconsInRange",consumeAndShareCard:"consumedShareCard",openAddress:"editAddress",getBrandWCPayRequest:"getBrandWCPayRequest"};for(const e of Object.keys(Oe));function Ne(...e){console.error("[wwsdk]",...e)}Re();function Be(e,t,n){if(Ve(e))try{return e.call(n,t)}catch(o){Ne(o)}}function Ve(e){return typeof e=="function"}let F=!!(T!=null&&T.WeixinJSBridge);Promise.resolve();F||new Promise(e=>{b==null||b.addEventListener("WeixinJSBridgeReady",()=>{F=!0,e()})});function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var D,z,j,J,Y,G,H,K,$,Q,U,Z,X,ee,te,ne,oe,ae,ie,re,se,ce,le,ue;function qe(e){const t=document.createElement("iframe"),{style:n}=t;n.display="block",n.border="none",n.background="transparent",t.referrerPolicy="origin",t.setAttribute("frameborder","0"),t.setAttribute("allowtransparency","true");const o=Fe(e);return o&&o.appendChild(t),t}function Fe(e){return typeof e=="string"?document.querySelector(e):e}(function(e){e.CLProximityUnknown="0",e.CLProximityImmediate="1",e.CLProximityNear="2",e.CLProximityFar="3"})(D||(D={})),function(e){e.wgs84="wgs84",e.gcj02="gcj02"}(z||(z={})),function(e){e.wifi="wifi",e.network2g="2g",e.network3g="3g",e.network4g="4g",e.none="none",e.unknown="unknown"}(j||(j={})),function(e){e.original="original",e.compressed="compressed"}(J||(J={})),function(e){e.album="album",e.camera="camera"}(Y||(Y={})),function(e){e.normal="normal",e.batch="batch",e.front="front",e.batch_front="batch_front"}(G||(G={})),function(e){e[e.common=0]="common",e[e.corp_training=1]="corp_training",e[e.edu_normal_class=2]="edu_normal_class",e[e.edu_small_class=3]="edu_small_class"}(H||(H={})),function(e){e[e.normal=0]="normal",e[e.scan=1]="scan"}(K||(K={})),function(e){e[e.chat=0]="chat",e[e.qrcode=1]="qrcode"}($||($={})),function(e){e.contact_profile="contact_profile",e.single_chat_tools="single_chat_tools",e.group_chat_tools="group_chat_tools",e.chat_attachment="chat_attachment",e.single_kf_tools="single_kf_tools",e.chain_single_chat_tools="chain_single_chat_tools",e.chain_group_chat_tools="chain_group_chat_tools",e.normal="normal"}(Q||(Q={})),function(e){e.permission="permission",e.datazone_permission="datazone_permission"}(U||(U={})),function(e){e.release="release",e.trial="trial",e.develop="develop"}(Z||(Z={})),function(e){e[e.internal=1]="internal",e[e.external=2]="external"}(X||(X={})),function(e){e[e.mediaid=1]="mediaid",e[e.url=2]="url",e[e.localId=4]="localId"}(ee||(ee={})),function(e){e.None="None",e.HWOpenTalk="HWOpenTalk",e.VoIP="VoIP",e.SystemCall="SystemCall"}(te||(te={})),function(e){e.qrCode="qrCode",e.barCode="barCode"}(ne||(ne={})),function(e){e.single="single",e.multi="multi"}(oe||(oe={})),function(e){e.department="department",e.user="user"}(ae||(ae={})),function(e){e.single="single",e.multi="multi"}(ie||(ie={})),function(e){e.department="department",e.user="user"}(re||(re={})),function(e){e[e.all=0]="all",e[e.unselected=1]="unselected"}(se||(se={})),function(e){e.single="single",e.multi="multi"}(ce||(ce={})),function(e){e.create_approval="10001",e.view_approval="10002"}(le||(le={})),function(e){e.link="link",e.text="text"}(ue||(ue={}));const De=Je();let ze=0;function je(){return`${De}-${ze++}`}function Je(){return Math.random().toString(36).slice(2)}function Ye(e){return e&&typeof e=="object"?{...e,message:e.message,stack:e.stack}:e}function de(e){try{return typeof e=="string"?JSON.parse(e):e}catch{}}function Ge(e,t){const n=new Map;return{invoke:function(o,a){return a!=null&&a.dropResult?(e({type:"ww-iframe-handle:call",args:o},a),Promise.resolve(void 0)):new Promise((u,s)=>{const c=je();n.set(c,{resolve:u,reject:s}),e({type:"ww-iframe-handle:call",uid:c,args:o},a)})},handleCallMessage:async function(o,a){if(!o.uid)return t(o.args,a);try{e({type:"ww-iframe-handle:response",uid:o.uid,kind:"resolve",args:await t(o.args,a)})}catch(u){throw e({type:"ww-iframe-handle:response",uid:o.uid,kind:"reject",args:Ye(u)}),u}},handleResponseMessage:function(o){const a=n.get(o.uid);a&&(a[o.kind](o.args),n.delete(o.uid))}}}function He(e,t,n){const o=[];let a=!1,u=!1;function s(r){if(r.origin!==t||e.contentWindow!==r.source)return;const i=de(r.data);typeof(i==null?void 0:i.type)=="string"&&i.type.startsWith("ww-iframe-handle:")&&q(i,r)}window.addEventListener("message",s);const c=new MessageChannel;c.port1.onmessage=r=>{q(de(r.data),r)};const{invoke:l,handleCallMessage:Te,handleResponseMessage:be}=Ge(function(r,i){a?_(r,i):o.push({msg:r,opts:i})},n);function q(r,i){switch(r.type){case"ww-iframe-handle:ready":return function(w){if(!a){a=!0,w.supportChannel&&(_({type:"ww-iframe-handle:set-port",port:c.port2},{transfer:[c.port2],serialize:!1}),u=!0);for(const h of o)_(h.msg,h.opts)}}(r);case"ww-iframe-handle:call":return Te(r,i);case"ww-iframe-handle:response":return void be(r)}}function _(r,i){var h;const w=(i==null?void 0:i.serialize)===!1?r:JSON.stringify(r);u?c.port1.postMessage(w,i==null?void 0:i.transfer):(h=e.contentWindow)==null||h.postMessage(w,t,i==null?void 0:i.transfer)}return e.addEventListener("load",()=>{a||_({type:"ww-iframe-handle:init"})}),{el:e,invoke:l,dispose:function(){window.removeEventListener("message",s),c.port1.onmessage=null}}}function Ke(e,t,n){Be(t[e.name],e.payload||e.data,n)}for(var gt={null:null,true:!0,false:!1,NaN:NaN,Infinity:1/0},$e="await break case catch class const continue debugger default delete do else enum export extends false finally for function if import in instanceof new null return super switch this throw true try typeof var void while with yield".split(" "),Qe={},k=0,pe=$e;k<pe.length;k++){var Ue=pe[k];Qe[Ue]=!0}var R,fe,W,f;(function(e){e.serviceApp="ServiceApp",e.corpApp="CorpApp"})(R||(R={})),function(e){e.zh="zh",e.en="en"}(fe||(fe={})),function(e){e.top="top",e.callback="callback",e.self="self"}(W||(W={})),function(e){e.middle="middle",e.small="small"}(f||(f={}));const me={[f.middle]:["480px","416px"],[f.small]:["320px","380px"]};function Ze(e){var c;const{width:t,height:n}=Xe((c=e.params)==null?void 0:c.panel_size),o=qe(e.el),{style:a}=o;a.width=t,a.height=n;const{dispose:u}=He(o,"https://login.work.weixin.qq.com",l=>{if(l.type==="call")return Ke(l,e);throw new Error(`Unknown message type '${l.type}'`)}),s=new URL("https://login.work.weixin.qq.com/wwlogin/sso/login");for(const l of Object.keys(e.params||{}))s.searchParams.set(l,e.params[l]);return s.searchParams.set("version","2.2.5"),o.src=s.href,{el:o,unmount(){var l;u(),(l=o.parentNode)==null||l.removeChild(o)}}}function Xe(e=f.middle){const t=me[e]||me[f.middle];return{width:t[0],height:t[1]}}function ye(e){return typeof Symbol=="function"?Symbol(e):e}var he;(function(e){e[e.int32=1]="int32",e[e.float64=2]="float64",e[e.boolean=3]="boolean",e[e.null=4]="null",e[e[void 0]=5]="undefined",e[e.valueRef=6]="valueRef"})(he||(he={}));var ge,_e;(function(e){e[e.set=1]="set",e[e.call=2]="call",e[e.dispose=3]="dispose"})(ge||(ge={})),function(e){e[e.value=1]="value",e[e.ref=2]="ref"}(_e||(_e={}));const N=ye("__WECOM_REFLECT_ID__");function et(e,t){return t.get?t.get.call(e):t.value}function ve(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function v(e,t){return et(e,ve(e,t,"get"))}function tt(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function C(e,t,n){tt(e,t),t.set(e,n)}function nt(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}function S(e,t,n){return nt(e,ve(e,t,"set"),n),n}const I=new WeakMap,O=new WeakMap;function B(e,t){I.set(e,t),O.set(t,e)}function Ce(e){return I.has(e)?I.get(e):e}function Se(e){return O.has(e)?O.get(e):e}var E=new WeakMap,A=new WeakMap;let ot=N;class at{setTransform(t){v(this,A).setTransform(t),v(this,E).call(this,"setTransform",[t])}constructor(t,n){g(this,ot,void 0),C(this,E,{writable:!0,value:void 0}),C(this,A,{writable:!0,value:void 0}),S(this,E,t),S(this,A,n),t.bind(this),B(this,n)}}var L=new WeakMap,M=new WeakMap;let it=N;class x{addColorStop(t,n){v(this,M).addColorStop(t,n),v(this,L).call(this,"addColorStop",[t,n])}constructor(t,n){g(this,it,void 0),C(this,L,{writable:!0,value:void 0}),C(this,M,{writable:!0,value:void 0}),S(this,L,t),S(this,M,n),t.bind(this),B(this,n)}}const rt=["fillStyle","filter","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","imageSmoothingQuality","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","strokeStyle"],st=["direction","font","fontKerning","fontStretch","fontVariantCaps","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","textAlign","textBaseline","textRendering","wordSpacing"],ct=["arc","arcTo","beginPath","bezierCurveTo","clip","closePath","ellipse","lineTo","moveTo","quadraticCurveTo","rect","reset","resetTransform","restore","rotate","roundRect","save","scale","setLineDash","setTransform","transform","translate"],lt=["clearRect","drawFocusIfNeeded","drawImage","fill","fillRect","fillText","stroke","strokeRect","strokeText"],ut=["getContextAttributes","getLineDash","getTransform","isContextLost","isPointInPath","isPointInStroke","measureText"],dt=[["createConicGradient",x],["createLinearGradient",x],["createPattern",at],["createRadialGradient",x]],d=ye("__WECOM_INTERNAL__");let pt=d,ft=N;class mt{constructor(t,n,o){g(this,"canvas",void 0),g(this,pt,void 0),g(this,ft,void 0),this.canvas=t,this[d]={store:n,native:o,props:Object.create(null)},n.bind(this),B(this,o)}}const m=mt.prototype;for(const e of rt)Object.defineProperty(m,e,{configurable:!0,enumerable:!0,get(){const{native:t,props:n}=this[d];return n[e]??Se(t[e])},set(t){const{store:n,props:o}=this[d];o[e]=Ce(t),n.set(this,e,t)}});for(const e of st)Object.defineProperty(m,e,{configurable:!0,enumerable:!0,get(){return Se(this[d].native[e])},set(t){const{store:n,native:o}=this[d];o[e]=Ce(t),n.set(this,e,t)}});for(const e of ut)m[e]=function(...t){const{native:n}=this[d];return V(n,e,t)};for(const e of ct)m[e]=function(...t){const{store:n,native:o}=this[d];V(o,e,t),n.call(this,e,t)};for(const e of lt)m[e]=function(...t){const{store:n}=this[d];n.call(this,e,t)};for(const[e,t]of dt)m[e]=function(...n){const{store:o,native:a}=this[d],u=V(a,e,n),s=new t(o,u);return o.call(this,e,n,s),s};function V(e,t,n){switch(n.length){case 1:return e[t](n[0]);case 2:return e[t](n[0],n[1]);case 3:return e[t](n[0],n[1],n[2]);case 4:return e[t](n[0],n[1],n[2],n[3]);case 5:return e[t](n[0],n[1],n[2],n[3],n[4]);case 6:return e[t](n[0],n[1],n[2],n[3],n[4],n[5]);default:return e[t](...n)}}const _t=Pe({__name:"WeComCode",props:{small:{type:Boolean}},emits:["onLoginSuccess"],setup(e,{emit:t}){const n=e,o=t,{systemParams:a}=ke(),u=Ee(()=>a==null?void 0:a.thirdAuthConfigs[Ae]);return Le(()=>{var s,c;Ze({el:".we_com-qrCode",params:{login_type:R.corpApp,appid:((s=u.value)==null?void 0:s.clientId)||"",agentid:((c=u.value)==null?void 0:c.agentId)||"",redirect_uri:window.location.origin,state:"loginState",redirect_type:W.callback,panel_size:n.small?f.small:f.middle},onCheckWeComLogin({isWeComLogin:l}){},async onLoginSuccess({code:l}){o("onLoginSuccess",l)},onLoginFail(l){}})}),(s,c)=>(Me(),xe("div",{class:"we_com-qrCode"}))}});export{_t as _};
