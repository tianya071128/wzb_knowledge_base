import{d as U,v as R,y as me,nH as ce,r as m,c as ee,e9 as ve,o as g,b as x,w as l,i as e,k as D,f as z,F as W,g as te,e as L,B as I,rS as _e,m as v,bF as be,C as B,bv as F,fo as fe,eh as ye,gT as j,ao as ge,ap as he,U as H,ca as we,_ as G,t as y,rC as q,bT as Y,dC as Ve,dD as Ce,bU as X,bi as Z,iC as le,rT as K,rU as O,rV as $,bs as ae,rW as oe,bh as ne,aN as E,rX as re,rY as ue,rZ as Ie,bK as Ae,ad as Ne,bu as Se,H as Te,mP as ze,r_ as Ue,l as Q,ac as De,E as Oe,ab as Ee,bm as We,Y as de,bx as Pe,aR as pe,P as qe,N as $e,O as Re}from"./index-b80d5ef5.js";import{g as Be,a as ke,b as Fe,i as Me,u as ie,s as se,c as Le,d as je,e as He,f as Ke,h as Qe,j as Ge,k as Ye,l as Xe,m as Ze,n as Je,o as et,p as tt}from"./cooperation-dbdc5052.js";import{Q as xe}from"./Qrcode-850531ac.js";import{_ as J}from"./TableOperation.vue_vue_type_script_setup_true_lang-4afbb2cb.js";import"./html2canvas.esm-0543ed55.js";const lt=U({__name:"AddCooperationEnt",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(A,{emit:h}){const p=R(A,"modelValue",h);me(p,()=>{p.value&&(s.value=7,t())});const r=ce(),s=m(7),f=[{label:"1天",value:1},{label:"7天",value:7},{label:"15天",value:15},{label:"永久有效",value:-1}],n=()=>{fe(`企业【${r.corpName}】 邀请您建立协作关系，开展业务协作！
      打开此链接：${d.value}
      按照提示完成操作。`)},i=m(!1),_=m(),u=async()=>{var b;i.value=!0,await((b=_.value)==null?void 0:b.downloadQrcode()),i.value=!1},a=m(!1),o=m(""),t=async()=>{a.value=!0,o.value=await Be({validTime:s.value}),a.value=!1},d=ee(()=>{let b=`#/invitation/enterprise?invitation_code=${o.value}`;return b=ve.join(location.host,location.pathname,b),`${location.protocol}//${b}`});return(b,C)=>{const N=ye,T=j,S=ge,M=he,w=H,P=we;return g(),x(F,{modelValue:I(p),"onUpdate:modelValue":C[1]||(C[1]=k=>B(p)?p.value=k:null),title:"添加协作企业"},{default:l(()=>[e(N,{title:"当合作伙伴在本平台已有账号，可分享以下链接邀请对方进行业务协作。",type:"info",closable:!1,"show-icon":""}),e(N,{title:"当合作伙伴在本平台未创建账号，可分享以下链接邀请对方进行注册，并建立协作关系。",type:"info",closable:!1,"show-icon":"",style:{"margin-top":"10px"}}),e(T),D("div",null,[D("span",null,"链接有效期："),e(M,{modelValue:s.value,"onUpdate:modelValue":C[0]||(C[0]=k=>s.value=k),placeholder:"请选择有效期",onChange:t,style:{width:"250px"}},{default:l(()=>[(g(),z(W,null,te(f,k=>e(S,{key:k.value,label:k.label,value:k.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),L((g(),z("div",null,[D("div",{class:"invited-qr"},[e(xe,{ref_key:"qrcodeRef",ref:_,text:d.value,filename:"邀请企业协作","tip-text":"录入信息后建立连接",title:"邀请您建立协作关系，开展业务协作"},null,8,["text"])]),D("div",{style:{"text-align":"center"}},[e(w,{type:"primary",onClick:u,plain:"",icon:I(_e),loading:i.value},{default:l(()=>[v(" 下载二维码 ")]),_:1},8,["icon","loading"]),e(w,{type:"primary",onClick:n,plain:"",icon:I(be)},{default:l(()=>[v(" 复制邀请链接 ")]),_:1},8,["icon"])])])),[[P,a.value]])]),_:1},8,["modelValue"])}}});const at=G(lt,[["__scopeId","data-v-813275df"]]),ot=U({__name:"ViewCooperationEnt",props:{modelValue:{type:Boolean},view:{}},emits:["update:modelValue"],setup(A,{emit:h}){const c=A,p=R(c,"modelValue",h),r=m(),s=async()=>{var f;(f=c.view)!=null&&f.id&&(r.value=await ke(c.view.id))};return(f,n)=>{const i=Y,_=Ve,u=Ce,a=X,o=j;return g(),x(F,{modelValue:I(p),"onUpdate:modelValue":n[0]||(n[0]=t=>B(p)?p.value=t:null),title:"查看详情","show-load":s},{default:l(()=>[e(a,{class:"mt-20",column:1,border:""},{default:l(()=>[e(i,{label:"我方企业名称"},{default:l(()=>{var t;return[v(y(((t=r.value)==null?void 0:t.inviteCorpName)||"-"),1)]}),_:1}),e(i,{label:"我方对接人"},{default:l(()=>{var t;return[e(u,{data:((t=r.value)==null?void 0:t.inviteAbutments)||[],border:""},{default:l(()=>[e(_,{prop:"nickname",label:"姓名"}),e(_,{prop:"mobile",label:"手机号",width:"120"},{default:l(({row:d})=>[v(y(I(q)(d.mobile)),1)]),_:1}),e(_,{prop:"deptName",label:"所属部门",minwidth:"100"},{default:l(({row:d})=>[v(y(d.deptName||"-"),1)]),_:1})]),_:1},8,["data"])]}),_:1}),e(i,{label:"邀请人"},{default:l(()=>{var t;return[v(y(((t=r.value)==null?void 0:t.inviteUserName)||"-"),1)]}),_:1}),e(i,{label:"邀请时间"},{default:l(()=>{var t;return[v(y(((t=r.value)==null?void 0:t.inviteTime)||"-"),1)]}),_:1})]),_:1}),e(o),e(a,{column:1,border:""},{default:l(()=>[e(i,{label:"对方企业名称"},{default:l(()=>{var t;return[v(y(((t=r.value)==null?void 0:t.beInvitedName)||"-"),1)]}),_:1}),e(i,{label:"对方对接人"},{default:l(()=>{var t;return[e(u,{data:((t=r.value)==null?void 0:t.beInvitedAbutments)||[],border:""},{default:l(()=>[e(_,{prop:"nickname",label:"姓名"}),e(_,{prop:"mobile",label:"手机号"},{default:l(({row:d})=>[v(y(I(q)(d.mobile)),1)]),_:1})]),_:1},8,["data"])]}),_:1}),e(i,{label:"连接人"},{default:l(()=>{var t;return[v(y(((t=r.value)==null?void 0:t.beInvitedUserName)||"-"),1)]}),_:1}),e(i,{label:"连接时间"},{default:l(()=>{var t;return[v(y(((t=r.value)==null?void 0:t.beInvitedTime)||"-"),1)]}),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),nt=U({__name:"MyInvited",setup(A){const h={id:"my_invited_page",query:{list:[{type:"input",label:"对方企业名称",prop:"corpName"},{type:"input",label:"证件号",prop:"certificateNumber"},{type:"input",label:"分类",prop:"textCategory"},{type:"input",label:"业务编码",prop:"bizId"},{type:"select",label:"协作状态",prop:"cooperationStatus",options:O,isAll:!0}]},request:{api:Fe},table:{tableCols:[{prop:"corpName",label:"对方企业名称",minWidth:250,showOverflowTooltip:!0},{prop:"certificateNumber",label:"证件号",minWidth:180,showOverflowTooltip:!0},{prop:"textCategory",label:"分类",minWidth:120,showOverflowTooltip:!0},{prop:"bizId",label:"业务编码",minWidth:120,showOverflowTooltip:!0},{prop:"beInvitedAbutments",label:"对方对接人",minWidth:200,showOverflowTooltip:!0,slots:{default({row:o}){var t;return e("span",null,[((t=o.beInvitedAbutments)==null?void 0:t.map(d=>d.nickname).join("、"))||"-"])}}},{prop:"inviteAbutments",label:"我方对接人",minWidth:200,showOverflowTooltip:!0,slots:{default({row:o}){var t;return e("span",null,[((t=o.inviteAbutments)==null?void 0:t.map(d=>d.nickname).join("、"))||"-"])}}},{prop:"cooperationStatus",label:"协作状态",minWidth:100,slots:{default({row:o}){const t=async()=>{await ie(o.id,re),V()};return o.cooperationStatus==$?e("span",null,[ae(o.cooperationStatus,O)]):e(ne,{modelValue:o.cooperationStatus,"onUpdate:modelValue":d=>o.cooperationStatus=d,dictKey:O,updateFetch:t,disabled:!oe("system:dict:enable")},null)}}},{fixed:"right",label:"操作",minWidth:150,slots:{default({row:o}){const t=()=>{p.value=o,r.value=!0},d=async()=>{await se(o.id,re),E.success("终止协作成功"),V()},b=[{type:"primary",onClick:t,text:"查看",premission:"system:cooperation:qy:detail"}];return o.cooperationStatus!=$&&b.push({type:"primary",onClick:()=>i(o),text:"设置对接人",premission:"system:cooperation:qy:setuser"},{type:"danger",text:"终止协作",premission:"system:cooperation:qy:delete",popconfirmProps:{title:"终止协作企业后，数据将不可恢复，如需再次协作可重新连接，确认终止？",confirm:d}}),e(J,{rowId:o.id,list:b},null)}}}]}},c=m(),V=()=>{var o;(o=c.value)==null||o.refresh()},p=m(),r=m(!1),s=m(),f=m(!1),n=m([]),i=o=>{var t;f.value=!0,s.value=o,n.value=((t=o.inviteAbutments)==null?void 0:t.map(d=>d.memberId))??[]},_=async o=>{const t=Array.isArray(o)?o:o==null?null:[o];if(!(t!=null&&t.length))return E.error("请至少选择一个对接人"),!1;await Me(t.map(d=>{var b,C,N,T;return{corpCooperationId:((b=s.value)==null?void 0:b.id)??"",memberId:d,id:((T=(N=(C=s.value)==null?void 0:C.inviteAbutments)==null?void 0:N.find(S=>S.memberId===d))==null?void 0:T.id)??null}})),E.success("设置对接人成功"),V()},u=m(!1),a=()=>{u.value=!0};return(o,t)=>{var N,T;const d=H,b=Z("az-page"),C=le("premission");return g(),z(W,null,[e(b,{ref_key:"azPageRef",ref:c,config:h,maxHeight:"var(--az-layout-main-height) - 40px - 80px"},{operation:l(()=>[L((g(),x(d,{type:"primary",onClick:a},{default:l(()=>[v(" 添加协作企业 ")]),_:1})),[[C,"system:cooperation:qy:add"]])]),_:1},512),e(at,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=S=>u.value=S)},null,8,["modelValue"]),e(ot,{modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=S=>r.value=S),view:p.value},null,8,["modelValue","view"]),e(K,{modelValue:n.value,"onUpdate:modelValue":t[2]||(t[2]=S=>n.value=S),visible:f.value,"onUpdate:visible":t[3]||(t[3]=S=>f.value=S),label:"我方对接人员","mini-title":((N=s.value)==null?void 0:N.usCorpName)??"",multiple:!0,type:"member","submit-callback":_,initOptions:((T=s.value)==null?void 0:T.inviteAbutments)??[]},null,8,["modelValue","visible","mini-title","initOptions"])],64)}}}),it=U({__name:"ViewCooperationEnt",props:{modelValue:{type:Boolean},view:{}},emits:["update:modelValue"],setup(A,{emit:h}){const c=A,p=R(c,"modelValue",h),r=m(),s=async()=>{var f;(f=c.view)!=null&&f.id&&(r.value=await ke(c.view.id))};return(f,n)=>{const i=Y,_=Ve,u=Ce,a=X,o=j;return g(),x(F,{modelValue:I(p),"onUpdate:modelValue":n[0]||(n[0]=t=>B(p)?p.value=t:null),title:"查看详情","show-load":s},{default:l(()=>[e(a,{class:"mt-20",column:1,border:""},{default:l(()=>[e(i,{label:"我方企业名称"},{default:l(()=>{var t;return[v(y(((t=r.value)==null?void 0:t.beInvitedName)||"-"),1)]}),_:1}),e(i,{label:"我方对接人"},{default:l(()=>{var t;return[e(u,{data:((t=r.value)==null?void 0:t.beInvitedAbutments)||[],border:""},{default:l(()=>[e(_,{prop:"nickname",label:"姓名",width:"80"}),e(_,{prop:"mobile",label:"手机号",width:"80"},{default:l(({row:d})=>[v(y(I(q)(d.mobile)),1)]),_:1}),e(_,{prop:"deptName",label:"所属部门",minwidth:"100"},{default:l(({row:d})=>[v(y(d.deptName||"-"),1)]),_:1})]),_:1},8,["data"])]}),_:1}),e(i,{label:"连接人"},{default:l(()=>{var t;return[v(y(((t=r.value)==null?void 0:t.beInvitedUserName)||"-"),1)]}),_:1}),e(i,{label:"连接时间"},{default:l(()=>{var t;return[v(y(((t=r.value)==null?void 0:t.beInvitedTime)||"-"),1)]}),_:1})]),_:1}),e(o),e(a,{column:1,border:""},{default:l(()=>[e(i,{label:"对方企业名称"},{default:l(()=>{var t;return[v(y(((t=r.value)==null?void 0:t.inviteCorpName)||"-"),1)]}),_:1}),e(i,{label:"对方对接人"},{default:l(()=>{var t;return[e(u,{data:((t=r.value)==null?void 0:t.inviteAbutments)||[],border:""},{default:l(()=>[e(_,{prop:"nickname",label:"姓名"}),e(_,{prop:"mobile",label:"手机号"},{default:l(({row:d})=>[v(y(I(q)(d.mobile)),1)]),_:1})]),_:1},8,["data"])]}),_:1}),e(i,{label:"邀请人"},{default:l(()=>{var t;return[v(y(((t=r.value)==null?void 0:t.inviteUserName)||"-"),1)]}),_:1}),e(i,{label:"邀请时间"},{default:l(()=>{var t;return[v(y(((t=r.value)==null?void 0:t.inviteTime)||"-"),1)]}),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),st=U({__name:"InvitedMy",setup(A){const h={id:"invited_my_page",query:{list:[{type:"input",label:"对方企业名称",prop:"corpName"},{type:"input",label:"证件号",prop:"certificateNumber"},{type:"input",label:"分类",prop:"textCategory"},{type:"input",label:"业务编码",prop:"bizId"},{type:"select",label:"协作状态",prop:"cooperationStatus",options:O,isAll:!0}]},request:{api:Le},table:{tableCols:[{prop:"corpName",label:"对方企业名称",minWidth:250,showOverflowTooltip:!0},{prop:"certificateNumber",label:"证件号",minWidth:180,showOverflowTooltip:!0},{prop:"textCategory",label:"分类",minWidth:120,showOverflowTooltip:!0},{prop:"bizId",label:"业务编码",minWidth:120,showOverflowTooltip:!0},{prop:"beInvitedAbutments",label:"对方对接人",minWidth:200,showOverflowTooltip:!0,slots:{default({row:u}){var a;return e("span",null,[((a=u.inviteAbutments)==null?void 0:a.map(o=>o.nickname).join("、"))||"-"])}}},{prop:"inviteAbutments",label:"我方对接人",minWidth:200,showOverflowTooltip:!0,slots:{default({row:u}){var a;return e("span",null,[((a=u.beInvitedAbutments)==null?void 0:a.map(o=>o.nickname).join("、"))||"-"])}}},{prop:"cooperationStatus",label:"协作状态",minWidth:100,slots:{default({row:u}){const a=async()=>{await ie(u.id,ue),V()};return u.cooperationStatus==$?e("span",null,[ae(u.cooperationStatus,O)]):e(ne,{modelValue:u.cooperationStatus,"onUpdate:modelValue":o=>u.cooperationStatus=o,dictKey:O,updateFetch:a,disabled:!oe("system:dict:enable")},null)}}},{fixed:"right",label:"操作",minWidth:150,slots:{default({row:u}){const a=()=>{p.value=u,r.value=!0},o=async()=>{await se(u.id,ue),E.success("终止协作成功"),V()},t=[{type:"primary",onClick:a,text:"查看",premission:"system:cooperation:qy:detail"}];return u.cooperationStatus!=$&&t.push({type:"primary",onClick:()=>i(u),text:"设置对接人",premission:"system:cooperation:qy:setuser"},{type:"danger",text:"终止协作",premission:"system:cooperation:qy:delete",popconfirmProps:{title:"终止协作企业后，数据将不可恢复，如需再次协作可重新连接，确认终止？",confirm:o}}),e(J,{rowId:u.id,list:t},null)}}}]}},c=m(),V=()=>{var u;(u=c.value)==null||u.refresh()},p=m(),r=m(!1),s=m(),f=m(!1),n=m([]),i=u=>{var a;f.value=!0,s.value=u,n.value=((a=u.beInvitedAbutments)==null?void 0:a.map(o=>o.memberId))??[]},_=async u=>{const a=Array.isArray(u)?u:u==null?null:[u];if(!(a!=null&&a.length))return E.error("请至少选择一个对接人"),!1;await je(a.map(o=>{var t,d,b,C;return{corpCooperationId:((t=s.value)==null?void 0:t.id)??"",memberId:o,id:((C=(b=(d=s.value)==null?void 0:d.inviteAbutments)==null?void 0:b.find(N=>N.memberId===o))==null?void 0:C.id)??null}})),E.success("设置对接人成功"),V()};return(u,a)=>{var t,d;const o=Z("az-page");return g(),z(W,null,[e(o,{ref_key:"azPageRef",ref:c,config:h,maxHeight:"var(--az-layout-main-height) - 40px - 80px"},null,512),e(it,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=b=>r.value=b),view:p.value},null,8,["modelValue","view"]),e(K,{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=b=>n.value=b),visible:f.value,"onUpdate:visible":a[2]||(a[2]=b=>f.value=b),label:"我方对接人员","mini-title":((t=s.value)==null?void 0:t.usCorpName)??"",multiple:!0,type:"member","submit-callback":_,initOptions:((d=s.value)==null?void 0:d.inviteAbutments)??[]},null,8,["modelValue","visible","mini-title","initOptions"])],64)}}}),rt=U({__name:"SetCounterpart",props:{modelValue:{type:Boolean},state:{},rowData:{}},emits:["update:modelValue","refresh"],setup(A,{emit:h}){const c=A,V=h,p=R(c,"modelValue",V),r=ee(()=>c.state==="add"?"添加对接人":c.state==="edit"?"修改我方对接人":"查看详情"),s=m({memberIds:[],corpIds:[],isAll:Ie}),f=Ae({memberIds:[{type:"array",required:!0,message:"请选择对接人",trigger:"change"}],corpIds:[{type:"array",required:!0,message:"请选择对接企业",trigger:"change"}]}),n=async t=>({records:await He(t.corpName)}),i=m(),_=async()=>{var t;await((t=i.value)==null?void 0:t.validate()),await(c.state==="add"?Ke:Qe)({...s.value,corpIds:s.value.isAll?[]:s.value.corpIds}),E.success(r.value+"成功"),V("refresh")},u=m([]),a=m(),o=async()=>{c.rowData&&(a.value=await Ge({memberId:c.rowData.memberId}),s.value={memberIds:[a.value.memberId],isAll:a.value.isAll,corpIds:(a.value.corpCooperationAbutments||[]).map(t=>t.abutmentCorpId)},u.value=(a.value.corpCooperationAbutments||[]).map(t=>({corpId:t.abutmentCorpId,corpName:t.corpName})))};return(t,d)=>{const b=De,C=Y,N=X,T=Oe,S=Ee,M=We;return g(),x(F,{modelValue:I(p),"onUpdate:modelValue":d[4]||(d[4]=w=>B(p)?p.value=w:null),title:r.value,"show-load":o},Ne({default:l(()=>[e(M,{rules:f,model:s.value,"label-position":"top",ref_key:"ruleFormRef",ref:i},{default:l(()=>[t.state==="add"?(g(),x(b,{key:0,label:"对接人",prop:"memberIds"},{default:l(()=>[e(K,{modelValue:s.value.memberIds,"onUpdate:modelValue":d[0]||(d[0]=w=>s.value.memberIds=w),label:"我方对接人员",type:"member",multiple:""},null,8,["modelValue"])]),_:1})):(g(),x(N,{key:1,column:1,title:"我方对接人",class:"counterpart-descriptions",border:""},{default:l(()=>[e(C,{label:"姓名"},{default:l(()=>{var w;return[v(y(((w=a.value)==null?void 0:w.nickname)||"-"),1)]}),_:1}),e(C,{label:"手机号"},{default:l(()=>{var w;return[v(y(I(q)(((w=a.value)==null?void 0:w.mobile)??"")||"-"),1)]}),_:1}),e(C,{label:"所属部门"},{default:l(()=>{var w;return[v(y(((w=a.value)==null?void 0:w.deptName)||"-"),1)]}),_:1})]),_:1})),e(Te,{label:"对接企业",required:"",prop:"isAll"},{default:l(()=>[e(ze,{load:I(Ue)},{default:l(({options:w})=>[e(S,{modelValue:s.value.isAll,"onUpdate:modelValue":d[1]||(d[1]=P=>s.value.isAll=P),disabled:t.state==="view"},{default:l(()=>[(g(!0),z(W,null,te(w,(P,k)=>(g(),x(T,{key:k,label:P.value},{default:l(()=>[v(y(P.label),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","disabled"])]),_:1},8,["load"])]),_:1}),s.value.isAll?Q("",!0):(g(),x(b,{key:2,prop:"corpIds"},{default:l(()=>[e(K,{modelValue:s.value.corpIds,"onUpdate:modelValue":d[2]||(d[2]=w=>s.value.corpIds=w),label:"对接企业",type:"custom",typeName:"企业名称",loadFn:n,multiple:"",hideOrgTree:"",keyMap:{id:"corpId",label:"corpName",searchKey:"corpName"},disabled:t.state==="view",initOptions:u.value},null,8,["modelValue","disabled","initOptions"])]),_:1}))]),_:1},8,["rules","model"])]),_:2},[t.state!=="view"?{name:"footer",fn:l(()=>[e(Se,{editMode:"",onClose:d[3]||(d[3]=w=>p.value=!1),"on-submit":_})]),key:"0"}:void 0]),1032,["modelValue","title"])}}});const ut=G(rt,[["__scopeId","data-v-7b3a2096"]]),dt=U({__name:"MyCounterpart",setup(A){const h={id:"my_counterpart_page",query:{list:[{type:"input",label:"对方企业名称",prop:"corpName"},{type:"input",label:"我方对接人",prop:"nickname"}]},request:{api:Ye},table:{tableCols:[{prop:"nickname",label:"我方对接人",minWidth:150,showOverflowTooltip:!0},{prop:"corpName",label:"对接企业名称",minWidth:250,showOverflowTooltip:!0,slots:{default({row:n}){return e("span",null,[n.isAll==Ie?"全部企业":n.corpName])}}},{prop:"mobile",label:"手机号",minWidth:250,showOverflowTooltip:!0,slots:{default({row:n}){return e("span",null,[q(n.mobile)])}}},{fixed:"right",label:"操作",minWidth:150,slots:{default({row:n}){const a=[{type:"primary",onClick:()=>{p.value="view",s.value=de(n),r.value=!0},text:"查看",premission:"system:cooperation:wfdjr:detail"},{type:"primary",onClick:()=>{p.value="edit",s.value=de(n),r.value=!0},text:"修改",premission:"system:cooperation:wfdjr:update"},{type:"danger",text:"移除",premission:"system:cooperation:wfdjr:out",popconfirmProps:{title:"移除后，该用户将不再负责企业协作的对接，是否确定移除？",confirm:async()=>{await Xe(n.memberId),E.success("移除成功"),V()}}}];return e(J,{num:3,rowId:n.memberId,list:a},null)}}}]}},c=m(),V=()=>{var n;(n=c.value)==null||n.refresh()},p=m("add"),r=m(!1),s=m(),f=()=>{p.value="add",s.value=void 0,r.value=!0};return(n,i)=>{const _=H,u=Z("az-page"),a=le("premission");return g(),z(W,null,[e(u,{ref_key:"azPageRef",ref:c,config:h,maxHeight:"var(--az-layout-main-height) - 80px"},{operation:l(()=>[L((g(),x(_,{type:"primary",onClick:f},{default:l(()=>[v(" 添加对接人 ")]),_:1})),[[a,"system:cooperation:wfdjr:add"]])]),_:1},512),r.value?(g(),x(ut,{key:0,modelValue:r.value,"onUpdate:modelValue":i[0]||(i[0]=o=>r.value=o),rowData:s.value,state:p.value,onRefresh:V},null,8,["modelValue","rowData","state"])):Q("",!0)],64)}}}),pt=U({__name:"AddCooperationPersonal",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(A,{emit:h}){const p=R(A,"modelValue",h);me(p,()=>{p.value&&(s.value=7,t())});const r=ce(),s=m(7),f=[{label:"1天",value:1},{label:"7天",value:7},{label:"15天",value:15},{label:"永久有效",value:-1}],n=()=>{fe(`企业【${r.corpName}】 邀请您建立协作关系，开展业务协作！
      打开此链接：${d.value}
      按照提示完成操作。`)},i=m(!1),_=m(),u=async()=>{var b;i.value=!0,await((b=_.value)==null?void 0:b.downloadQrcode()),i.value=!1},a=m(!1),o=m(""),t=async()=>{a.value=!0,o.value=await Ze({validTime:s.value}),a.value=!1},d=ee(()=>{let b=`#/invitation/personal?invitation_code=${o.value}`;return b=ve.join(location.host,location.pathname,b),`${location.protocol}//${b}`});return(b,C)=>{const N=ye,T=j,S=ge,M=he,w=H,P=we;return g(),x(F,{modelValue:I(p),"onUpdate:modelValue":C[1]||(C[1]=k=>B(p)?p.value=k:null),title:"添加协作个人"},{default:l(()=>[e(N,{title:"当合作伙伴在本平台已有账号，可分享以下链接邀请对方进行业务协作。",type:"info",closable:!1,"show-icon":""}),e(N,{title:"当合作伙伴在本平台未创建账号，可分享以下链接邀请对方进行注册，并建立协作关系。",type:"info",closable:!1,"show-icon":"",style:{"margin-top":"10px"}}),e(T),D("div",null,[D("span",null,"链接有效期："),e(M,{modelValue:s.value,"onUpdate:modelValue":C[0]||(C[0]=k=>s.value=k),placeholder:"请选择有效期",onChange:t,style:{width:"250px"}},{default:l(()=>[(g(),z(W,null,te(f,k=>e(S,{key:k.value,label:k.label,value:k.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),L((g(),z("div",null,[D("div",{class:"invited-qr"},[e(xe,{ref_key:"qrcodeRef",ref:_,text:d.value,filename:"邀请个人协作","tip-text":"录入信息后建立连接",title:"邀请您建立协作关系，开展业务协作"},null,8,["text"])]),D("div",{style:{"text-align":"center"}},[e(w,{type:"primary",onClick:u,plain:"",icon:I(_e),loading:i.value},{default:l(()=>[v(" 下载二维码 ")]),_:1},8,["icon","loading"]),e(w,{type:"primary",onClick:n,plain:"",icon:I(be)},{default:l(()=>[v(" 复制邀请链接 ")]),_:1},8,["icon"])])])),[[P,a.value]])]),_:1},8,["modelValue"])}}});const mt=G(pt,[["__scopeId","data-v-29cb6efa"]]),ct=U({__name:"ViewCooperationPersonal",props:{modelValue:{type:Boolean},view:{}},emits:["update:modelValue"],setup(A,{emit:h}){const c=A,p=R(c,"modelValue",h),r=m(),s=async()=>{var f;(f=c.view)!=null&&f.id&&(r.value=await Je(c.view.id))};return(f,n)=>{const i=Y,_=X,u=j;return g(),x(F,{modelValue:I(p),"onUpdate:modelValue":n[0]||(n[0]=a=>B(p)?p.value=a:null),title:"查看详情","show-load":s},{default:l(()=>[e(_,{class:"mt-20",column:1,border:""},{default:l(()=>[e(i,{label:"我方企业名称"},{default:l(()=>{var a;return[v(y(((a=r.value)==null?void 0:a.inviteCorpName)||"-"),1)]}),_:1}),e(i,{label:"邀请人"},{default:l(()=>{var a;return[v(y(((a=r.value)==null?void 0:a.inviteUserName)||"-"),1)]}),_:1}),e(i,{label:"邀请时间"},{default:l(()=>{var a;return[v(y(((a=r.value)==null?void 0:a.inviteTime)||"-"),1)]}),_:1})]),_:1}),e(u),e(_,{column:1,border:""},{default:l(()=>[e(i,{label:"对方名称"},{default:l(()=>{var a;return[v(y(((a=r.value)==null?void 0:a.beInvitedName)||"-"),1)]}),_:1}),e(i,{label:"手机号"},{default:l(()=>{var a;return[v(y(I(q)(((a=r.value)==null?void 0:a.mobile)??"")||"-"),1)]}),_:1}),e(i,{label:"连接时间"},{default:l(()=>{var a;return[v(y(((a=r.value)==null?void 0:a.beInvitedTime)||"-"),1)]}),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),vt=U({__name:"CooperationPersonal",setup(A){const h={id:"my_counterpart_page",query:{list:[{type:"input",label:"姓名",prop:"nickname"},{type:"input",label:"手机号",prop:"mobile"},{type:"input",label:"分类",prop:"textCategory"},{type:"input",label:"业务编码",prop:"bizId"},{type:"select",label:"协作状态",prop:"cooperationStatus",options:O,isAll:!0}]},request:{api:et},table:{tableCols:[{prop:"nickname",label:"姓名",minWidth:200,showOverflowTooltip:!0},{prop:"mobile",label:"手机号",minWidth:200,showOverflowTooltip:!0,slots:{default({row:n}){return e("span",null,[q(n.mobile)])}}},{prop:"textCategory",label:"分类",minWidth:120,showOverflowTooltip:!0},{prop:"bizId",label:"业务编码",minWidth:120,showOverflowTooltip:!0},{prop:"cooperationStatus",label:"协作状态",minWidth:100,slots:{default({row:n}){const i=async()=>{await ie(n.id),V()};return n.cooperationStatus==$?e("span",null,[ae(n.cooperationStatus,O)]):e(ne,{modelValue:n.cooperationStatus,"onUpdate:modelValue":_=>n.cooperationStatus=_,dictKey:O,updateFetch:i,disabled:!oe("system:cooperation:gr:enable")},null)}}},{fixed:"right",label:"操作",minWidth:150,slots:{default({row:n}){const i=()=>{f.value=n,s.value=!0},_=async()=>{await se(n.id),E.success("终止协作成功"),V()},u=[{type:"primary",onClick:i,text:"查看",premission:"system:cooperation:gr:detail"}];return n.cooperationStatus!=$&&u.push({type:"danger",text:"终止协作",premission:"system:cooperation:gr:delete",popconfirmProps:{title:"终止协作个人后，数据将不可恢复，如需再次协作可重新连接，确认终止？",confirm:_}}),e(J,{rowId:n.id,list:u},null)}}}]}},c=m(),V=()=>{var n;(n=c.value)==null||n.refresh()},p=m(!1),r=()=>{p.value=!0},s=m(!1),f=m();return(n,i)=>{const _=H,u=Z("az-page"),a=le("premission");return g(),z(W,null,[e(u,{ref_key:"azPageRef",ref:c,config:h,maxHeight:"var(--az-layout-main-height) - 80px"},{operation:l(()=>[L((g(),x(_,{type:"primary",onClick:r},{default:l(()=>[v(" 添加协作个人 ")]),_:1})),[[a,"system:cooperation:gr:add"]])]),_:1},512),e(mt,{modelValue:p.value,"onUpdate:modelValue":i[0]||(i[0]=o=>p.value=o)},null,8,["modelValue"]),e(ct,{modelValue:s.value,"onUpdate:modelValue":i[1]||(i[1]=o=>s.value=o),view:f.value},null,8,["modelValue","view"])],64)}}}),_t={name:"Cooperation"},bt=U({..._t,setup(A){const h=m(!1),c=m();return Pe(async()=>{h.value=!0;try{c.value=await tt()}finally{h.value=!1}}),(V,p)=>{const r=qe,s=$e,f=Re;return g(),x(f,{class:"az_tabs-page",type:"border-card"},{default:l(()=>[e(s,{class:"layout_box",label:"协作企业"},{default:l(()=>[e(f,{class:"az_tabs-custom"},{default:l(()=>[e(s,{label:"我邀请的"},{label:l(()=>{var n,i;return[D("span",null,"我邀请的"),((n=c.value)==null?void 0:n.inviteCount)!=null?(g(),z(W,{key:0},[v(y("："+((i=c.value)==null?void 0:i.inviteCount)),1)],64)):h.value?(g(),x(r,{key:1,class:"is-loading ml-5"},{default:l(()=>[e(I(pe))]),_:1})):Q("",!0)]}),default:l(()=>[e(nt)]),_:1}),e(s,{label:"邀请我的",lazy:""},{label:l(()=>{var n,i;return[D("span",null,"邀请我的"),((n=c.value)==null?void 0:n.beinvitedCount)!=null?(g(),z(W,{key:0},[v(y("："+((i=c.value)==null?void 0:i.beinvitedCount)),1)],64)):h.value?(g(),x(r,{key:1,class:"is-loading ml-5"},{default:l(()=>[e(I(pe))]),_:1})):Q("",!0)]}),default:l(()=>[e(st)]),_:1})]),_:1})]),_:1}),e(s,{class:"layout_box",label:"协作个人",lazy:""},{default:l(()=>[e(vt)]),_:1}),e(s,{class:"layout_box",label:"我方对接人",lazy:""},{default:l(()=>[e(dt)]),_:1})]),_:1})}}});const Vt=G(bt,[["__scopeId","data-v-e8ab53a6"]]);export{Vt as default};
