import{d as V,vx as K,vy as O,r as d,vz as j,o as b,b as U,w as u,i as e,B as n,aS as J,Q,ac as X,bm as G,aW as B,aV as E,f as k,bz as H,m as x,k as r,F as R,vA as M,vB as I,vC as F,av as N,kX as $,_ as W,ci as Y,c as Z,t as T,l as L,nL as ee,p as ae,vD as oe,vE as te,N as se,O as ne,U as le,gT as re}from"./index-b80d5ef5.js";import{R as ie}from"./encryption-40d88f62.js";import{_ as ce}from"./CodeLogin.vue_vue_type_script_setup_true_lang-1be0bdce.js";import{_ as ue}from"./WeComCode.vue_vue_type_script_setup_true_lang-dc462ebc.js";import"./MobileFormItem.vue_vue_type_script_setup_true_lang-b23f5d06.js";const me=""+new URL("../png/login-bg-39b2157f.png",import.meta.url).href,de=V({__name:"AccountLogin",emits:["submit"],setup(g,{expose:y,emit:_}){const{accountForm:a}=K(O()),m=_,p=d({username:[{required:!0,message:"请输入账号或手机号码",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}),c=d();y({validate(){var t;return(t=c.value)==null?void 0:t.validate()},async submit(){var s;if(await((s=c.value)==null?void 0:s.validate()))return await j({username:o(a.value.username),password:ie(a.value.password)})}});const o=t=>t.replace(/\s+/g,"");return(t,s)=>{const v=Q,w=X,h=G;return b(),U(h,{class:"account_login",model:n(a),rules:p.value,ref_key:"ruleFormRef",ref:c,"label-width":"80","label-position":"left","hide-required-asterisk":""},{default:u(()=>[e(w,{prop:"username",label:"账号/手机"},{default:u(()=>[e(v,{modelValue:n(a).username,"onUpdate:modelValue":s[0]||(s[0]=f=>n(a).username=f),type:"text",formatter:o,class:"az_form-one-border",placeholder:"请输入账号或手机号码",clearable:""},null,8,["modelValue"])]),_:1}),e(w,{prop:"password",label:"密码"},{default:u(()=>[e(v,{modelValue:n(a).password,"onUpdate:modelValue":s[1]||(s[1]=f=>n(a).password=f),"show-password":"",type:"text",formatter:o,class:"az_form-one-border",placeholder:"请输入登录密码",onKeyup:s[2]||(s[2]=J(f=>m("submit"),["enter"]))},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])}}});var z=(g=>(g.home="home",g.weCom="weCom",g))(z||{});const _e=V({__name:"WeComPane",emits:["turn"],setup(g,{emit:y}){const _=y,a=B(),m=E(),p=async c=>{const o=await M(c);o.accessToken?(I(o),await a.replace(F(m,$))):a.push({name:"UserBind",query:{thirdUserId:o.thirdUserId,thirdType:o.thirdType,thirdUserName:encodeURIComponent(o.thirdUserName??"")}})};return(c,o)=>{const t=N;return b(),k(R,null,[e(t,{class:"back-link",underline:!1,onClick:o[0]||(o[0]=s=>_("turn",n(z).home))},{default:u(()=>[e(H,{"icon-class":"app_back",class:"back_icon"}),x(" 返回 ")]),_:1}),r("div",{class:"we_com-wrapper"},[e(ue,{onOnLoginSuccess:p})])],64)}}});const pe=W(_e,[["__scopeId","data-v-018b1a1a"]]),ge={name:"Login"},ve=V({...ge,setup(g){const y=E(),_=B(),a=d("account"),m=Y(),p=d(),c=d(),o=d(!1),t=d("登录"),s=d(),v=async()=>{var i,l;await((i=(a.value==="account"?p:c).value)==null?void 0:i.validate()),a.value==="account"?(l=s.value)==null||l.show():w()},w=async()=>{var i;try{o.value=!0,t.value="登 录 中...";const l=await((i=(a.value==="account"?p:c).value)==null?void 0:i.submit());if(!l)return;t.value="登录成功，跳转中...",I(l),await _.replace(te(F(y,$),"tenantId"))}finally{t.value="登录",o.value=!1}},h=d(z.home),f=i=>{h.value=i};return Z(()=>{var i;return(i=m.systemParams)==null?void 0:i.thirdAuthConfigs}),(i,l)=>{const P=se,q=ne,A=le,S=N,D=re;return b(),k("div",{class:ae(["az_login",{"sztd-login":n(oe).sztd==="szhglpt"}])},[r("div",{class:"login-left screen-700"},[r("img",{src:n(m).loginLogo,alt:"logo",class:"login-logo"},null,8,["src"]),r("div",{class:"left-content"},[r("div",{class:"login-title screen-900 az-ellipsis",title:n(m).welcomeText},T(n(m).welcomeText),9,["title"]),r("div",{class:"login-bg"},[r("img",{class:"login-img",src:me,alt:"bg_tongda"})])])]),r("div",{class:"login-right"},[r("div",{class:"login-right-content"},[h.value==="home"?(b(),k(R,{key:0},[r("div",{class:"login-welcome"},"欢迎登录"),r("div",{class:"login-mode"},[e(q,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=C=>a.value=C),class:"az_tabs-custom"},{default:u(()=>[e(P,{label:"账号密码登录",name:"account"},{default:u(()=>[e(de,{ref_key:"accountLoginRef",ref:p,onSubmit:v,class:"login-account"},null,512)]),_:1}),e(P,{label:"验证码登录",name:"phone"},{default:u(()=>[e(ce,{ref_key:"codeLoginRef",ref:c,onSubmit:v,class:"login-code"},null,512)]),_:1})]),_:1},8,["modelValue"])]),e(A,{type:"primary",class:"login-btn",onClick:v,loading:o.value},{default:u(()=>[x(T(t.value),1)]),_:1},8,["loading"]),r("div",{class:"login-other"},[n(m).isRegister===0?(b(),k(R,{key:0},[e(S,{class:"login-go",onClick:l[1]||(l[1]=C=>n(_).push({name:"Register"}))},{default:u(()=>[x(" 注册用户 ")]),_:1}),e(D,{direction:"vertical"})],64)):L("",!0),e(S,{class:"login-go",onClick:l[2]||(l[2]=C=>n(_).push({name:"FindPass"}))},{default:u(()=>[x(" 忘记密码 ")]),_:1})])],64)):L("",!0),h.value==="weCom"?(b(),U(pe,{key:1,onTurn:f})):L("",!0)])]),e(ee,{onSuccess:w,captchaType:"blockPuzzle",imgSize:{width:"330px",height:"190px"},ref_key:"verify",ref:s},null,512)],2)}}});const ke=W(ve,[["__scopeId","data-v-12a127f5"]]);export{ke as default};
