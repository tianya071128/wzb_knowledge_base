import{d as S,o as f,b,w as a,i as l,B as i,eu as Q,f as R,h as Y,av as j,bm as J,_ as M,v as $,r as I,c as P,no as C,m as v,mp as W,H as c,dA as X,t as O,np as Z,nq as U,l as z,k as B,K as L,a3 as ee,nr as le,F as N,g as G,T as H,aT as ae,q as oe,E as te,ab as ne,U as K,ns as q,nt as re,ng as se,nu as x,y as de,Y as ue,I as ie,ax as D,e as fe,S as me,C as pe,Q as ce,ac as _e,ao as ve,ap as ye}from"./index-b80d5ef5.js";import{_ as ge}from"./Formula.vue_vue_type_style_index_0_lang-ef444f24.js";const Ve=S({__name:"ConfigDisplay",props:{isSet:{type:Boolean,default:!1}},setup(k){return(y,p)=>{const A=j,t=J;return f(),b(t,{class:"config-display w100"},{default:a(()=>[l(A,{type:"primary",underline:!1,icon:i(Q),class:"config-display-edit",title:"编辑"},null,8,["icon"]),y.isSet?Y(y.$slots,"default",{key:1},void 0,!0):(f(),R("div",{key:0,class:"config-display-empty"},"暂未设置"))]),_:3})}}});const be=M(Ve,[["__scopeId","data-v-d1f49572"]]),Ie=S({__name:"FileModeConfig",props:{modelValue:{},entryId:{},fields:{},sourceId:{},showConfig:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(k,{emit:y}){const t=$(k,"modelValue",y),g=I(),_=P({get(){var e;return((e=t.value)==null?void 0:e.enable)??!1},set(e){e?(t.value={...C(),enable:!0},E()):t.value=C()}}),m=I(C()),r=I(!1),h={fieldId:[{required:!0,message:"请选择",trigger:["change"]}]},E=()=>{m.value={...C(),...t.value},r.value=!0,setTimeout(()=>{var e,o;(o=(e=g.value)==null?void 0:e.ruleFormRef)==null||o.clearValidate()},100)},d=async()=>{var e,o;await((o=(e=g.value)==null?void 0:e.ruleFormRef)==null?void 0:o.validate()),t.value={...m.value,enable:!0},r.value=!1},n=()=>{ae(()=>{var e;(e=t.value)!=null&&e.fieldId||(t.value=C())})};return(e,o)=>{var w;const V=oe,T=te,F=ne,s=K;return f(),R("div",{class:"fielmode_config"},[l(V,{modelValue:_.value,"onUpdate:modelValue":o[0]||(o[0]=u=>_.value=u)},{default:a(()=>[v(" 直接打开文件(文件模式) "),l(W,{tip:"未勾选时，使用标准的表单模式","raw-content":!1})]),_:1},8,["modelValue"]),(w=i(t))!=null&&w.fieldId&&e.showConfig?(f(),b(be,{key:0,isSet:"",onClick:E},{default:a(()=>[l(c,{label:"指定文件"},{default:a(()=>[l(X,{fieldId:i(t).fieldId,sourceId:e.sourceId,entryId:e.entryId,fields:e.fields},null,8,["fieldId","sourceId","entryId","fields"])]),_:1}),l(c,{label:"显示位置"},{default:a(()=>[v(O(i(Z)(i(t).position??"",i(U))),1)]),_:1})]),_:1})):z("",!0),l(H,{modelValue:r.value,"onUpdate:modelValue":o[4]||(o[4]=u=>r.value=u),"append-to-body":"",title:"打开文件设置",width:"500px",onClose:n},{footer:a(()=>[B("span",{class:"dialog-footer"},[l(s,{onClick:o[3]||(o[3]=u=>r.value=!1)},{default:a(()=>[v("取消")]),_:1}),l(s,{type:"primary",onClick:d},{default:a(()=>[v("确定")]),_:1})])]),default:a(()=>[l(L,{ref_key:"formRef",ref:g,model:m.value,rules:h},{default:a(()=>[l(c,{label:"指定文件",prop:"fieldId"},{default:a(()=>[l(ee,{modelValue:m.value,"onUpdate:modelValue":o[1]||(o[1]=u=>m.value=u),fields:e.fields,prop:{fieldId:"fieldId",fieldType:"fieldType"},sourceId:e.sourceId,entryId:e.entryId,filter:i(le)},null,8,["modelValue","fields","sourceId","entryId","filter"])]),_:1}),l(c,{label:"文件显示位置"},{default:a(()=>[l(F,{modelValue:m.value.position,"onUpdate:modelValue":o[2]||(o[2]=u=>m.value.position=u)},{default:a(()=>[(f(!0),R(N,null,G(i(U),u=>(f(),b(T,{key:u.value,label:u.value},{default:a(()=>[v(O(u.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});const ke=M(Ie,[["__scopeId","data-v-3cec7f1f"]]),Ee=S({__name:"AddOrEditValidate",props:{modelValue:{type:Boolean},formulaProp:{},addType:{default:q.only},data:{},customErrorAfterActionOptions:{},hideErrorAfterAction:{type:Boolean}},emits:["update:modelValue","submit"],setup(k,{emit:y}){const p=k,A=y,t=$(p,"modelValue",A),g=I(),_=I(),m=P(()=>p.customErrorAfterActionOptions?p.customErrorAfterActionOptions:re.filter(d=>d.value!==se.inquiries)),r=I(x()),h={name:[{required:!0,message:"请输入",trigger:"change"}],formula:[{required:!0,message:"请输入",trigger:"change"}],errorAfterAction:[{required:!0,message:"请选择",trigger:"change"}],tip:[{required:!0,message:"请输入",trigger:"change"}]};de(t,()=>{var d,n,e;t.value&&(r.value=ue(p.data??{...x(),type:p.addType}),(d=p.data)!=null&&d.clientId?(e=(n=_.value)==null?void 0:n.ruleFormRef)==null||e.validate():setTimeout(()=>{var o,V;(V=(o=_.value)==null?void 0:o.ruleFormRef)==null||V.clearValidate()},40))});const E=async()=>{var d,n,e;await Promise.all([(n=(d=_.value)==null?void 0:d.ruleFormRef)==null?void 0:n.validate(),(e=g.value)==null?void 0:e.validate()]),A("submit",r.value),t.value=!1};return(d,n)=>{const e=ce,o=_e,V=ve,T=ye,F=K;return f(),b(H,{modelValue:i(t),"onUpdate:modelValue":n[5]||(n[5]=s=>pe(t)?t.value=s:null),"destroy-on-close":"","append-to-body":"",title:"操作校验规则","close-on-click-modal":!1,width:"950px",class:"add_validate"},{footer:a(()=>[B("span",{class:"dialog-footer"},[l(F,{onClick:n[4]||(n[4]=s=>t.value=!1)},{default:a(()=>[v("取消")]),_:1}),l(F,{type:"primary",onClick:E},{default:a(()=>[v("确定")]),_:1})])]),default:a(()=>[l(L,{ref_key:"azFormRef",ref:_,model:r.value,rules:h,"label-position":"top"},{default:a(()=>[l(c,{label:"规则名称",prop:"name"},{default:a(()=>[l(e,{modelValue:r.value.name,"onUpdate:modelValue":n[0]||(n[0]=s=>r.value.name=s),placeholder:"请输入","max-length":"50"},null,8,["modelValue"])]),_:1}),l(c,{label:"校验规则计算公式",style:{"margin-bottom":"10px"},required:""}),B("div",{class:"w100"},[l(ge,ie({modelValue:r.value.formula,"onUpdate:modelValue":n[1]||(n[1]=s=>r.value.formula=s),ref_key:"formulaRef",ref:g,style:{height:"45vh"}},{...d.formulaProp,mode:r.value.type===i(q).multi?i(D).multiple:i(D).client}),null,16,["modelValue"])]),l(o,{prop:"formula"},{default:a(()=>[fe(l(e,{modelValue:r.value.formula},null,8,["modelValue"]),[[me,!1]])]),_:1}),d.hideErrorAfterAction?z("",!0):(f(),b(c,{key:0,label:"不满足校验规则时",prop:"errorAfterAction","label-width":"200px"},{default:a(()=>[l(T,{modelValue:r.value.errorAfterAction,"onUpdate:modelValue":n[2]||(n[2]=s=>r.value.errorAfterAction=s),placeholder:"请选择"},{default:a(()=>[(f(!0),R(N,null,G(m.value,(s,w)=>(f(),b(V,{key:w,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})),l(c,{label:"不满足校验规则时提示文字",prop:"tip","label-width":"200px"},{default:a(()=>[l(e,{modelValue:r.value.tip,"onUpdate:modelValue":n[3]||(n[3]=s=>r.value.tip=s),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}});export{be as C,ke as F,Ee as _};
