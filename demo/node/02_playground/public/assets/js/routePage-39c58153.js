import{d8 as m,d as z,v as D,r as _,o as h,b as C,w as n,i as a,m as d,t as c,B as t,bs as v,uB as P,C as x,bv as k,bT as T,bU as w,U as E,c as R,tM as $,uC as B,uD as S,as as q,bi as I,f as U,l as M,aN as L}from"./index-b80d5ef5.js";const j=l=>m.value.request.post(`${m.value.SYSTEMURL}/todoPush/listPage`,l),N=l=>m.value.request.get(`${m.value.SYSTEMURL}/todoPush/queryById/${l}`),W=l=>m.value.request.post(`${m.value.SYSTEMURL}/todoPush/retry/${l}`),Y=z({__name:"DetailDrawer",props:{modelValue:{type:Boolean},pushId:{}},emits:["update:modelValue"],setup(l,{emit:f}){const r=l,u=D(r,"modelValue",f),i=_(),b=async()=>{i.value=await N(r.pushId)};return(V,s)=>{const p=T,g=w,y=E;return h(),C(k,{modelValue:t(u),"onUpdate:modelValue":s[1]||(s[1]=e=>x(u)?u.value=e:null),"show-load":b,"append-to-body":"",title:"推送详情",size:"800px"},{footer:n(()=>[a(y,{onClick:s[0]||(s[0]=e=>u.value=!1)},{default:n(()=>[d("关闭")]),_:1})]),default:n(()=>[a(g,{border:"",column:2},{default:n(()=>[a(p,{label:"应用名称"},{default:n(()=>{var e;return[d(c((e=t(i))==null?void 0:e.appname),1)]}),_:1}),a(p,{label:"表单名称"},{default:n(()=>{var e;return[d(c((e=t(i))==null?void 0:e.entryname),1)]}),_:1}),a(p,{label:"业务数据id",span:2},{default:n(()=>{var e;return[d(c((e=t(i))==null?void 0:e.bizcode),1)]}),_:1}),a(p,{label:"业务数据概要",span:2},{default:n(()=>{var e;return[d(c((e=t(i))==null?void 0:e.bizdata),1)]}),_:1}),a(p,{label:"状态",span:2},{default:n(()=>{var e;return[d(c(t(v)((e=t(i))==null?void 0:e.status,t(P))),1)]}),_:1}),a(p,{label:"推送数据json",span:2},{default:n(()=>{var e;return[d(c((e=t(i))==null?void 0:e.reqjson),1)]}),_:1}),a(p,{label:"返回数据json",span:2},{default:n(()=>{var e;return[d(c((e=t(i))==null?void 0:e.resjson),1)]}),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),A=l=>({pageConfig:R(()=>({query:{list:[{type:"input",label:"业务数据",prop:"bizdata"},{type:"timerange",label:"推送时间",prop:["startTime","endTime"]},{type:"select",label:"状态",prop:"status",options:$(P)}]},request:{api:j},table:{tableCols:[{label:"业务数据概要",prop:"bizdata",minWidth:"140"},{label:"类型",prop:"biztype",slots:{default({row:o}){return a("span",null,[v(o.biztype,B)])}}},{label:"负责人",prop:"username"},{label:"首次推送时间",prop:"createTime"},{label:"最后推送时间",prop:"pushTime"},{label:"状态",prop:"status",slots:{default({row:o}){return a("span",null,[v(o.status,P)])}}},{label:"推送次数",prop:"times"},{label:"操作",minWidth:"130",slots:{default:({row:o})=>{const u=[{id:"view",type:"primary",text:"查看",onClick:()=>l.handleView(o)}];return o.status==S.fail&&u.push({id:"rePush",type:"primary",text:"重新推送",onClick:async()=>l.handleRePush(o)}),a(q,{num:2,list:u},null)}}}]}}))}),H=A,G=z({__name:"routePage",setup(l){const{pageConfig:f}=H({handleView:b,handleRePush:V}),r=_(!1),o=_(),u=_(""),i=()=>{var s;(s=o.value)==null||s.refresh()};function b(s){u.value=s.id,r.value=!0}async function V(s){try{await W(s.id),L.success("推送成功")}finally{i()}}return(s,p)=>{const g=I("az-page");return h(),U("div",null,[a(g,{class:"layout_box",config:t(f),ref_key:"azPageRef",ref:o,maxHeight:"var(--az-layout-main-height) - 32px"},null,8,["config"]),t(r)?(h(),C(Y,{key:0,modelValue:t(r),"onUpdate:modelValue":p[0]||(p[0]=y=>x(r)?r.value=y:null),pushId:t(u)},null,8,["modelValue","pushId"])):M("",!0)])}}});export{G as default};
