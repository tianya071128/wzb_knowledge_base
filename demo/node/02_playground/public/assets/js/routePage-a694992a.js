import{d as I,v as R,c as E,r as f,y as z,o as V,b as w,w as s,i as l,bu as S,H as oe,r$ as se,B as U,s0 as A,f as $,F as O,g as ue,bh as q,C as M,bv as N,s1 as ie,cc as B,s2 as de,aN as T,s3 as ne,ao as re,Q as W,ac as L,bm as H,m as h,t as D,bs as Q,l as Y,bT as me,bU as pe,s4 as ce,s5 as ve,lr as Z,Z as fe,bi as j,iC as G,k as P,e as J,I as _e,cf as be,s6 as Ve,s7 as ge,rW as K,U as X,Y as ee,s8 as ye,_ as te,s9 as Ce,sa as we,sb as he}from"./index-b80d5ef5.js";import{E as le}from"./el-input-number-c15b1cc7.js";import{_ as ae}from"./TableOperation.vue_vue_type_script_setup_true_lang-4afbb2cb.js";const xe=I({__name:"AddAndEdit",props:{modelValue:{type:Boolean},edit:{}},emits:["update:modelValue","submit"],setup(y,{emit:C}){const c=y,v=C,i=R(c,"modelValue",v),u=E(()=>!!c.edit),n=E(()=>u.value?"编辑字典":"新增字典"),d=f(),m={id:void 0,type:ie,name:"",code:"",sort:1,status:B,remarks:""},e=f({...m});z(i,()=>{i.value&&(e.value=u.value?{...c.edit}:{...m},setTimeout(()=>{var a;(a=d.value)==null||a.clearValidate()},100))},{immediate:!0});const p={type:[{required:!0,message:"请选择字典类别",trigger:"change"}],name:[{required:!0,message:"请输入字典名称",trigger:"blur"}],code:[{required:!0,message:"请输入字典编码",trigger:"blur"}],sort:[{required:!0,message:"请输入只有数字的排序号",trigger:"blur"}],status:[{required:!0,message:"状态不能为空",trigger:"change"}]},g=async a=>{var t;await((t=d.value)==null?void 0:t.validate()),u.value?(await de(e.value),T.success("编辑字典成功")):(await ne(e.value),T.success("新增字典成功"),a==="submitContinue"&&(e.value={...m,type:e.value.type})),v("submit")};return(a,t)=>{const _=re,r=W,b=L,x=le,k=H;return V(),w(N,{modelValue:U(i),"onUpdate:modelValue":t[7]||(t[7]=o=>M(i)?i.value=o:null),title:n.value},{footer:s(()=>[l(S,{editMode:u.value,onClose:t[6]||(t[6]=o=>i.value=!1),"on-submit":g},null,8,["editMode"])]),default:s(()=>[l(k,{model:e.value,rules:p,"label-position":"left","label-width":"120px",ref_key:"ruleFormRef",ref:d},{default:s(()=>[l(oe,{label:"字典类别",prop:"type"},{default:s(()=>[l(se,{modelValue:e.value.type,"onUpdate:modelValue":t[0]||(t[0]=o=>e.value.type=o),placeholder:"请选择字典类别",style:{width:"100%"},load:U(A)},{default:s(({options:o})=>[(V(!0),$(O,null,ue(o,F=>(V(),w(_,{key:F.value,label:F.label,value:F.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","load"])]),_:1}),l(b,{label:"字典名称",prop:"name"},{default:s(()=>[l(r,{modelValue:e.value.name,"onUpdate:modelValue":t[1]||(t[1]=o=>e.value.name=o),placeholder:"请输入字典名称",maxlength:"50"},null,8,["modelValue"])]),_:1}),l(b,{label:"字典编码",prop:"code"},{default:s(()=>[l(r,{modelValue:e.value.code,"onUpdate:modelValue":t[2]||(t[2]=o=>e.value.code=o),placeholder:"请输入字典编码"},null,8,["modelValue"])]),_:1}),l(b,{label:"排序号",prop:"sort"},{default:s(()=>[l(x,{modelValue:e.value.sort,"onUpdate:modelValue":t[3]||(t[3]=o=>e.value.sort=o),modelModifiers:{number:!0},min:1,"controls-position":"right"},null,8,["modelValue"])]),_:1}),l(b,{label:"状态",prop:"status"},{default:s(()=>[l(q,{modelValue:e.value.status,"onUpdate:modelValue":t[4]||(t[4]=o=>e.value.status=o)},null,8,["modelValue"])]),_:1}),l(b,{label:"描述"},{default:s(()=>[l(r,{modelValue:e.value.remarks,"onUpdate:modelValue":t[5]||(t[5]=o=>e.value.remarks=o),type:"textarea",placeholder:"请输入描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),ke=I({__name:"ViewDict",props:{modelValue:{type:Boolean},view:{}},emits:["update:modelValue"],setup(y,{emit:C}){const i=R(y,"modelValue",C);return(u,n)=>{const d=me,m=pe;return V(),w(N,{modelValue:U(i),"onUpdate:modelValue":n[0]||(n[0]=e=>M(i)?i.value=e:null),title:"查看详情"},{default:s(()=>[u.view?(V(),w(m,{key:0,column:2,border:"",style:{"margin-top":"30px"}},{default:s(()=>[l(d,{label:"字典类别"},{default:s(()=>[h(D(U(Q)(u.view.type,U(A))),1)]),_:1}),l(d,{label:"字典名称"},{default:s(()=>[h(D(u.view.name),1)]),_:1}),l(d,{label:"字典编码"},{default:s(()=>[h(D(u.view.code),1)]),_:1}),l(d,{label:"排序号"},{default:s(()=>[h(D(u.view.sort),1)]),_:1}),l(d,{label:"字典状态"},{default:s(()=>[l(q,{"model-value":u.view.status,disabled:""},null,8,["model-value"])]),_:1}),l(d,{label:"字典描述"},{default:s(()=>[h(D(u.view.remarks),1)]),_:1})]),_:1})):Y("",!0)]),_:1},8,["modelValue"])}}}),De=I({__name:"AddAndEditDictItem",props:{modelValue:{type:Boolean},edit:{},dictCode:{}},emits:["update:modelValue","submit"],setup(y,{emit:C}){const c=y,v=C,i=R(c,"modelValue",v),u=E(()=>!!c.edit),n=E(()=>u.value?"编辑字典值":"新增字典值"),d=f(),m={id:void 0,dictCode:c.dictCode,itemText:"",itemValue:"",sort:1,status:B,remarks:""},e=f({...m});z(i,()=>{i.value&&(e.value=u.value?{...c.edit}:{...m,dictCode:c.dictCode},setTimeout(()=>{var a;(a=d.value)==null||a.clearValidate()},100))},{immediate:!0});const p={itemText:[{required:!0,message:"请输入字典值名称",trigger:"blur"}],itemValue:[{required:!0,message:"请输入字典值编码",trigger:"blur"}],sort:[{required:!0,message:"请输入只有数字的排序号",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},g=async a=>{var t;await((t=d.value)==null?void 0:t.validate()),u.value?(await ce(e.value),T.success("编辑字典成功")):(await ve(e.value),T.success("新增字典成功"),a==="submitContinue"&&(e.value={...m,dictCode:e.value.dictCode,sort:++e.value.sort})),v("submit")};return(a,t)=>{const _=W,r=L,b=le,x=Z,k=H;return V(),w(N,{modelValue:U(i),"onUpdate:modelValue":t[7]||(t[7]=o=>M(i)?i.value=o:null),title:n.value},{footer:s(()=>[l(S,{editMode:u.value,onClose:t[6]||(t[6]=o=>i.value=!1),"on-submit":g},null,8,["editMode"])]),default:s(()=>[l(k,{model:e.value,rules:p,"label-position":"left","label-width":"120px",ref_key:"ruleFormRef",ref:d},{default:s(()=>[l(r,{label:"字典值名称",prop:"itemText"},{default:s(()=>[l(_,{modelValue:e.value.itemText,"onUpdate:modelValue":t[0]||(t[0]=o=>e.value.itemText=o),placeholder:"请输入字典值名称",maxlength:"50"},null,8,["modelValue"])]),_:1}),l(r,{label:"字典值编码",prop:"itemValue"},{default:s(()=>[l(_,{modelValue:e.value.itemValue,"onUpdate:modelValue":t[1]||(t[1]=o=>e.value.itemValue=o),placeholder:"请输入字典值编码",maxlength:"50"},null,8,["modelValue"])]),_:1}),l(r,{label:"排序号",prop:"sort"},{default:s(()=>[l(b,{modelValue:e.value.sort,"onUpdate:modelValue":t[2]||(t[2]=o=>e.value.sort=o),modelModifiers:{number:!0},min:1,"controls-position":"right"},null,8,["modelValue"])]),_:1}),l(r,{label:"状态",prop:"status"},{default:s(()=>[l(q,{modelValue:e.value.status,"onUpdate:modelValue":t[3]||(t[3]=o=>e.value.status=o)},null,8,["modelValue"])]),_:1}),l(r,{label:"颜色",prop:"color"},{default:s(()=>[l(x,{modelValue:e.value.color,"onUpdate:modelValue":t[4]||(t[4]=o=>e.value.color=o)},null,8,["modelValue"])]),_:1}),l(r,{label:"描述"},{default:s(()=>[l(_,{modelValue:e.value.remarks,"onUpdate:modelValue":t[5]||(t[5]=o=>e.value.remarks=o),type:"textarea",placeholder:"请输入描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Ue=I({__name:"ConfigDict",props:{dictCode:{},dictName:{}},setup(y){const C=y,c=E(()=>({dictCode:C.dictCode??`dictCode_${fe()}`})),v={id:"dict_config_dict",query:{list:[{type:"input",label:"字典值名称",prop:"itemText"},{type:"select",label:"状态",prop:"status",options:be,isAll:!0,initValue:B}]},request:{api:Ve,extraParams:c},table:{tableCols:[{type:"index"},{prop:"itemText",label:"字典值名称",width:150,showOverflowTooltip:!0},{prop:"itemValue",label:"字典值编码",width:150,showOverflowTooltip:!0},{prop:"sort",label:"排序",width:70},{prop:"status",label:"状态",minWidth:80,slots:{default({row:e}){return l(q,{modelValue:e.status,"onUpdate:modelValue":p=>e.status=p,updateFetch:async()=>{await ge(e.id),u()},disabled:!K("system:dict:set")},null)}}},{prop:"colorSwitch",label:"彩色",minWidth:80,slots:{default({row:e}){return l(Z,{modelValue:e.color,"onUpdate:modelValue":p=>e.color=p,disabled:!0,class:"readonly-color_picker"},null)}}},{fixed:"right",label:"操作",minWidth:150,slots:{default({row:e}){const a=[{type:"primary",onClick:()=>{d.value=ee(e),n.value=!0},text:"编辑",premission:"system:dict:set"},{type:"danger",text:"删除",premission:"system:dict:set",popconfirmProps:{title:"您确定要删除该字典吗?",confirm:async()=>{await ye(e.id),T.success("删除成功"),u()}}}];return l(ae,{rowId:e.id,list:a},null)}}}]}},i=f(),u=()=>{var e;(e=i.value)==null||e.refresh()},n=f(!1),d=f(),m=()=>{n.value=!0,d.value=null};return(e,p)=>{const g=X,a=j("az-page"),t=G("premission");return V(),$(O,null,[P("div",{class:"dict_config-title"},"字典名称："+D(e.dictName??"-"),1),l(a,_e({ref_key:"azPageRef",ref:i,config:v},e.$attrs,{maxHeight:"var(--az-layout-main-height) - 40px"}),{operation:s(()=>[J((V(),w(g,{type:"primary",onClick:m},{default:s(()=>[h(" 新增字典值 ")]),_:1})),[[t,"system:dict:set"]])]),_:1},16),e.dictCode?(V(),w(De,{key:0,modelValue:n.value,"onUpdate:modelValue":p[0]||(p[0]=_=>n.value=_),edit:d.value,dictCode:e.dictCode,onSubmit:u},null,8,["modelValue","edit","dictCode"])):Y("",!0)],64)}}});const Ee=te(Ue,[["__scopeId","data-v-faf3df9f"]]),Te={name:"Dict"},Ie=I({...Te,setup(y){const c={query:{list:[{type:"input",label:"字典名称",prop:"name"},{type:"input",label:"字典编号",prop:"code"},{type:"select",label:"字典类别",prop:"type",options:A,isAll:!0}]},request:{api:Ce},table:{tableProps:{highlightCurrentRow:!0,"onCurrent-change":a=>{a&&(n.value=a)}},tableCols:[{type:"index"},{prop:"name",label:"字典名称",width:200,showOverflowTooltip:!0},{prop:"code",label:"字典编码",width:150,showOverflowTooltip:!0},{prop:"type",label:"字典类别",width:150,showOverflowTooltip:!0,slots:{default({row:a}){return l("span",null,[Q(a.type,A)])}}},{prop:"status",label:"状态",slots:{default({row:a}){return l(q,{modelValue:a.status,"onUpdate:modelValue":t=>a.status=t,updateFetch:async()=>{await we(a.id),i()},disabled:!K("system:dict:enable")},null)}}},{fixed:"right",label:"操作",minWidth:150,slots:{default({row:a}){const b=[{type:"primary",onClick:()=>{m.value=ee(a),d.value=!0},text:"编辑",premission:"system:dict:edit"},{type:"primary",onClick:()=>{g.value=a,p.value=!0},text:"查看",premission:"system:dict:detail"},{type:"danger",text:"删除",premission:"system:dict:delete",popconfirmProps:{title:"您确定要删除该字典吗?",confirm:async()=>{await he(a.id),T.success("删除成功"),i()}}}];return l(ae,{rowId:a.id,list:b},null)}}}]}},v=f(),i=()=>{var a;(a=v.value)==null||a.refresh()},u=E(()=>{var a;return(a=v.value)==null?void 0:a.data}),n=f();z(u,()=>{var t;if(!u.value)return;const a=u.value.find(_=>{var r;return _.id===((r=n.value)==null?void 0:r.id)})??((t=u.value)==null?void 0:t[0]);n.value=a}),z([n,u],()=>{var a,t;(t=(a=v.value)==null?void 0:a.tableRef)==null||t.setCurrentRow(n.value)});const d=f(!1),m=f(),e=()=>{d.value=!0,m.value=null},p=f(!1),g=f();return(a,t)=>{var x,k;const _=X,r=j("az-page"),b=G("premission");return V(),$("div",{class:"layout_box dict_page"},[P("div",{class:"dict_content"},[l(r,{class:"dict-page",ref_key:"azPageRef",ref:v,config:c,maxHeight:"var(--az-layout-main-height) - 40px"},{operation:s(()=>[J((V(),w(_,{type:"primary",onClick:e},{default:s(()=>[h(" 新增字典 ")]),_:1})),[[b,"system:dict:add"]])]),_:1},512),l(xe,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=o=>d.value=o),edit:m.value,onSubmit:i},null,8,["modelValue","edit"]),l(ke,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=o=>p.value=o),view:g.value},null,8,["modelValue","view"])]),P("div",{class:"dict_item-content"},[l(Ee,{class:"dict_item-page",dictCode:(x=n.value)==null?void 0:x.code,dictName:(k=n.value)==null?void 0:k.name},null,8,["dictCode","dictName"])])])}}});const Fe=te(Ie,[["__scopeId","data-v-2ade306a"]]);export{Fe as default};
