import{d8 as v,d as k,v as P,c as N,r as _,y as C,bK as z,o as E,b as x,w as a,i as l,bu as F,B as M,C as A,bv as S,aN as U,Q as R,ac as I,bm as q,_ as D,m as y,t as w,bz as B,l as L,bT as O,bU as W,bi as Y,f as H,ae as K,P as Q,U as j}from"./index-b80d5ef5.js";import{E as G}from"./el-input-number-c15b1cc7.js";import{S as J}from"./SelectIcon-68324dc3.js";import{_ as X}from"./TableOperation.vue_vue_type_script_setup_true_lang-4afbb2cb.js";const Z=d=>v.value.request.post(`${v.value.SYSTEMURL}/module/listPage`,d),ee=d=>v.value.request.post(`${v.value.SYSTEMURL}/module/add`,d),le=d=>v.value.request.post(`${v.value.SYSTEMURL}/module/edit`,d),te=d=>v.value.request.post(`${v.value.SYSTEMURL}/module/delete/${d}`),ae=k({__name:"ModuleAddAndEdit",props:{modelValue:{type:Boolean},edit:{}},emits:["update:modelValue","refresh"],setup(d,{emit:g}){const f=d,b=g,s=P(f,"modelValue",b),o=N(()=>!!f.edit),c=N(()=>o.value?"编辑模块":"新增模块"),n=_(),m={id:void 0,systemName:"",modulePath:"",icon:"",moduleFlag:"",sort:1,remark:""},e=_({...m});C(s,()=>{s.value&&(e.value=o.value?{...f.edit}:{...m},setTimeout(()=>{var r;(r=n.value)==null||r.clearValidate()},100))},{immediate:!0});const i=z({modulePath:[{required:!0,message:"请输入模块路径",trigger:"blur"},{pattern:/^(\w+[^\s]+(\.[^\s]+){1,})|(\/[^\s]*)$/,message:"模块路径不是合法的路径",trigger:"blur"}],systemName:[{required:!0,message:"请输入模块（子系统）名称",trigger:"blur"}]}),h=async r=>{var t;await((t=n.value)==null?void 0:t.validate()),o.value?(await le(e.value),U.success("修改模块成功")):(await ee(e.value),U.success("新增模块成功")),r==="submitContinue"&&(e.value={...m}),b("refresh")};return(r,t)=>{const p=R,V=I,T=G,$=q;return E(),x(S,{modelValue:M(s),"onUpdate:modelValue":t[7]||(t[7]=u=>A(s)?s.value=u:null),title:c.value,size:"500px"},{footer:a(()=>[l(F,{editMode:o.value,onClose:t[6]||(t[6]=u=>s.value=!1),"on-submit":h},null,8,["editMode"])]),default:a(()=>[l($,{ref_key:"ruleFormRef",ref:n,rules:i,model:e.value,"label-width":"100px","label-position":"left"},{default:a(()=>[l(V,{label:"模块名称",prop:"systemName"},{default:a(()=>[l(p,{modelValue:e.value.systemName,"onUpdate:modelValue":t[0]||(t[0]=u=>e.value.systemName=u),placeholder:"请输入模块（子系统）名称",maxlength:"20"},null,8,["modelValue"])]),_:1}),l(V,{label:"模块路径",prop:"modulePath"},{default:a(()=>[l(p,{modelValue:e.value.modulePath,"onUpdate:modelValue":t[1]||(t[1]=u=>e.value.modulePath=u),placeholder:"请输入模块路径"},null,8,["modelValue"])]),_:1}),l(V,{label:"图标"},{default:a(()=>[l(J,{modelValue:e.value.icon,"onUpdate:modelValue":t[2]||(t[2]=u=>e.value.icon=u)},null,8,["modelValue"])]),_:1}),l(V,{label:"模块标识"},{default:a(()=>[l(p,{modelValue:e.value.moduleFlag,"onUpdate:modelValue":t[3]||(t[3]=u=>e.value.moduleFlag=u),placeholder:"请输入模块（子系统）标识",maxlength:"20"},null,8,["modelValue"])]),_:1}),l(V,{label:"排序"},{default:a(()=>[l(T,{modelValue:e.value.sort,"onUpdate:modelValue":t[4]||(t[4]=u=>e.value.sort=u),min:0,placeholder:"请输入排序号",style:{"min-width":"180px"}},null,8,["modelValue"])]),_:1}),l(V,{label:"备注"},{default:a(()=>[l(p,{modelValue:e.value.remark,"onUpdate:modelValue":t[5]||(t[5]=u=>e.value.remark=u),type:"textarea",placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"])}}});const oe=D(ae,[["__scopeId","data-v-4373e962"]]),se=k({__name:"ViewModule",props:{modelValue:{type:Boolean},view:{}},emits:["update:modelValue"],setup(d,{emit:g}){const s=P(d,"modelValue",g);return(o,c)=>{const n=O,m=W;return E(),x(S,{modelValue:M(s),"onUpdate:modelValue":c[0]||(c[0]=e=>A(s)?s.value=e:null),title:"查看详情"},{default:a(()=>[o.view?(E(),x(m,{key:0,column:2,border:"",style:{"margin-top":"30px"}},{default:a(()=>[l(n,{label:"模块名称"},{default:a(()=>[y(w(o.view.systemName),1)]),_:1}),l(n,{label:"模块路径"},{default:a(()=>[y(w(o.view.modulePath),1)]),_:1}),l(n,{label:"模块图标"},{default:a(()=>[l(B,{style:{"font-size":"20px"},"icon-class":o.view.icon},null,8,["icon-class"])]),_:1}),l(n,{label:"模块标识"},{default:a(()=>[y(w(o.view.moduleFlag||"-"),1)]),_:1}),l(n,{label:"排序"},{default:a(()=>[y(w(o.view.sort),1)]),_:1}),l(n,{label:"备注"},{default:a(()=>[y(w(o.view.remark||"-"),1)]),_:1})]),_:1})):L("",!0)]),_:1},8,["modelValue"])}}}),ue={name:"Module"},re=k({...ue,setup(d){const g={query:{list:[{type:"input",label:"模块(子系统)名称",prop:"systemName"}]},request:{api:Z},table:{tableCols:[{type:"index",width:55,label:"序号"},{prop:"systemName",label:"模块(子系统）名称",minWidth:150,showOverflowTooltip:!0},{prop:"modulePath",label:"模块路径",minWidth:150,showOverflowTooltip:!0},{prop:"moduleFlag",label:"模块标识",minWidth:150,showOverflowTooltip:!0},{prop:"remark",label:"备注",minWidth:150,showOverflowTooltip:!0},{fixed:"right",width:180,label:"操作",slots:{default({row:e}){const r=[{type:"primary",onClick:()=>c("edit",e),text:"编辑",premission:"system:module:edit"},{type:"primary",onClick:()=>{n.value=e,m.value=!0},text:"查看",premission:"system:module:detail"},{type:"danger",text:"删除",popconfirmProps:{title:"您确定要删除该模块吗?",confirm:async()=>{await te(e.id),U.success("删除成功"),await b()}},premission:"system:module:delete"}];return l(X,{num:3,rowId:e.id,list:r},null)}}}]}},f=_(),b=async()=>{var e;await((e=f.value)==null?void 0:e.refresh())},s=_(!1),o=_(),c=(e,i)=>{e==="add"?o.value=null:o.value={...i},s.value=!0},n=_(),m=_(!1);return(e,i)=>{const h=Q,r=j,t=Y("az-page");return E(),H("div",{class:"layout_box"},[l(t,{ref_key:"azPageRef",ref:f,config:g,maxHeight:"var(--az-layout-main-height) - 40px"},{operation:a(()=>[l(r,{onClick:i[0]||(i[0]=p=>c("add")),type:"primary"},{default:a(()=>[l(h,{size:16,style:{"margin-right":"8px"}},{default:a(()=>[l(M(K))]),_:1}),y(" 新增模块 ")]),_:1})]),_:1},512),l(oe,{modelValue:s.value,"onUpdate:modelValue":i[1]||(i[1]=p=>s.value=p),edit:o.value,onRefresh:b},null,8,["modelValue","edit"]),l(se,{modelValue:m.value,"onUpdate:modelValue":i[2]||(i[2]=p=>m.value=p),view:n.value},null,8,["modelValue","view"])])}}});export{re as default};
