import{d as b,r as n,v as T,o as c,b as N,w as d,i as r,f as v,F as I,g as x,m as w,t as h,B as q,C,bv as D,bT as O,bU as P,nH as k,bi as A,e as B,iC as V,av as E}from"./index-b80d5ef5.js";import{q as M,p as U}from"./log-64267fd3.js";const z=b({__name:"detail-log",props:{drawerModel:{type:Boolean},logId:{}},emits:["update:drawerModel"],setup(f,{emit:g}){const i=g,o=f,m=[{name:"日志类型",propName:"logType"},{name:"日志类型",propName:"operationType"},{name:"日志标题",propName:"logTitle"},{name:"请求方式",propName:"requestMethod"},{name:"操作参数",propName:"requestParams",span:2},{name:"访问者IP地址",propName:"remoteAddr"},{name:"请求服务器地址",propName:"serverAddr"},{name:"是否有异常",propName:"isException"},{name:"异常信息",propName:"exceptionInfo"},{name:"浏览方式",propName:"executeTime"},{name:"执行时间长",propName:"executeTime"},{name:"操作者名称",propName:"createName",span:2},{name:"请求URI",propName:"requestUri",span:2}],s=n(),a=T(o,"drawerModel",i),p=async()=>{o.logId&&(s.value=await M(o.logId))};return(_,l)=>{const t=O,u=P;return c(),N(D,{modelValue:q(a),"onUpdate:modelValue":l[0]||(l[0]=e=>C(a)?a.value=e:null),title:"日志详情","show-load":p},{default:d(()=>[r(u,{border:!0,column:2,direction:"vertical"},{default:d(()=>[(c(),v(I,null,x(m,(e,y)=>r(t,{"label-class-name":"label_class",key:e.propName+y,span:e.span||1,label:e.name},{default:d(()=>[w(h(s.value&&s.value[e.propName]||"-"),1)]),_:2},1032,["span","label"])),64))]),_:1})]),_:1},8,["modelValue"])}}}),L={name:"LogPage"},F=b({...L,setup(f){const i=k().isPlatformAdmin,o=[{type:"select",label:"日志类型",prop:"logType",options:"log_Type",extraOptions:[{label:"全部",value:""}]},{type:"select",label:"日志操作类型",prop:"operationType",options:"log_operation_type",extraOptions:[{label:"全部",value:""}]},{type:"timerange",label:"日期",prop:["startTime","endTime"]}],m=()=>(i&&o.unshift({type:"input",label:"企业名称",prop:"name"}),o),s=n(),a=n(""),p=n(!1),_={query:{list:m()},request:{api:U},table:{tableCols:[{prop:"logType",label:"日志类型"},{prop:"operationType",label:"操作类型"},{prop:"logTitle",label:"日志标题",showOverflowTooltip:!0},{prop:"remoteAddr",label:"访问者IP地址",showOverflowTooltip:!0},{prop:"userAgent",label:"浏览方式",showOverflowTooltip:!0},{prop:"executeTime",label:"执行时长",showOverflowTooltip:!0},{prop:"createName",label:"操作者",showOverflowTooltip:!0},{prop:"createTime",label:"操作时间",showOverflowTooltip:!0},{fixed:"right",width:80,label:"操作",slots:{default({row:l}){const t=()=>{a.value=l.id,p.value=!0};return r("div",null,[B(r(E,{type:"primary",underline:!1,onClick:()=>{t()}},{default:()=>[w("查看")]}),[[V("premission"),"system:log:detail"]])])}}}]},pagination:{}};return(l,t)=>{const u=A("az-page");return c(),v("div",{class:"layout_box"},[r(u,{ref_key:"azPageRef",ref:s,config:_},null,512),r(z,{"drawer-model":p.value,"onUpdate:drawerModel":t[0]||(t[0]=e=>p.value=e),logId:a.value},null,8,["drawer-model","logId"])])}}});export{F as default};
