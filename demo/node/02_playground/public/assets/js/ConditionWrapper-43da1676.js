import{d as F,x as T,r as u,gf as A,c as v,iH as D,iI as j,o as b,f as O,k as C,h as U,i as s,e as W,S as $,I as g,B as c,w as l,m as y,b as P,fx as R,l as H,F as J,Y as S,aN as M,Q,U as Y,bn as q,_ as z}from"./index-b80d5ef5.js";import{F as G}from"./FieldCondition-1c72aa9d.js";import{B as k}from"./ButtonState-cb54910b.js";const K={inheritAttrs:!1},L=F({...K,__name:"ConditionWrapper",props:{btnText:{default:"设置筛选条件"},condition:{},disabled:{type:Boolean},validate:{type:Boolean,default:!1},msg:{default:"筛选条件存在错误"}},emits:["update:condition"],setup(B,{emit:w}){const o=B,V=w,x=e=>e,h=T(),n=u(!1),i=u(o.condition??[]),p=u(),E=()=>{o.disabled||(i.value=S(o.condition??[]),n.value=!0)},I=async()=>{var e,t;await((t=(e=p.value)==null?void 0:e.validate())==null?void 0:t.catch(r=>(M.error("请设置完整的条件!"),Promise.reject(r)))),V("update:condition",S(i.value)),n.value=!1},d=A(),f=v(()=>o.validate?!D({condition:o.condition??[],dataSystem:h,props:d}):!1);return j(f,v(()=>o.msg)),(e,t)=>{const r=Q,m=Y,N=q;return b(),O(J,null,[C("div",g({class:"condition_wrapper",style:{cursor:"pointer"}},c(d),{onClick:E}),[U(e.$slots,"default",{isError:f.value},()=>{var a,_;return[s(k,{class:"condition_wrapper-btn",isSet:!!((a=e.condition)!=null&&a.length),text:e.btnText,disabled:e.disabled},null,8,["isSet","text","disabled"]),s(k,{class:"condition_wrapper-error","is-error":"",isSet:!!((_=e.condition)!=null&&_.length),text:e.btnText,disabled:e.disabled},null,8,["isSet","text","disabled"])]},!0),W(s(r,{"model-value":JSON.stringify(o.condition)},null,8,["model-value"]),[[$,!1]])],16),s(N,{modelValue:n.value,"onUpdate:modelValue":t[2]||(t[2]=a=>n.value=a),title:e.btnText,width:"900","destroy-on-close":"","close-on-click-modal":!1,"append-to-body":""},{footer:l(()=>[C("span",{class:"dialog-footer"},[s(m,{onClick:t[1]||(t[1]=a=>n.value=!1)},{default:l(()=>[y("取消")]),_:1}),s(m,{type:"primary",onClick:I},{default:l(()=>[y("确定")]),_:1})])]),default:l(()=>[n.value?(b(),P(G,g({key:0,ref_key:"fieldConditionRef",ref:p},x(c(R)(c(d),["style","class"])),{condition:i.value,"onUpdate:condition":t[0]||(t[0]=a=>i.value=a)}),null,16,["condition"])):H("",!0)]),_:1},8,["modelValue","title"])],64)}}});const te=z(L,[["__scopeId","data-v-e83b4092"]]);export{te as C};
