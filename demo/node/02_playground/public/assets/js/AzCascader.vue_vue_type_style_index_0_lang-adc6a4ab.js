import{d as M,c as d,n as P,r as m,iI as R,Z as F,z as j,o as D,b as G,ad as H,w as v,k as z,m as k,t as O,i as K,bc as U,h as L,p as Y,l as Z,h1 as J,aT as Q,av as W,eG as X,fn as ee,dN as le,a9 as ae,Y as te,by as se}from"./index-b80d5ef5.js";const ne=M({__name:"AzCascader",props:{modelValue:{},props:{},placeholder:{default:"请选择"},removeOptions:{},removeText:{default:"已删除选项"},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup($,{expose:x,emit:S}){const a=$,T=S;let h=!1;const u=d({set(l){var e;f.value&&((e=a.removeOptions)!=null&&e.length)&&!h&&(l=[...l,...a.removeOptions]),h=!1,T("update:modelValue",l??null)},get(){var e,o;if(a.modelValue==null)return;const l=P(a.modelValue);return(e=a.props)!=null&&e.multiple?l:((o=a.props)==null?void 0:o.emitPath)===!1?(l==null?void 0:l[0])??void 0:l}}),f=d(()=>!!C.value.multiple),i=m("success"),y=m(),E=m(),g=m(!0),N=d(()=>{var l;return i.value==="loading"?"选项数据正在加载中":i.value==="fail"?y.value??"选项数据加载失败":!f.value&&((l=a.removeOptions)!=null&&l.length)?a.removeText:a.placeholder}),C=d(()=>{const l={...a.props??{}},e=l.lazyLoad;if(l.lazy&&J(e)){const o=(s,t)=>{const{level:n}=s;n===0&&(i.value="loading"),e(s).then(r=>{n===0&&(i.value="success"),t(r??void 0)}).catch(r=>{n===0?(i.value="fail",y.value=typeof r=="string"?r:void 0,t([{leaf:!0}])):s.loading=!1})};l.lazyLoad=o}return l}),A=()=>{g.value=!1,i.value="loading",Q(()=>{g.value=!0})},B=d(()=>{var l;return!!((l=a.removeOptions)!=null&&l.length)}),I=d(()=>`存在${a.removeText}`);R(B,I);const _=`select-field-${F()}`,b=new Set;j(l=>{var e,o;if(f.value){const s=document.querySelector(`.${_} .el-cascader__tags`);if(!s)return;for(const n of a.removeOptions??[]){const r=!a.disabled,V=ee({render(){return le(se,{type:"danger",closable:r,disableTransitions:!0,onClose(){var w;const p=(w=u.value)==null?void 0:w.findIndex(c=>ae(c,n));if(p>-1){const c=te(u.value);c==null||c.splice(p,1),h=!0,u.value=c}}},()=>a.removeText)}}).mount(document.createElement("div"));s.insertAdjacentElement("afterbegin",V.$el),b.add(()=>{var p;(p=V.$el)==null||p.remove()})}const t=document.querySelector(`.${_}  .el-input__inner`);(e=a.removeOptions)!=null&&e.length&&s.querySelectorAll(".el-tag").length===((o=a.removeOptions)==null?void 0:o.length)?t&&(t.parentElement&&(t.parentElement.style.height=`${s.offsetHeight+6}px`),t.style.opacity="0"):t&&(t.parentElement&&(t.parentElement.style.height="initial"),t.style.opacity="initial")}l(()=>{b.forEach(s=>s()),b.clear()})},{flush:"post"});const q=function(l){var o,s;if(!((o=a.props)!=null&&o.checkOnClickNode))return;let e=l.target;for(;e&&!(e!=null&&e.classList.contains("el-cascader-node__label--placeholder"));)e=e.parentElement;if(e=(s=e==null?void 0:e.parentElement)==null?void 0:s.previousElementSibling,e!=null&&e.classList.contains("el-radio")||e!=null&&e.classList.contains("el-checkbox")){const t=new MouseEvent("click",{bubbles:!1,cancelable:!0,view:window});e.dispatchEvent(t),l.stopPropagation()}};return x({cascaderRef:E}),(l,e)=>{var t;const o=W,s=X;return g.value?(D(),G(s,{key:0,modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=n=>u.value=n),props:C.value,placeholder:N.value,class:Y({"az_cascader-radio-remove":!f.value&&((t=l.removeOptions)==null?void 0:t.length),[_]:!0}),ref_key:"cascaderRef",ref:E,disabled:l.disabled},H({_:2},[i.value==="fail"?{name:"default",fn:v(()=>[z("div",{class:"az_cascader-fail",onClick:e[0]||(e[0]=U(()=>{},["stop"]))},[k(O(y.value??"数据加载失败")+", ",1),K(o,{type:"danger",class:"error-link",underline:!1,onClick:A},{default:v(()=>[k(" 重新加载 ")]),_:1})])]),key:"0"}:{name:"default",fn:v(({node:n,data:r})=>[z("div",{class:"el-cascader-node__label--placeholder",onClick:q},[L(l.$slots,"default",{node:n,data:r},()=>[k(O(n.label),1)])])]),key:"1"},l.$slots.empty?{name:"empty",fn:v(()=>[L(l.$slots,"empty")]),key:"2"}:void 0]),1032,["modelValue","props","placeholder","class","disabled"])):Z("",!0)}}});export{ne as _};
